<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="miu"><meta name="copyright" content="miu"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ1ï¼‰ä»UE4çš„ä¸€å¤„ä¸‹è¡ŒCastï¼Œåˆ°åˆæ­¥ç†è§£C++ç±»å‹è½¬æ¢ | ä¸´æ—¶ä¸ªäººä¸»é¡µ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"acbgzm.github.io","root":"/","title":"slowmotion","version":"1.10.9","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="ğŸ’ƒğŸ’ƒğŸ’ƒæ³¨æ„çœ‹ï¼ŒUE4æŠŠçˆ¶ç±»æŒ‡é’ˆå¼ºè½¬æˆäº†å­ç±»çš„æŒ‡é’ˆï¼Œç„¶åæƒ³è¦è°ƒç”¨å­ç±»çš„æ–¹æ³•ğŸ˜°ğŸ˜°ğŸ˜°ï¼Œè¿™æ ·åšèƒ½æˆåŠŸå—ï¼ŸğŸ§ğŸ§ğŸ§å°ç¼–ä¹Ÿå¾ˆå¥½å¥‡ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å§ğŸµğŸµğŸµ">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ1ï¼‰ä»UE4çš„ä¸€å¤„ä¸‹è¡ŒCastï¼Œåˆ°åˆæ­¥ç†è§£C++ç±»å‹è½¬æ¢">
<meta property="og:url" content="http://acbgzm.github.io/2022/09/07/ue-1/index.html">
<meta property="og:site_name" content="ä¸´æ—¶ä¸ªäººä¸»é¡µ">
<meta property="og:description" content="ğŸ’ƒğŸ’ƒğŸ’ƒæ³¨æ„çœ‹ï¼ŒUE4æŠŠçˆ¶ç±»æŒ‡é’ˆå¼ºè½¬æˆäº†å­ç±»çš„æŒ‡é’ˆï¼Œç„¶åæƒ³è¦è°ƒç”¨å­ç±»çš„æ–¹æ³•ğŸ˜°ğŸ˜°ğŸ˜°ï¼Œè¿™æ ·åšèƒ½æˆåŠŸå—ï¼ŸğŸ§ğŸ§ğŸ§å°ç¼–ä¹Ÿå¾ˆå¥½å¥‡ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å§ğŸµğŸµğŸµ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/10.png">
<meta property="article:published_time" content="2022-09-07T14:25:03.000Z">
<meta property="article:modified_time" content="2022-09-08T07:09:55.202Z">
<meta property="article:author" content="miu">
<meta property="article:tag" content="æ¸¸æˆå¼€å‘">
<meta property="article:tag" content="UnrealEngine">
<meta property="article:tag" content="C++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="miu"><img width="96" loading="lazy" src="/images/avatar.png" alt="miu"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ¸</span></a><div class="site-author-name"><a href="/about/">miu</a></div><span class="site-name">ä¸´æ—¶ä¸ªäººä¸»é¡µ</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">19</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">6</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" href="/lab" title="lab"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/ACBGZM" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/10388034" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:ACBGZM@126.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="å‹é“¾" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:open-arm-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#UE4-dynamic-cast%E4%B8%80%E5%88%99"><span class="toc-text">UE4 dynamic_castä¸€åˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0const-cast"><span class="toc-text">â‘ const_cast</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%B1%9E%E6%80%A7%E5%92%8C%E7%BC%96%E8%AF%91%E5%99%A8%E4%BC%98%E5%8C%96"><span class="toc-text">ä¿®æ”¹å±æ€§å’Œç¼–è¯‘å™¨ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#const%E5%92%8Cvolatile"><span class="toc-text">constå’Œvolatile</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%93%E5%8D%B0volatile%E5%8F%98%E9%87%8F%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-text">æ‰“å°volatileå˜é‡çš„åœ°å€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9Aconst%E5%86%85%E5%AD%98%E5%92%8C%E5%85%B6%E4%BB%96"><span class="toc-text">è¡¥å……ï¼šconstå†…å­˜å’Œå…¶ä»–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#const-cast%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">const_castçš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1reinterpret-cast"><span class="toc-text">â‘¡reinterpret_cast</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%81%B5%E6%B4%BB%E4%BD%86%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">çµæ´»ä½†ä¸å®‰å…¨çš„è½¬æ¢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9Aendian"><span class="toc-text">è¡¥å……ï¼šendian</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#reinterpret-cast%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">reinterpret_castçš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A2static-cast"><span class="toc-text">â‘¢static_cast</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A3dynamic-cast"><span class="toc-text">â‘£dynamic_cast</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%9A%84%E4%B8%8B%E8%A1%8C%E8%BD%AC%E6%8D%A2"><span class="toc-text">å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#dynamic-cast%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">dynamic_castçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9F%BA%E7%B1%BB%E6%8C%87%E9%92%88%E6%9C%AC%E6%9D%A5%E5%B0%B1%E6%8C%87%E5%90%91%E6%B4%BE%E7%94%9F%E7%B1%BB%E5%AF%B9%E8%B1%A1"><span class="toc-text">åŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A4%9A%E6%80%81%E5%9F%BA%E7%B1%BB"><span class="toc-text">å¤šæ€åŸºç±»</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93"><span class="toc-text">ä½¿ç”¨æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9E%E5%88%B0%E5%BC%80%E5%A4%B4%E7%9A%84UE4-Cast"><span class="toc-text">å›åˆ°å¼€å¤´çš„UE4 Cast</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">å‚è€ƒ</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://acbgzm.github.io/2022/09/07/ue-1/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="miu"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ä¸´æ—¶ä¸ªäººä¸»é¡µ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ1ï¼‰ä»UE4çš„ä¸€å¤„ä¸‹è¡ŒCastï¼Œåˆ°åˆæ­¥ç†è§£C++ç±»å‹è½¬æ¢</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-09-07 22:25:03" itemprop="dateCreated datePublished" datetime="2022-09-07T22:25:03+08:00">2022-09-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">7.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">30m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/UE%E6%BA%90%E7%A0%81/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">UEæºç </span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">æ¸¸æˆå¼€å‘</span></a><a class="tag-item" href="/tags/UnrealEngine/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">UnrealEngine</span></a><a class="tag-item" href="/tags/C/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">C++</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><blockquote>
<p>å ç”²ï¼šä»…ä¸ºè®°å½•ä¸ªäººå­¦ä¹ è¿‡ç¨‹ï¼›å†…å®¹å¾ˆå¤šæ˜¯ä»åˆ«å¤„çœ‹æ¥çš„ï¼Œåœ¨å‚è€ƒä¸­åˆ—å‡ºï¼›ç¼ºä¹å®è·µç»éªŒï¼Œæœ‰äº›åœ°æ–¹çº¸ä¸Šè°ˆå…µï¼›éš¾å…æœ‰é”™è¯¯ï¼Œæ•¬è¯·æŒ‡å‡ºã€‚</p>
<p>ç³»åˆ—ç›®å½•ï¼š<a href="https://acbgzm.github.io/2022/06/18/ue-0/">ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ0ï¼‰ç³»åˆ—å¼€ç¯‡ &amp; ç›®å½•</a></p>
</blockquote>
<h4 id="UE4-dynamic-castä¸€åˆ™"><a href="#UE4-dynamic-castä¸€åˆ™" class="headerlink" title="UE4 dynamic_castä¸€åˆ™"></a>UE4 dynamic_castä¸€åˆ™</h4><p>GEngineæ˜¯ä¸€ä¸ªUEngineç±»å‹çš„æŒ‡é’ˆï¼Œå®ƒæ˜¯æ‰€æœ‰å¼•æ“ç±»çš„æŠ½è±¡åŸºç±»ï¼Œç”¨äºç®¡ç†ä¸€äº›å¯¹ç¼–è¾‘å™¨æˆ–æ¸¸æˆå¿…è¦çš„ç³»ç»Ÿï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">&#x2F;**
* Global engine pointer. Can be 0 so don&#39;t use without checking.
*&#x2F;
ENGINE_API UEngine*	GEngine &#x3D; NULL;</code></pre>



<p>å®ƒæœ‰ä¸€ä¸ªæ´¾ç”Ÿç±»UGameEngineï¼Œç”¨æ¥ç®¡ç†æ”¯æŒæ¸¸æˆçš„æ ¸å¿ƒç³»ç»Ÿï¼ŒåŒ…å«ä¸€äº›æŒ‡é’ˆæ¯”å¦‚GameViewportWindowç­‰ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">&#x2F;**
 * Engine that manages core systems that enable a game.
 *&#x2F;
UCLASS(config&#x3D;Engine, transient)
class ENGINE_API UGameEngine
	: public UEngine
&#123;
    &#x2F;&#x2F; ...
public:      
	&#x2F;** The game viewport window *&#x2F;
	TWeakPtr&lt;class SWindow&gt; GameViewportWindow;
	&#x2F;** The primary scene viewport *&#x2F;
	TSharedPtr&lt;class FSceneViewport&gt; SceneViewport;
	&#x2F;** The game viewport widget *&#x2F;
	TSharedPtr&lt;class SViewport&gt; GameViewportWidget;
&#125;;</code></pre>



<p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ–°å»ºä¸€ä¸ªå­ç±»æŒ‡é’ˆã€æŠŠçˆ¶ç±»æŒ‡é’ˆGEngineè½¬æˆå­ç±»UGameEngineç±»å‹çš„æŒ‡é’ˆï¼Œè¿™ç§æƒ…å†µä¸‹ä¸ºä»€ä¹ˆèƒ½è®¿é—®åˆ°å­ç±»å•ç‹¬å®šä¹‰çš„æ•°æ®å‘¢ï¼Ÿ</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">UGameEngine* GameEngine &#x3D; Cast&lt;UGameEngine&gt;(GEngine);
OutSceneViewport &#x3D; GameEngine-&gt;SceneViewport;
OutInputWindow &#x3D; GameEngine-&gt;GameViewportWindow;</code></pre>



<p>è¿™å…¶å®å°±æ˜¯dynamic_castï¼ŒæŠŠåŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæ´¾ç”Ÿç±»æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œç›®çš„æ˜¯ä½¿ç”¨æ´¾ç”Ÿç±»çš„éè™šå‡½æ•°ã€è®¿é—®æ´¾ç”Ÿç±»çš„æˆå‘˜å˜é‡ã€‚</p>
<p>C++ 11æœ‰å››ç§ç±»å‹è½¬æ¢ï¼Œåœ¨æ­¤ç»“åˆä½¿ç”¨åœºæ™¯ç®€å•æ€»ç»“ä¸€ä¸‹ã€‚</p>
<h4 id="â‘ const-cast"><a href="#â‘ const-cast" class="headerlink" title="â‘ const_cast"></a>â‘ const_cast</h4><h5 id="ä¿®æ”¹å±æ€§å’Œç¼–è¯‘å™¨ä¼˜åŒ–"><a href="#ä¿®æ”¹å±æ€§å’Œç¼–è¯‘å™¨ä¼˜åŒ–" class="headerlink" title="ä¿®æ”¹å±æ€§å’Œç¼–è¯‘å™¨ä¼˜åŒ–"></a>ä¿®æ”¹å±æ€§å’Œç¼–è¯‘å™¨ä¼˜åŒ–</h5><p>const_castç”¨äºä¿®æ”¹constæˆ–volatileå±æ€§ã€‚ä¸€èˆ¬æ˜¯ç”¨æ¥å»æ‰constå±æ€§ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">const int a &#x3D; 1;

&#x2F;&#x2F; int* pa &#x3D; &amp;a;	&#x2F;&#x2F; é”™è¯¯ï¼Œconst int*ç±»å‹çš„å€¼ä¸èƒ½ç”¨äºåˆå§‹åŒ–int*ç±»å‹çš„å®ä½“
int* pa &#x3D; const_cast&lt;int*&gt;(&amp;a);	&#x2F;&#x2F; æ­£ç¡®ï¼Œå»æ‰äº†constå¸¸é‡açš„constå±æ€§ï¼Œå¯ä»¥èµ‹å€¼ç»™pa

&#x2F;&#x2F; int&amp; ra &#x3D; a;		&#x2F;&#x2F; é”™è¯¯
int&amp; ra &#x3D; const_cast&lt;int&amp;&gt;(a);	&#x2F;&#x2F; æ­£ç¡®</code></pre>



<p>é€šè¿‡ä»¥ä¸‹ä»£ç ï¼Œå°è¯•ç»™æŒ‡å‘â€œè§£é™¤constå±æ€§çš„å€¼â€çš„æŒ‡é’ˆå’Œå¼•ç”¨èµ‹å€¼ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">const int a &#x3D; 1;

int* pa &#x3D; const_cast&lt;int*&gt;(&amp;a);
*pa &#x3D; 10;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; &amp;a &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;

std::cout &lt;&lt; std::endl;

int&amp; ra &#x3D; const_cast&lt;int&amp;&gt;(a);
ra &#x3D; 5;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; &amp;a &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;ra:&quot; &lt;&lt; &amp;ra &lt;&lt; &#39; &#39; &lt;&lt; ra &lt;&lt; std::endl;</code></pre>

<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/1.png"/ loading="lazy">

<p>é¦–å…ˆï¼Œconst_castè¯´æ˜¯â€œå»æ‰constå±æ€§â€ï¼Œä½œç”¨çš„å¯¹è±¡ä¸æ˜¯aï¼Œè€Œæ˜¯æŒ‡å‘açš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚<u>ä¸ä¼šä¿®æ”¹aæœ¬èº«çš„constå±æ€§ï¼Œè€Œæ˜¯æŠŠæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆå’Œå¼•ç”¨å»æ‰äº†constå±æ€§ã€æä¾›äº†ä¿®æ”¹açš„ä¸€ä¸ªæ–°æ¥å£</u>ã€‚</p>
<p>ç„¶åï¼Œè¾“å‡ºç»“æœæœ‰äº›å¥‡æ€ªï¼š</p>
<ul>
<li>ç¬¬ä¸€ï¼ŒæŒ‡é’ˆã€å¼•ç”¨è½¬æ¢constå±æ€§å‰åï¼ŒæŒ‡å‘çš„å†…å­˜æ˜¯ä¸€æ ·çš„ã€‚æŠŠå¸¸é‡æŒ‡é’ˆ&#x2F;å¼•ç”¨è½¬æ¢æˆéå¸¸é‡çš„æŒ‡é’ˆ&#x2F;å¼•ç”¨ï¼Œä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ï¼Œç†è§£ä¸ºåªæ˜¯çœ‹å¾…è¯¥å†…å­˜çš„æ–¹å¼å˜äº†</li>
<li>ç¬¬äºŒï¼Œé€šè¿‡æŒ‡é’ˆå’Œå¼•ç”¨ä¿®æ”¹åŸå€¼ï¼Œå‘ç°åŸå€¼ä¾ç„¶æ²¡å˜ï¼ˆå¥½åƒæ˜¯ä¿ç•™äº†constå±æ€§ï¼‰ï¼Œä½†å»æ‰constå±æ€§çš„æŒ‡é’ˆå’Œå¼•ç”¨ä¹‹é—´å°±ä¼šç›¸äº’å½±å“</li>
</ul>
<p>æ—¢ç„¶åœ°å€ç›¸åŒï¼Œå€¼ä¹Ÿåº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œå¯èƒ½æ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–çš„åŸå› ã€‚è¿™é‡Œçš„ä¼˜åŒ–å¯èƒ½æ˜¯é€šè¿‡ç¬¦å·è¡¨ï¼Œè¯¦æƒ…è§ä¸‹é¢ä¸“é—¨è®²constå†…å­˜çš„å°èŠ‚ã€‚</p>
<p>åŠ ä¸Švolatileï¼Œå‘Šè¯‰ç¼–è¯‘å™¨açš„å€¼éšæ—¶å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼ˆè™½ç„¶å®ƒæ˜¯constï¼‰ï¼Œä¸è®©ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œæ¯æ¬¡éƒ½ä»å†…å­˜ä¸­å–å€¼ï¼Œå°±å‘ç°ç›¸åŒçš„åœ°å€çš„å€¼éƒ½ä¸€æ ·äº†ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">volatile const int a &#x3D; 1;
int* pa &#x3D; const_cast&lt;int*&gt;(&amp;a);

*pa &#x3D; 10;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; &amp;a &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;

std::cout &lt;&lt; std::endl;


int&amp; ra &#x3D; const_cast&lt;int&amp;&gt;(a);
ra &#x3D; 5;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; &amp;a &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;ra:&quot; &lt;&lt; &amp;ra &lt;&lt; &#39; &#39; &lt;&lt; ra &lt;&lt; std::endl;</code></pre>

<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/5.png"/ loading="lazy">



<h5 id="constå’Œvolatile"><a href="#constå’Œvolatile" class="headerlink" title="constå’Œvolatile"></a>constå’Œvolatile</h5><p>ä¸Šé¢çš„ä¾‹å­ï¼Œæ—¢ç„¶å·²ç»ç»™å˜é‡åŠ ä¸Šäº†constå±æ€§ï¼Œè¿˜èƒ½ç»™å®ƒåŠ ä¸Švolatileå±æ€§å—ï¼Ÿæœ‰æ„ä¹‰å—ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œå®ƒä»¬å„è‡ªçš„å«ä¹‰å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼š</p>
<ul>
<li>constå«ä¹‰æ˜¯â€œè¯·ä½œä¸ºå¸¸é‡ä½¿ç”¨â€ï¼Œå¯¹äºå±€éƒ¨constå˜é‡ï¼Œå¯ä»¥ç†è§£ä¸ºåŠ äº†ä¸€ä¸ªæ³¨é‡Šï¼Œè¡¨ç¤ºä¸€èˆ¬ä¸å¸Œæœ›åœ¨ç¨‹åºä¸­ä¿®æ”¹å®ƒçš„å€¼ã€‚å¹¶éâ€œè¿™è‚¯å®šæ˜¯ä¸€ä¸ªå¸¸é‡â€ï¼Œä¹Ÿå¹¶ä¸å­˜åœ¨å¸¸é‡åŒº</li>
<li>volatileçš„å«ä¹‰æ˜¯â€œç¼–è¯‘å™¨ä¸è¦è‡ªä»¥ä¸ºæ˜¯åœ°ä¼˜åŒ–ï¼Œè¿™ä¸ªå€¼éšæ—¶å¯èƒ½æ”¹å˜â€ã€‚å¹¶éâ€œä½ å¯ä»¥ä¿®æ”¹è¿™ä¸ªå€¼â€</li>
</ul>
<p>ç„¶åï¼Œå®ƒä»¬çš„ä½œç”¨å’Œèµ·ä½œç”¨çš„é˜¶æ®µæœ‰æ‰€ä¸åŒï¼š</p>
<ul>
<li>conståªåœ¨ç¼–è¯‘æœŸæœ‰ç”¨ï¼Œåœ¨è¿è¡ŒæœŸæ²¡ç”¨ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œconstä¿è¯å…¶ä¿®é¥°çš„å˜é‡åœ¨èŒƒå›´å†…æ²¡æœ‰è¢«ç›´æ¥ä»å€¼ä¸Šä¿®æ”¹ï¼›åœ¨è¿è¡ŒæœŸï¼Œå˜é‡çš„å€¼è¢«æ”¹å˜å°±ä¸å—consté™åˆ¶äº†</li>
<li>volatileåœ¨ç¼–è¯‘å™¨å’Œè¿è¡ŒæœŸéƒ½æœ‰ç”¨ã€‚åœ¨ç¼–è¯‘æœŸï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ä¸è¦ä¼˜åŒ–è¿™ä¸ªå˜é‡ï¼›åœ¨è¿è¡ŒæœŸï¼Œæ¯æ¬¡ç”¨åˆ°è¿™ä¸ªå˜é‡ï¼Œéƒ½ä»å†…å­˜ä¸­å–è¯¥å˜é‡çš„å€¼</li>
</ul>
<p>å› æ­¤ï¼Œconstå’ŒvolatileåŒæ—¶ä¿®é¥°ä¸€ä¸ªå˜é‡ï¼š</p>
<ul>
<li>å¯ä»¥ï¼Œvolatileå¹¶ä¸æ˜¯non-constçš„å«ä¹‰ï¼Œå®ƒä»¬ä¹‹é—´ä¸å†²çª</li>
<li>æœ‰æ„ä¹‰ï¼Œè¡¨ç¤ºå˜é‡åœ¨ç¨‹åºç¼–è¯‘æœŸä¸èƒ½è¢«ä¿®æ”¹ã€ä¸èƒ½è¢«ä¼˜åŒ–ï¼Œè¿è¡ŒæœŸå¯èƒ½ä¿®æ”¹ï¼Œæ¯æ¬¡ç”¨åˆ°æ—¶éƒ½å»å†…å­˜è¯»æ•°æ®ï¼Œé¿å…å‡ºé”™</li>
</ul>
<blockquote>
<p>ç¼–è¯‘å™¨ä¸€èˆ¬ä¸ä¸ºconstå˜é‡åˆ†é…å†…å­˜ï¼Œè€Œæ˜¯å°†å®ƒä¿å­˜åœ¨ç¬¦å·è¡¨ä¸­ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºä¸€ä¸ªç¼–è¯‘æœŸé—´çš„å€¼ï¼Œæ²¡æœ‰äº†å­˜å‚¨å’Œè¯»å†…å­˜çš„æ“ä½œã€‚</p>
<p>volatileçš„ä½œç”¨æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œiæ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ï¼Œæ¯æ¬¡ä½¿ç”¨å®ƒçš„æ—¶å€™å¿…é¡»ä»å†…å­˜ä¸­å–å‡ºiçš„å€¼ã€‚</p>
<p>â€”â€”ã€ŠCè¯­è¨€æ·±åº¦å‰–æã€‹</p>
</blockquote>
<h5 id="æ‰“å°volatileå˜é‡çš„åœ°å€"><a href="#æ‰“å°volatileå˜é‡çš„åœ°å€" class="headerlink" title="æ‰“å°volatileå˜é‡çš„åœ°å€"></a>æ‰“å°volatileå˜é‡çš„åœ°å€</h5><p>ä¸Šå›¾ä¸­ï¼Œä¸ºå•¥æ‰“å°volatileå˜é‡çš„åœ°å€ï¼Œç»“æœæ˜¯1ï¼Ÿå¯ä»¥çœ‹çœ‹<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8239262/why-is-the-address-of-this-volatile-variable-always-at-1">è¿™ä¸ªå¸–å­ï¼ˆæœ€é«˜èµå¥½åƒè¿˜ç­”é”™äº†ï¼‰</a>ã€‚ç®€å•æ¥è¯´ï¼Œostreamé‡è½½äº†<code>const void*</code>çš„<code>&lt;&lt;</code>è¿ç®—ç¬¦ï¼Œå¯¹äºä¸€èˆ¬çš„æŒ‡é’ˆ<code>T*</code>ä¼šéšå¼è½¬æ¢æˆ<code>const void*</code>æ¥è¾“å‡ºã€‚ä½†volatileå˜é‡çš„æŒ‡é’ˆä¸ä¼šéšå¼è½¬æ¢æˆæŒ‡é’ˆï¼Œè€Œè¢«è®¤ä½œäº†boolå˜é‡è¾“å‡º1ã€‚</p>
<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/2.png"/ loading="lazy">

<p>é‚£ä¹ˆä¸ºäº†ç”¨<code>&lt;&lt;</code>è¾“å‡ºvolatileå˜é‡çš„åœ°å€ï¼Œå°±éœ€è¦æ˜¾å¼è½¬æ¢ä¸€ä¸‹ã€‚ä½¿ç”¨static_castæ˜¯ä¸è¡Œçš„ï¼Œä¼šæŠ¥é”™ï¼šstatic_castæ— æ³•ä¸¢æ‰å¸¸é‡æˆ–å…¶ä»–ç±»å‹é™å®šç¬¦ã€‚</p>
<p>å› æ­¤åˆå›è¿‡å¤´æ¥ï¼Œä½¿ç”¨æœ¬å°èŠ‚è®²è¿°çš„å¯¹è±¡ï¼šconst_castï¼Œå»æ‰å˜é‡çš„volatileå±æ€§ï¼Œè½¬æ¢æˆæ™®é€šæŒ‡é’ˆ<code>T*</code>ã€å†è¢«éšå¼è½¬æ¢æˆ<code>const void*</code>æ¥è¾“å‡ºåœ°å€ã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">volatile int b &#x3D; 2;
std::cout &lt;&lt; const_cast&lt;int*&gt;(&amp;b) &lt;&lt; std::endl;

std::cout &lt;&lt; std::endl;

volatile const int a &#x3D; 1;
int* pa &#x3D; const_cast&lt;int*&gt;(&amp;a);
*pa &#x3D; 10;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; const_cast&lt;int*&gt;(&amp;a) &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;

std::cout &lt;&lt; std::endl;

int&amp; ra &#x3D; const_cast&lt;int&amp;&gt;(a);
ra &#x3D; 5;
std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; const_cast&lt;int*&gt;(&amp;a) &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pa:&quot; &lt;&lt; pa &lt;&lt; &#39; &#39; &lt;&lt; *pa &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;ra:&quot; &lt;&lt; &amp;ra &lt;&lt; &#39; &#39; &lt;&lt; ra &lt;&lt; std::endl;</code></pre>

<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/4.png"/ loading="lazy">



<p>æˆ–è€…ï¼Œ<code>&lt;&lt;</code>è¿ç®—ç¬¦ç”¨ä¸äº†å¯ä»¥ç”¨<code>printf</code>ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">volatile const int a &#x3D; 1;

std::cout &lt;&lt; &amp;a &lt;&lt; std::endl;		&#x2F;&#x2F; è¾“å‡º1
printf(&quot;%p\n&quot;, &amp;a);		&#x2F;&#x2F; è¾“å‡ºåœ°å€
std::cout &lt;&lt; const_cast&lt;int*&gt;(&amp;b) &lt;&lt; std::endl;		&#x2F;&#x2F; è¾“å‡ºåœ°å€</code></pre>



<p>é¡ºå¸¦ä¸€æï¼Œæ™®é€šç±»å‹è½¬æ¢æˆconstç±»å‹å…·ä½“æ˜¯ä»€ä¹ˆè§„åˆ™æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ã€‚åœ¨UE4é‡Œï¼Œæˆ‘æ–°å»ºäº†ä¸€ä¸ª<code>TMap&lt;const SWidget*, int32&gt;</code>ï¼Œé‚£å°±å¿…é¡»ç»™å®ƒåŠ å…¥<code>const</code>ç±»å‹çš„<code>SWidget*</code>ï¼Œå¦åˆ™å°±ä¼šæœ‰æ¨¡æ¿æŠ¥é”™ã€‚å½“ç„¶ä¹Ÿå¿…é¡»å°±æ˜¯è¿™ç§åŸç”ŸæŒ‡é’ˆï¼Œå…¶ä»–å°è£…åçš„æ™ºèƒ½æŒ‡é’ˆä¹Ÿä¸è¡Œã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">TMap&lt;const SWidget*, int32&gt; WidgetIndexMap;

&#x2F;&#x2F; ...
void function(const SWidget* Widget, ...)
&#123;
    int32 Index &#x3D; XXXLists.Add(NewList);
	WidgetIndexMap.Emplace(Widget, Index);
&#125;

&#x2F;&#x2F; ...
const SWidget* WidgetPtr &#x3D; ...;
if(WidgetIndexMap.Contains(WidgetPtr))
&#123;
	int32 RnederBatchIdnex &#x3D; WidgetIndexMap[WidgetPtr];
&#125;</code></pre>



<h5 id="è¡¥å……ï¼šconstå†…å­˜å’Œå…¶ä»–"><a href="#è¡¥å……ï¼šconstå†…å­˜å’Œå…¶ä»–" class="headerlink" title="è¡¥å……ï¼šconstå†…å­˜å’Œå…¶ä»–"></a>è¡¥å……ï¼šconstå†…å­˜å’Œå…¶ä»–</h5><p>å¯¹äºä¸Šè¿°é€šè¿‡æŒ‡é’ˆã€å¼•ç”¨ï¼ˆä¹Ÿå°±æ˜¯åœ°å€ï¼‰æ¥ä¿®æ”¹constå˜é‡çš„å€¼ï¼Œåªå¯¹å±€éƒ¨å˜é‡æœ‰æ•ˆã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">const int ga &#x3D; 1;

int main()
&#123;
    int* pga &#x3D; const_cast&lt;int*&gt;(&amp;ga);
	*pga &#x3D; 10;		&#x2F;&#x2F; è¿è¡Œæ—¶æŠ¥é”™
	std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; const_cast&lt;int*&gt;(&amp;a) &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
    
	int&amp; rga &#x3D; const_cast&lt;int&amp;&gt;(ga);
	rga &#x3D; 20;		&#x2F;&#x2F; è¿è¡Œæ—¶æŠ¥é”™
	std::cout &lt;&lt; &quot;a:&quot; &lt;&lt; const_cast&lt;int*&gt;(&amp;a) &lt;&lt; &#39; &#39; &lt;&lt; a &lt;&lt; std::endl;
&#125;</code></pre>

<p>å¦‚æœè¿›è¡Œä¸Šé¢ä»£ç ä¸­çš„æ“ä½œï¼Œè¯•å›¾ä¿®æ”¹å…¨å±€constå˜é‡çš„å€¼ï¼Œç¼–è¯‘å™¨ä¸æŠ¥é”™ï¼Œä½†è¿è¡Œæ—¶åœ¨æŒ‡é’ˆã€å¼•ç”¨èµ‹å€¼çš„åœ°æ–¹æŠ¥é”™ï¼šâ€œå¼•å‘äº†å¼‚å¸¸ï¼šå†™å…¥è®¿é—®æƒé™å†²çªâ€ã€‚</p>
<p>è¿™æ˜¯ç”±C++ constçš„å†…å­˜åˆ†é…æ–¹å¼å¯¼è‡´çš„ã€‚å…³äºå†…å­˜ã€constçš„æ›´å¤šä¿¡æ¯ã€constå¼•ç”¨ä¼ å‚ï¼Œè§<a href="https://acbgzm.github.io/2022/09/07/ue-2/">ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ2ï¼‰æºç é˜…è¯»æ”¯çº¿ä¹‹å¦‚ä½•ç†è§£C++çš„constå…³é”®å­—ï¼Ÿ</a>ã€‚</p>
<h5 id="const-castçš„ä½¿ç”¨"><a href="#const-castçš„ä½¿ç”¨" class="headerlink" title="const_castçš„ä½¿ç”¨"></a>const_castçš„ä½¿ç”¨</h5><p>è¢«const_castè½¬æ¢çš„ç±»å‹<strong>å¿…é¡»æ˜¯æŒ‡é’ˆã€å¼•ç”¨</strong>æˆ–æŒ‡å‘å¯¹è±¡ç±»å‹æˆå‘˜çš„æŒ‡é’ˆã€‚ä¹Ÿå°±æ˜¯ï¼Œ<u>ä¸èƒ½æŠŠåŸºæœ¬ç±»å‹å˜é‡å’Œå¯¹è±¡è½¬æ¢æˆéå¸¸é‡</u>ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">const Student stu1;
Student stu2 &#x3D; const_cast&lt;Student&gt;(stu1);	&#x2F;&#x2F; é”™è¯¯

const int x &#x3D; 10;
int y &#x3D; const_cast&lt;int&gt;(i);	&#x2F;&#x2F; é”™è¯¯</code></pre>

<p>ä½¿ç”¨const_castå»æ‰constå±æ€§ï¼Œå¹¶ä¸æ˜¯çœŸçš„æƒ³æ”¹å˜åŸç±»å‹çš„constå±æ€§ï¼Œåªæ˜¯åˆæä¾›äº†ä¸€ä¸ªæ¥å£ï¼ˆæŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰ã€‚å› ä¸ºå‰æ–‡ï¼ˆè¡¥å……çš„æ–‡ç« ï¼‰æåˆ°ï¼Œå¯¹å…¨å±€constï¼Œä½¿ç”¨åœ°å€ä¹Ÿæ— æ³•ä¿®æ”¹å…¶å€¼ï¼›å¯¹äºå±€éƒ¨constï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ³¨é‡Šï¼Œå¯ä»¥ç”¨æ¥å£ä¿®æ”¹å…¶å€¼ã€‚</p>
<h4 id="â‘¡reinterpret-cast"><a href="#â‘¡reinterpret-cast" class="headerlink" title="â‘¡reinterpret_cast"></a>â‘¡reinterpret_cast</h4><h5 id="çµæ´»ä½†ä¸å®‰å…¨çš„è½¬æ¢"><a href="#çµæ´»ä½†ä¸å®‰å…¨çš„è½¬æ¢" class="headerlink" title="çµæ´»ä½†ä¸å®‰å…¨çš„è½¬æ¢"></a>çµæ´»ä½†ä¸å®‰å…¨çš„è½¬æ¢</h5><p>ä»å•è¯æ„æ€ä¸Šçœ‹ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠç›¸åŒå†…å­˜ä¸­çš„æ•°æ®â€œé‡æ–°è§£é‡Šâ€ï¼Œæ¦‚å¿µä¸Šåƒunionã€‚æ¯”å¦‚è¿›è¡Œ<u>ä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´ã€ä¸åŒç±»å‹çš„å¼•ç”¨ä¹‹é—´ã€æŒ‡é’ˆå’Œèƒ½å®¹çº³æŒ‡é’ˆçš„æ•´æ•°ç±»å‹ä¹‹é—´çš„è½¬æ¢</u>ã€‚è½¬æ¢æ—¶æ‰§è¡Œé€ä¸ªbitå¤åˆ¶çš„æ“ä½œã€‚</p>
<p>è¿™ç§è½¬æ¢ç±»å‹æä¾›äº†å¾ˆå¼ºçš„çµæ´»æ€§ï¼Œä½†å®‰å…¨æ€§éœ€è¦ç¨‹åºå‘˜æ¥ä¿è¯ã€‚</p>
<p>ä¸‹é¢çš„æ¡ˆä¾‹å¤è¿°è‡ª<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33040213">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">int num &#x3D; 0x00636261;
int* pnum &#x3D; &amp;num;
char* pstr &#x3D; reinterpret_cast&lt;char*&gt;(pnum);	&#x2F;&#x2F; æŠŠint*é‡æ–°çœ‹æˆchar*
std::cout &lt;&lt; &quot;pnum: &quot; &lt;&lt; pnum &lt;&lt; &quot;, &quot; &lt;&lt; std::hex &lt;&lt; *pnum &lt;&lt; std::endl;
std::cout &lt;&lt; &quot;pstr: &quot; &lt;&lt; static_cast&lt;void*&gt;(pstr) &lt;&lt; &quot;, &quot; &lt;&lt; pstr &lt;&lt; std::endl;	&#x2F;&#x2F; å¯¹äºchar*æŒ‡é’ˆï¼Œç›´æ¥è¾“å‡ºä¼šè¾“å‡ºå­—ç¬¦ä¸²ï¼Œè¦è½¬æˆvoid*è¾“å‡ºå®ƒæŒ‡å‘çš„åœ°å€</code></pre>

<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/8.png"/ loading="lazy">

<p>åœ¨ä¸Šé¢çš„ç¨‹åºç‰‡æ®µä¸­ï¼Œé¦–å…ˆå®šä¹‰intå˜é‡numï¼Œç”¨åå…­è¿›åˆ¶å€¼0x00636261åˆå§‹åŒ–ï¼›ç„¶åå®šä¹‰int* pnumæŒ‡å‘numï¼›ç„¶åä½¿ç”¨reinterpret_castï¼ŒæŠŠint*ç±»å‹çš„æŒ‡é’ˆpnumè½¬æ¢æˆäº†char*ç±»å‹çš„æŒ‡é’ˆpstrã€‚</p>
<p>å¯¹æ¯”è¾“å‡ºä¸¤ä¸ªæŒ‡é’ˆï¼Œå‘ç°å®ƒä»¬çš„åœ°å€æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯reinterpret_castä¸æ”¹å˜æ“ä½œå¯¹è±¡çš„å€¼ï¼Œè€Œæ˜¯æ”¹å˜äº†çœ‹å¾…åŒä¸€å—å†…å­˜åŒºåŸŸçš„æ–¹å¼ã€‚</p>
<blockquote>
<p>ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆæ˜¯å¦‚ä½•åœ°ä¸ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆæˆ–ä¸€ä¸ªæŒ‡å‘å…¶ä»–è‡ªå®šä¹‰ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆæœ‰æ‰€ä¸åŒå‘¢ï¼Ÿä»å†…å­˜éœ€æ±‚çš„è§‚ç‚¹æ¥è¯´ï¼Œæ²¡æœ‰ä»€ä¹ˆä¸åŒï¼å®ƒä»¬ä¸‰ä¸ªéƒ½éœ€è¦è¶³å¤Ÿçš„å†…å­˜ï¼ˆå¹¶ä¸”æ˜¯ç›¸åŒå¤§å°çš„å†…å­˜ï¼‰æ¥æ”¾ç½®ä¸€ä¸ªæœºå™¨åœ°å€ã€‚æŒ‡å‘ä¸åŒç±»å‹ä¹‹å„æŒ‡é’ˆé—´çš„å·®å¼‚ï¼Œæ—¢ä¸åœ¨å…¶æŒ‡é’ˆè¡¨ç¤ºæ³•ä¸åŒï¼Œä¹Ÿä¸åœ¨å…¶å†…å®¹ï¼ˆä»£è¡¨ä¸€ä¸ªåœ°å€ï¼‰ä¸åŒï¼Œè€Œæ˜¯åœ¨å…¶æ‰€å¯»å€å‡ºæ¥çš„å¯¹è±¡ç±»å‹ä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‡é’ˆç±»å‹ä¼šæ•™å¯¼ç¼–è¯‘å™¨å¦‚ä½•è§£é‡ŠæŸä¸ªç‰¹å®šåœ°å€ä¸­çš„å†…å­˜å†…å®¹åŠå…¶å¤§å°ã€‚</p>
<p>â€”â€”ã€Šæ·±åº¦æ¢ç´¢C++å¯¹è±¡æ¨¡å‹ã€‹</p>
</blockquote>
<p>å¦‚å›¾ï¼š</p>
<ul>
<li><img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/7.png" style="zoom:50%;" / loading="lazy"></li>
</ul>
<p>ä½¿ç”¨reinterpret_castæŠŠpnumä»int*è½¬å˜æˆchar*ç±»å‹çš„æŒ‡é’ˆï¼Œå¹¶åˆå§‹åŒ–pstråï¼Œpsträ¹ŸæŒ‡å‘numçš„å†…å­˜åŒºåŸŸï¼Œå¹¶ä¸”æŒ‰ç…§æŒ‡é’ˆçš„ç±»å‹ï¼ˆchar*ï¼‰å¯¹åº”çš„è§„åˆ™æ¥è§£è¯»è¿™ä¸ªå†…å­˜åŒºåŸŸã€‚ä¸€ä¸ªcharå ç”¨ä¸€ä¸ªByteï¼Œå¯¹pstrè§£å¼•ç”¨ï¼Œå¾—åˆ°çš„å°†æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯aï¼ˆ0x61æ˜¯açš„ASCIIç ï¼‰ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¾“å‡ºäº†ä¸‰ä¸ªå­—ç¬¦ï¼Ÿè¿™æ˜¯ç”±äºåœ¨è¾“å‡ºchar*æŒ‡é’ˆæ—¶ï¼Œostreamä¼šæŠŠå®ƒå½“åšè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²æ¥å¤„ç†ï¼Œç›´è‡³é‡åˆ°<code>&#39;\0&#39;</code>æ‰è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸã€‚å¦‚æœå°†numçš„å€¼æ”¹ä¸º0x63006261ï¼Œè¾“å‡ºçš„å­—ç¬¦ä¸²å°±å˜ä¸ºâ€abâ€ã€‚</p>
<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/9.png"/ loading="lazy">

<p>å†æ”¹ä¸º0x64636261åï¼Œä½œè€…è¾“å‡ºå­—ç¬¦ä¸²é™¤äº†abcdåé¢è¿˜æœ‰6ä¸ªå­—ç¬¦ï¼Œä½†æˆ‘è¯•ç€å°±åªè¾“å‡ºabcdäº†ã€‚</p>
<h5 id="è¡¥å……ï¼šendian"><a href="#è¡¥å……ï¼šendian" class="headerlink" title="è¡¥å……ï¼šendian"></a>è¡¥å……ï¼šendian</h5><p>ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œä¸ºä»€ä¹ˆè¾“å‡º16è¿›åˆ¶æ•°å­—æ˜¯0x00636261ï¼Œè¾“å‡ºå­—ç¬¦ä¸²å´æˆäº†abcï¼ˆ61 62 63ï¼‰ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºåœ¨reinterpret_castä¸­ï¼Œå­˜åœ¨å­—èŠ‚åºï¼ˆendianï¼‰é—®é¢˜ã€‚æŸ¥çœ‹<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/29452981/answer/44418335">è¿™ä¸ªé—®é¢˜ä¸‹miloçš„å›ç­”</a>ã€‚</p>
<p>æ•´æ•°ç±»å‹static_castï¼ŒæŒ‡é’ˆ++&#x2F;â€“éƒ½ä¸æ¶‰åŠcastingå’Œå­—èŠ‚åºé—®é¢˜ã€‚æŠŠæŒ‡é’ˆç±»å‹reinterpret_castï¼Œæˆ–è€…ä½¿ç”¨unionè½¬æ¢äº†ç±»å‹ï¼Œå°±æœ‰å­—èŠ‚åºé—®é¢˜ã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">int a &#x3D; 0x12345678;
char* c &#x3D; reinterpret_cast&lt;char*&gt;(&amp;a);
printf(&quot;%x %x %x %x\n&quot;, c[0], c[1], c[2], c[3]);

union
&#123;
	int a;
	char c[4];
&#125;u;
u.a &#x3D; 0x12345678;
printf(&quot;%x %x %x %x\n&quot;, u.c[0], u.c[1], u.c[2], u.c[3]);</code></pre>

<img src="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ue-img/10.png"/ loading="lazy">

<p>ä»è¿™ä¸ªç­”æ¡ˆå’Œæˆ‘çš„è¾“å‡ºå¯ä»¥ç¡®å®šæˆ‘çš„ç”µè„‘æ˜¯little-endianã€‚æ¥ä¸‹æ¥è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯endianï¼š</p>
<ul>
<li>å¯¹äºå¤šå­—èŠ‚çš„æ•°æ®ï¼Œè®¡ç®—æœºä¸€å®šä»ä½åœ°å€å‘é«˜åœ°å€å­˜å‚¨</li>
<li>big-endiançš„è®¡ç®—æœºï¼ŒæŠŠæ•°æ®çš„é«˜å­—èŠ‚ï¼ˆæ¯”å¦‚æ•°çš„é«˜ä½ï¼‰å­˜åˆ°ä½åœ°å€ã€ä½å­—èŠ‚å­˜åˆ°é«˜åœ°å€ï¼Œä¹Ÿå°±æ˜¯æŒ‰äººç±»è¯»æ•°çš„é¡ºåºæ¥å­˜ã€‚å¯¹äºint32 çš„ 0x12345678ï¼Œä»ä½åœ°å€åˆ°é«˜åœ°å€çš„å››ä¸ªå­—èŠ‚åˆ†åˆ«å­˜ 0x12ã€0x34ã€0x56ã€0x78</li>
<li>little-endiançš„è®¡ç®—æœºï¼Œæ•°æ®çš„ä½å­—èŠ‚å­˜å…¥ä½åœ°å€ã€é«˜å­—èŠ‚å­˜å…¥é«˜åœ°å€ã€‚åŒä¸€ä¸ªä¾‹å­ï¼Œå­—èŠ‚å­˜æ”¾é¡ºåºä»ä½åœ°å€åˆ°é«˜åœ°å€ä¸ºï¼š0x78ã€0x56ã€0x34ã€0x12</li>
</ul>
<p>äººä»¬é˜…è¯»å†…å­˜çš„é¡ºåºæ€»æ˜¯å¤§ç«¯åºçš„ã€‚è€Œä¸”å°ç«¯åºçš„æ¯ä¸ªå­—èŠ‚å†…éƒ¨è¿˜æ˜¯ä¿ç•™äº†å¤§ç«¯åºçš„å½¢å¼ï¼Œè€Œä¸æ˜¯å…¨éƒ¨åè¿‡æ¥ï¼Œè¿™è®©å°ç«¯åºåœ¨äººç±»çš„è„‘å­é‡Œæ›´å®¹æ˜“æ··æ·†ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¢«ä½¿ç”¨å‘¢ï¼Ÿå› ä¸ºè‡³å°‘åœ¨1970sï¼Œå½“CPUåªæœ‰å‡ åƒä¸ªé€»è¾‘é—¨çš„æ—¶å€™ï¼Œå°ç«¯åºæ›´åŠ æœ‰æ•ˆç‡ã€‚å› æ­¤ï¼Œå¾ˆå¤šå†…éƒ¨å¤„ç†éƒ½æ˜¯å°ç«¯åºçš„ï¼Œå¹¶ä¸”ä¹Ÿæ¸—é€åˆ°ä¸€äº›å¤–éƒ¨æ ¼å¼ä¸­ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¤§ç«¯åºå¯¹äººç±»æ›´å®¹æ˜“ç†è§£ï¼Œå› æ­¤å¯¹äºæ ¼å¼è§„èŒƒï¼Œå¦‚ç½‘ç»œåè®®ã€æ–‡ä»¶æ ¼å¼ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å¤§ç«¯åºçš„ã€‚</p>
<h5 id="reinterpret-castçš„ä½¿ç”¨"><a href="#reinterpret-castçš„ä½¿ç”¨" class="headerlink" title="reinterpret_castçš„ä½¿ç”¨"></a>reinterpret_castçš„ä½¿ç”¨</h5><p>è¿™ä¸ªâ€œé‡æ–°è§£é‡Šâ€å¯ä»¥å®ç°ä¸¤ä¸ªä½œç”¨ï¼š</p>
<ul>
<li>æŒ‡é’ˆå’Œæ•´æ•°ä¹‹é—´çš„è½¬æ¢</li>
<li>ä¸åŒç±»å‹çš„æŒ‡é’ˆ&#x2F;æˆå‘˜æŒ‡é’ˆ&#x2F;å¼•ç”¨ä¹‹é—´çš„è½¬æ¢</li>
</ul>
<p>å¯¹äºç¬¬ä¸€ä¸ªä½œç”¨ï¼Œå¯ä»¥ç”¨æ¥åœ¨æŒ‡é’ˆä¸­å­˜å‚¨é¢å¤–ä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨ç‰¹å®šå¹³å°ä¸Šï¼Œå¦‚æœæŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯4å­—èŠ‚å¯¹é½çš„ï¼Œé‚£ä¹ˆæŒ‡é’ˆè½¬æˆçš„æ•´æ•°çš„æœ€ä½ä¸¤bitä½ä¸€å®šéƒ½æ˜¯0ï¼ˆå› ä¸ºéƒ½æŒ‡å‘0x00ï¼Œ0x04ï¼Œ0x08ï¼Œ0x0cè¿™æ ·çš„åœ°å€ï¼‰ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸¤ä½å­˜å‚¨å…¶ä»–æ•°æ®ã€‚</p>
<p>ç¬¬äºŒä¸ªä½œç”¨ï¼Œå¯ä»¥ç”¨æ¥é€šè¿‡æˆå‘˜è®¿é—®åˆ°å®Œæ•´çš„ç»“æ„ä½“å¯¹è±¡ï¼Œæˆ–è€…ä»å®Œæ•´çš„ç»“æ„ä½“å¯¹è±¡è®¿é—®é—´æ¥æˆå‘˜ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ä»¥ä¸ŠåŠŸèƒ½ï¼ŒæŠŠç±»å‹ä¸ç¬¦åˆçš„æ•°æ®ç¡¬å¡åˆ°å®¹å™¨ä¸­ã€‚è™½ç„¶éœ€è¦ä½¿ç”¨è€…é¢å¤–æ³¨æ„æ‰èƒ½ä¿è¯ç±»å‹å®‰å…¨ï¼Œä½†æœ‰æ—¶å€™èƒ½é™ä½æ•°æ®ç»“æ„çš„å¤æ‚ç¨‹åº¦ã€‚</p>
<p>è¦æ˜¯åªä»ä½¿ç”¨çš„è§’åº¦ä¸Šæ¥è¯´ï¼ŒC++çš„è¿™äº›è½¬æ¢æ˜¯ä¸ºäº†ä»£æ›¿Cè¯­è¨€ç”¨æ‹¬å·æ‰§è¡Œçš„å¼ºåˆ¶è½¬æ¢ã€‚å¦‚æœæ¢æˆ<code>const_cast</code>æˆ–è€…<code>static_cast</code>åˆæ³•ï¼Œå°±å…·æœ‰ç›¸ä¼¼çš„è½¬æ¢è¡Œä¸ºï¼›å¦‚æœä¸åˆæ³•ï¼Œå°±å¯ä»¥è¦è€ƒè™‘ä½¿ç”¨<code>reinterpret_cast</code>ã€‚</p>
<p>ç›¸å½“äºå‘Šè¯‰ç¼–è¯‘å™¨ï¼šæˆ‘ç”¨å…¶ä»–çš„è½¬æ¢ä½ ä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆæˆ‘å°±ç”¨<code>interpret_cast</code>ï¼Œå¯¹äºç±»å‹æˆ‘å¿ƒé‡Œæœ‰æ•°ï¼Œä½ ä¸è¦æŠ¥é”™ã€‚</p>
<p>æ€»ä¹‹ï¼Œreinterpret_castè¾ƒå±é™©ï¼Œä½¿ç”¨è¾ƒå°‘ã€‚</p>
<h4 id="â‘¢static-cast"><a href="#â‘¢static-cast" class="headerlink" title="â‘¢static_cast"></a>â‘¢static_cast</h4><p>é¢˜å¤–è¯ï¼š</p>
<p>è™½ç„¶const_castæ˜¯ç”¨æ¥å»é™¤constæŒ‡é’ˆæˆ–å¼•ç”¨çš„constå±æ€§çš„ï¼Œä½†static_castå´ä¸æ˜¯ç”¨æ¥å»æ‰å˜é‡staticå±æ€§çš„ã€‚å› ä¸ºstaticå®é™…ä¸Šå†³å®šçš„æ˜¯ä¸€ä¸ªå˜é‡çš„ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸï¼Œæ”¹å˜staticå±æ€§ä¼šé€ æˆèŒƒå›´æ€§çš„å½±å“ï¼Œè€Œconståªæ˜¯é™å®šä¸€ä¸ªå˜é‡è‡ªå·±ã€‚</p>
<p>ä½†æ— è®ºæ˜¯å“ªä¸€ä¸ªå±æ€§ï¼Œéƒ½æ˜¯åœ¨å˜é‡ä¸€å‡ºç”Ÿï¼ˆå®Œæˆç¼–è¯‘çš„æ—¶å€™ï¼‰å°±å†³å®šäº†çš„å˜é‡çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å®é™…ä¸Šéƒ½æ˜¯ä¸å®¹è®¸æ”¹å˜çš„ã€‚è¿™ç‚¹åœ¨å‰æ–‡å·²ç»çœ‹åˆ°äº†ï¼Œconst_castä¹Ÿå°±æ˜¯ç»™constå¸¸é‡çš„æŒ‡é’ˆæˆ–å¼•ç”¨å»é™¤constå±æ€§ï¼Œç»™åŸå¸¸é‡æä¾›ä¸€ä¸ªæ–°çš„æ¥å£ï¼Œå¹¶æ²¡æœ‰çœŸæ­£ä¿®æ”¹å¯¹è±¡æœ¬èº«çš„constå±æ€§ï¼ˆè¿˜æ˜¯ä¸èƒ½ç›´æ¥ç»™å®ƒèµ‹å€¼ï¼‰ã€‚</p>
<p>å›åˆ°static_castï¼Œä¸€èˆ¬ç”¨å®ƒæ¥ä»£æ›¿Cè¯­è¨€çš„ç±»å‹è½¬æ¢ã€‚å®ƒè·Ÿreinterpret_castä¸€æ ·ï¼Œéƒ½ä¸èƒ½å»é™¤æŒ‡é’ˆæˆ–å¼•ç”¨çš„consté™å®šï¼Œè·Ÿconst_castçš„åˆ†å·¥æœ‰æ‰€åŒºåˆ«ã€‚å…¶ä»–ä¸€äº›åŒºåˆ†ï¼š</p>
<ul>
<li>static_castä¸ä»…å¯ä»¥ç”¨åœ¨æŒ‡é’ˆå’Œå¼•ç”¨ä¸Šï¼Œè¿˜å¯ä»¥ç”¨åœ¨åŸºç¡€æ•°æ®ç±»å‹å’Œå¯¹è±¡ä¸Š</li>
<li>reinterpret_castå¯ä»¥ç”¨äºâ€œå®Œå…¨æ²¡æœ‰å…³ç³»â€çš„ç±»å‹ä¹‹é—´ï¼Œstatic_castéœ€è¦è½¬æ¢çš„åŒæ–¹â€œæœ‰ä¸€ç‚¹å…³ç³»â€</li>
<li>static_castä¼šè¿›è¡Œç¼–è¯‘æœŸç±»å‹æ£€æŸ¥ï¼Œä½†ä¸ä¼šè¿›è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥</li>
</ul>
<h5 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h5><p>static_castçš„ä½œç”¨ï¼š</p>
<ul>
<li>åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢</li>
<li>ç±»å±‚çº§ç»“æ„ä¸­ï¼ŒåŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´çš„æŒ‡é’ˆæˆ–å¼•ç”¨çš„è½¬æ¢<ul>
<li>è¿›è¡Œä¸Šè¡Œè½¬æ¢ï¼ˆæŠŠæ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆåŸºç±»ï¼‰æ˜¯å®‰å…¨çš„</li>
<li>è¿›è¡Œä¸‹è¡Œè½¬æ¢ï¼ˆåŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæ´¾ç”Ÿç±»ï¼‰ï¼Œç”±äºæ²¡æœ‰è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºæ´¾ç”Ÿç±»ä¸­å¯èƒ½å®šä¹‰äº†åŸºç±»ä¸­æ²¡æœ‰çš„æˆå‘˜å˜é‡</li>
</ul>
</li>
<li>æŠŠç©ºæŒ‡é’ˆè½¬æ¢æˆç›®æ ‡ç±»å‹çš„ç©ºæŒ‡é’ˆ</li>
<li>æŠŠä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼è½¬æ¢æˆvoidç±»å‹</li>
</ul>
<p>static_cast ä¸èƒ½ç”¨äºåœ¨ä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´äº’ç›¸è½¬æ¢ï¼Œä¹Ÿä¸èƒ½ç”¨äºæ•´å‹å’ŒæŒ‡é’ˆä¹‹é—´çš„äº’ç›¸è½¬æ¢ï¼Œå½“ç„¶ä¹Ÿä¸èƒ½ç”¨äºä¸åŒç±»å‹çš„å¼•ç”¨ä¹‹é—´çš„è½¬æ¢ã€‚å› ä¸ºè¿™äº›å±äºé£é™©æ¯”è¾ƒé«˜çš„è½¬æ¢ã€‚</p>
<p>åœ¨æŒ‡é’ˆå’Œå¼•ç”¨æ–¹é¢ï¼Œä¼¼ä¹ä¹Ÿåªæœ‰ç»§æ‰¿å…³ç³»æ˜¯å¯ä»¥è¢«static_castæ¥å—çš„ï¼Œå…¶ä»–æƒ…å†µçš„æŒ‡é’ˆå’Œå¼•ç”¨è½¬æ¢éƒ½ä¼šè¢«static_castç›´æ¥æ‰”å‡ºç¼–è¯‘é”™è¯¯ï¼Œè€Œè¿™å±‚å…³ç³»ä¸Šçš„è½¬æ¢åˆå‡ ä¹éƒ½å¯ä»¥è¢«dynamic_castæ‰€ä»£æ›¿ã€‚è¿™æ ·çœ‹èµ·æ¥static_castçš„ä½œç”¨å°±æ¯”è¾ƒå°äº†ã€‚</p>
<p>static_castçœŸæ­£ç”¨å¤„å¹¶ä¸åœ¨æŒ‡é’ˆå’Œå¼•ç”¨ä¸Šï¼Œè€Œåœ¨åŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„è½¬æ¢ä¸Šã€‚è€ŒåŸºäºåŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„è½¬æ¢éƒ½æ˜¯å…¶ä»–ä¸‰ä¸ªè½¬æ¢è¿ç®—ç¬¦æ‰€åŠä¸åˆ°çš„ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ã€‚</p>
<p>åŸºæœ¬æ•°æ®ç±»å‹ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">char a &#x3D; &#39;a&#39;;
int b &#x3D; static_cast&lt;int&gt;(a);	&#x2F;&#x2F; æ­£ç¡®

double* c &#x3D; new double;
void* d &#x3D; static_cast&lt;void*&gt;(c);	&#x2F;&#x2F; æ­£ç¡®

int e &#x3D; 10;
const int f &#x3D; static_cast&lt;const int&gt;(e);	&#x2F;&#x2F; æ­£ç¡®ï¼Œç»™å˜é‡åŠ ä¸Šconstå±æ€§

const int g &#x3D; 20;
int* h &#x3D; static_cast&lt;int*&gt;(&amp;g);		&#x2F;&#x2F; ç¼–è¯‘é”™è¯¯ï¼Œstatic_castä¸èƒ½å»æ‰å¸¸é‡å¯¹è±¡çš„å¼•ç”¨æˆ–æŒ‡é’ˆçš„constå±æ€§</code></pre>



<p>ç±»å±‚çº§ç»“æ„ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">class Parents
&#123;
public:
    virtual ~Parents()&#123;&#125;
    &#x2F;&#x2F; ...
&#125;;

class Children : public Parents
&#123;
    &#x2F;&#x2F; ...
&#125;;

int main()
&#123;
    Child* daughter &#x3D; new Children();
    Parents* mother &#x3D; static_cast&lt;Parents*&gt; (daughter);	&#x2F;&#x2F; right, cast with polymorphism
    
    Parents* father &#x3D; new Parents();
    Children* son &#x3D; static_cast&lt;Children*&gt; (father);	&#x2F;&#x2F; no error, but not safe	
&#125;</code></pre>

<p>ä»åŸºç±»åˆ°å­ç±»çš„è½¬æ¢ï¼Œä½¿ç”¨static_castæ˜¯ä¸å®‰å…¨çš„ï¼Œåœ¨åé¢çš„dynamic_casté‡Œè®²ã€‚</p>
<p>æŒ‡é’ˆå’Œå¼•ç”¨ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">class A
&#123;
public:
	operator int() &#123; return 1; &#125;
	operator char* () &#123; return nullptr; &#125;
&#125;;

int main()
&#123;
	A a;
	int n;
	char* p &#x3D; const_cast&lt;char*&gt;(&quot;abcd&quot;);
	
	n &#x3D; static_cast&lt;int&gt;(3.14159);	&#x2F;&#x2F; nå˜ä¸º3
    
	n &#x3D; static_cast&lt;int&gt;(a);	&#x2F;&#x2F; è°ƒç”¨a.operator int()ï¼Œè¿”å›1
	p &#x3D; static_cast&lt;char*&gt;(a);	&#x2F;&#x2F; è°ƒç”¨a.operator char*()ï¼Œè¿”å›ç©ºæŒ‡é’ˆ
    
    n &#x3D; static_cast&lt;int&gt;(p);	&#x2F;&#x2F; ç¼–è¯‘é”™è¯¯ï¼Œstatic_castä¸èƒ½è¿›è¡Œæ•´å½¢å’ŒæŒ‡é’ˆä¹‹é—´çš„è½¬æ¢
	p &#x3D; static_cast&lt;char*&gt;(n);	&#x2F;&#x2F; ç¼–è¯‘é”™è¯¯ï¼Œstatic_castä¸èƒ½è¿›è¡Œæ•´å½¢å’ŒæŒ‡é’ˆä¹‹é—´çš„è½¬æ¢
    
	return 0;
&#125;</code></pre>





<h4 id="â‘£dynamic-cast"><a href="#â‘£dynamic-cast" class="headerlink" title="â‘£dynamic_cast"></a>â‘£dynamic_cast</h4><h5 id="å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢"><a href="#å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢" class="headerlink" title="å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢"></a>å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢</h5><p>å¤šæ€åŸºç±»æŒ‡å«æœ‰è™šå‡½æ•°çš„åŸºç±»ã€‚ç”¨reinterpret_castå¯ä»¥å°†å¤šæ€åŸºç±»æŒ‡é’ˆå¼ºåˆ¶è½¬æ¢ä¸ºæ´¾ç”Ÿç±»çš„æŒ‡é’ˆï¼Œä½†è¿™ç§è½¬æ¢ä¸æ£€æŸ¥å®‰å…¨æ€§ï¼Œä¹Ÿå°±æ˜¯ä¸æ£€æŸ¥è½¬æ¢åçš„æŒ‡é’ˆæ˜¯å¦ç¡®å®æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</p>
<p>dynamic_castä¸“é—¨ç”¨æ¥<u>å°†å¤šæ€åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨</u>ï¼Œå¹¶ä¸”è¿›è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼ˆRTTIï¼ŒRun-Time Type Identificationï¼‰ã€‚å¯¹äºä¸å®‰å…¨çš„æŒ‡é’ˆè½¬æ¢è¿”å›nullptrã€‚å¦‚æœæ˜¯å¼•ç”¨ï¼Œç”±äºä¸å­˜åœ¨ç©ºå¼•ç”¨ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåä¸ºstd::bad_castã€‚</p>
<p>å³ï¼Œdynamic_castâ€œåªèƒ½ç”¨äºå®‰å…¨çš„ç±»å‹è½¬æ¢â€ï¼Œè€Œä¸æ˜¯â€œä¿è¯å˜æ¢çš„å®‰å…¨â€ï¼Œå› æ­¤ä¸èƒ½ç”¨æ¥å°†éå¤šæ€åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œå› ä¸ºè¿™ä¸ªè½¬æ¢ä¸å®‰å…¨ã€‚åªèƒ½ç”¨reinterpret_castæ¥å®Œæˆã€‚</p>
<p><u>dynamic_castä½¿ç”¨çš„å‰ææ˜¯åŸºç±»æŒ‡é’ˆæœ¬èº«å°±æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡</u>ã€‚è¿™ä¸€éƒ¨åˆ†åœ¨ä¸‹ä¸€èŠ‚å†æï¼Œå…ˆçœ‹ä¸€ä¸‹å¦‚ä½•åˆ¤æ–­è½¬æ¢æˆåŠŸå’Œå¤±è´¥ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">class Base
&#123;
public:
	virtual ~Base() &#123;&#125;;
&#125;;

class Derived :public Base &#123;&#125;;

int main()
&#123;
	Base b;
	Derived d;
	Derived* pd;
	pd &#x3D; reinterpret_cast&lt;Derived*&gt;(&amp;b);
	if (pd &#x3D;&#x3D; nullptr) std::cout &lt;&lt; &quot;unsafe reinterpret_cast from base to derived&quot; &lt;&lt; std::endl;

	pd &#x3D; dynamic_cast&lt;Derived*&gt;(&amp;b);
	if (pd &#x3D;&#x3D; nullptr) std::cout &lt;&lt; &quot;unsafe dynamic_cast from base to derived&quot; &lt;&lt; std::endl;

	pd &#x3D; dynamic_cast&lt;Derived*&gt;(&amp;d);
	if (pd &#x3D;&#x3D; nullptr) std::cout &lt;&lt; &quot;unsafe dynamic_cast from derived to derived&quot; &lt;&lt; std::endl;

	Base* pb &#x3D; dynamic_cast&lt;Base*&gt;(&amp;d);
	if (pb &#x3D;&#x3D; nullptr) std::cout &lt;&lt; &quot;unsafe dynamic_cast from derived to base&quot; &lt;&lt; std::endl;

	return 0;
&#125;</code></pre>

<p>è¾“å‡ºï¼šunsafe dynamic_cast from base to derivedã€‚åœ¨è½¬æ¢é”™è¯¯çš„ä¾‹å­ä¸­ï¼Œæ˜¯ä»ä¸€ä¸ªå¤šæ€åŸºç±»ï¼ˆå«æœ‰è™šå‡½æ•°çš„åŸºç±»ï¼‰è½¬æ¢åˆ°å­ç±»ï¼Œä½†<code>b</code>æœ¬èº«ä¸æ˜¯ä¸€ä¸ªå­ç±»<code>d</code>çš„å¯¹è±¡ï¼Œå› æ­¤ä¹Ÿä¸èƒ½è½¬æ¢ã€‚</p>
<p>é™¤äº†æ£€æŸ¥æŒ‡é’ˆåˆ°æŒ‡é’ˆçš„è½¬æ¢è¿”å›nullptrï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ•è·å¼•ç”¨è½¬æ¢çš„å¼‚å¸¸ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">try&#123;
    const Derived&amp; d &#x3D; dynamic_cast&lt;Derived&amp;&gt;(b);
&#125;catch(bad_cast)&#123;
    &#x2F;&#x2F; ...
&#125;</code></pre>



<p>å¦‚æœæŠŠæŒ‡é’ˆè½¬æ¢åˆ°void*ï¼ŒRTTIå†³å®šè¡¨è¾¾å¼çš„å®é™…ç±»å‹ã€‚ç»“æœæ˜¯æŒ‡å‘è¢«è½¬æ¢å¯¹è±¡çš„æŒ‡é’ˆã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">void* pb &#x3D; dynamic_cast&lt;void*&gt;(b);	&#x2F;&#x2F; pbæŒ‡å‘bç±»å‹çš„å¯¹è±¡
void* pd &#x3D; dynamic_cast&lt;void*&gt;(d);	&#x2F;&#x2F; pdæŒ‡å‘dç±»å‹çš„å¯¹è±¡</code></pre>



<h5 id="dynamic-castçš„ä½¿ç”¨"><a href="#dynamic-castçš„ä½¿ç”¨" class="headerlink" title="dynamic_castçš„ä½¿ç”¨"></a>dynamic_castçš„ä½¿ç”¨</h5><h6 id="åŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡"><a href="#åŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡" class="headerlink" title="åŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡"></a>åŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡</h6><p>æ¥ç€ä¸Šä¸€å°èŠ‚ï¼Œ<strong>dynamic_castä½¿ç”¨çš„å‰æä¹‹ä¸€æ˜¯åŸºç±»æŒ‡é’ˆæœ¬èº«å°±æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</strong>dynamic_castçš„ç›®çš„æ˜¯æŠŠåŸºç±»æŒ‡é’ˆè½¬æ¢ç¨‹æ´¾ç”Ÿç±»æŒ‡é’ˆï¼Œ<u>è°ƒç”¨æ´¾ç”Ÿç±»ä¸­çš„éè™šå‡½æ•°ã€ä½¿ç”¨æ´¾ç”Ÿç±»çš„æˆå‘˜å˜é‡</u>ã€‚å› ä¸ºåŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ´¾ç”Ÿç±»çš„è™šå‡½æ•°ï¼ˆé‡Œæ°æ›¿æ¢ï¼‰ï¼Œæ— éœ€è½¬æ¢ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include&lt;iostream&gt;

class Base
&#123;
public:
	Base(int _x) :x(_x) &#123;&#125;
	int getx() &#123; return x; &#125;
	virtual ~Base() &#123;&#125;
private:
	int x;
&#125;;

class DerivedA : public Base
&#123;
public:
	DerivedA(int _x, int _y) :Base(_x), y(_y) &#123;&#125;
	int gety() &#123; return y; &#125;
private:
	int y;
&#125;;

class DerivedB : public Base
&#123;
public:
	DerivedB(int _x, int _z) :Base(_x), z(_z) &#123;&#125;
	int getz() &#123; return z; &#125;
private:
	int z;
&#125;;

enum TYPE
&#123;
	BASE &#x3D; 0, 
	DERIVEDA, 
	DERIVEDB
&#125;;

&#x2F;&#x2F; æ ¹æ®è®¾å®šçš„typeï¼Œåˆ›å»ºç›¸åº”çš„å¯¹è±¡ï¼Œç»Ÿä¸€è¿”å›åŸºç±»æŒ‡é’ˆ
Base* CreateObject(int x, int y, TYPE type)
&#123;
	if (type &#x3D;&#x3D; BASE)
	&#123;
		return new Base(x);
	&#125;
	else if (type &#x3D;&#x3D; DERIVEDA)
	&#123;
		return new DerivedA(x, y);
	&#125;
	else if (type &#x3D;&#x3D; DERIVEDB)
	&#123;
		int z &#x3D; y;
		return new DerivedB(x, z);
	&#125;
	return nullptr;
&#125;

int main()
&#123;
	Base* p &#x3D; CreateObject(10, 20, DERIVEDA);	&#x2F;&#x2F; åŸºç±»æŒ‡é’ˆpï¼ŒæŒ‡å‘ä¸€ä¸ªæ´¾ç”ŸAç±»å¯¹è±¡
	std::cout &lt;&lt; &quot;è®¿é—®åŸºç±»æˆå‘˜å˜é‡xï¼š&quot; &lt;&lt; p-&gt;getx() &lt;&lt; std::endl;

	&#x2F;&#x2F; å¸Œæœ›ä½¿ç”¨æ´¾ç”ŸAç±»çš„æˆå‘˜å˜é‡bï¼Œéœ€è¦è¿›è¡Œdynamic_cast
	DerivedA* pA &#x3D; dynamic_cast&lt;DerivedA*&gt;(p);	&#x2F;&#x2F; pæœ¬æ¥å°±æŒ‡å‘æ´¾ç”ŸAç±»å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å®‰å…¨è½¬æ¢
	if (pA)
	&#123;
		std::cout &lt;&lt; &quot;è®¿é—®æ´¾ç”ŸAç±»æˆå‘˜å˜é‡yï¼š&quot; &lt;&lt; pA-&gt;gety() &lt;&lt; std::endl;
	&#125;
	else
	&#123;
		std::cout &lt;&lt; &quot;è½¬æ¢åˆ°æ´¾ç”ŸAç±»å¤±è´¥&quot; &lt;&lt; std::endl;
	&#125;

	DerivedB* pB &#x3D; dynamic_cast&lt;DerivedB*&gt;(p);	&#x2F;&#x2F; pæœ¬æ¥ä¸æ˜¯æŒ‡å‘æ´¾ç”ŸBç±»ï¼Œå› æ­¤è½¬æ¢å¤±è´¥
	if (pB)
	&#123;
		std::cout &lt;&lt; &quot;è®¿é—®æ´¾ç”ŸBç±»æˆå‘˜å˜é‡yï¼š&quot; &lt;&lt; pB-&gt;getz() &lt;&lt; std::endl;
	&#125;
	else
	&#123;
		std::cout &lt;&lt; &quot;è½¬æ¢åˆ°æ´¾ç”ŸBç±»å¤±è´¥&quot; &lt;&lt; std::endl;
	&#125;

	return 0;
&#125;</code></pre>

<p>åˆ›å»ºä¸€ä¸ªæ´¾ç”ŸAç±»çš„å¯¹è±¡ï¼Œç”¨ä¸€ä¸ªåŸºç±»æŒ‡é’ˆ<code>p</code>æŒ‡å‘å®ƒã€‚dynamic_caståªèƒ½æŠŠ<code>p</code>è½¬æ¢æˆå®ƒæŒ‡å‘çš„æ´¾ç”ŸAç±»çš„æŒ‡é’ˆï¼Œä¸èƒ½è½¬æ¢æˆå¦ä¸€ä¸ªæ´¾ç”ŸBç±»å¯¹è±¡çš„æŒ‡é’ˆã€‚</p>
<p>æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå› ä¸ºä¸èƒ½ä»æ— åˆ°æœ‰ã€å‡­ç©ºè®¿é—®å­ç±»ç‰¹æœ‰çš„æ•°æ®ã€‚</p>
<h6 id="å¤šæ€åŸºç±»"><a href="#å¤šæ€åŸºç±»" class="headerlink" title="å¤šæ€åŸºç±»"></a>å¤šæ€åŸºç±»</h6><p><strong>ä½¿ç”¨dynamic_castçš„å¦ä¸€ä¸ªå‰æï¼šåŸºç±»æ˜¯å¤šæ€åŸºç±»ï¼Œå³è‡³å°‘æœ‰ä¸€ä¸ªè™šå‡½æ•°ã€‚</strong>ä¸€èˆ¬æ¥è¯´ï¼Œæ—¥å¸¸ä½¿ç”¨çš„åŸºç±»çš„ææ„å‡½æ•°éƒ½æ˜¯è™šå‡½æ•°ï¼Œè¿™æ ·ç”¨åŸºç±»æŒ‡é’ˆè°ƒç”¨æ—¶ï¼Œå¯ä»¥ä»å­ç±»å¼€å§‹ææ„ï¼Œå¹¶ä¸€ç›´ææ„åˆ°åŸºç±»ã€‚ä¹Ÿå°±æ˜¯è¿™ä¸ªå‰æä¸€èˆ¬æ˜¯æ»¡è¶³çš„ã€‚</p>
<h6 id="ä½¿ç”¨æ€»ç»“"><a href="#ä½¿ç”¨æ€»ç»“" class="headerlink" title="ä½¿ç”¨æ€»ç»“"></a>ä½¿ç”¨æ€»ç»“</h6><p>è¿è¡Œæ—¶å¤šæ€ä¹Ÿå¯ä»¥é€šè¿‡åœ¨åŸºç±»é‡Œæ·»åŠ è™šå‡½æ•°æ¥å®ç°ï¼Œä½†åœ¨ä¸€äº›åº”ç”¨åœºæ™¯é‡Œï¼Œä¸€äº›æ–¹æ³•æ˜¯æ´¾ç”Ÿç±»ç‰¹æœ‰çš„ï¼Œå¯¹åŸºç±»æ— æ„ä¹‰ï¼Œå¦‚æœæ·»åŠ ä¸ºåŸºç±»çš„è™šå‡½æ•°å°±è¿›è¡Œäº†æ±¡æŸ“ï¼Œä¸ç¬¦åˆè®¾è®¡æ€æƒ³ã€‚</p>
<p>è€Œåœ¨åˆé€‚çš„æ—¶å€™ï¼Œé€šå¸¸åº”è¯¥ä¼˜å…ˆä½¿ç”¨è™šå‡½æ•°ã€‚ä¹Ÿæœ‰å‡ ä¸ªæƒ…å†µä¸‹dynamic_castæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š</p>
<ul>
<li>ä¸èƒ½æ”¹å˜åŸºç±»æ¥æ·»åŠ è™šå‡½æ•°æ—¶ï¼ˆæ¯”å¦‚åŸºç±»æ˜¯æ ‡å‡†åº“ä¸­çš„ç±»ï¼‰</li>
<li><strong>æƒ³è®¿é—®æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æˆå‘˜å‡½æ•°æ—¶ï¼ˆç›®çš„æ˜¯ä½¿ç”¨éè™šå‡½æ•°ï¼‰</strong> </li>
<li>æ·»åŠ è™šå‡½æ•°åˆ°åŸºç±»ä¸­æ²¡æœ‰æ„ä¹‰æ—¶ï¼ˆä¸åˆé€‚çš„æ—¶å€™ï¼Œæ¯”å¦‚åŸºç±»é‡Œæ²¡æœ‰åˆé€‚çš„è¿”å›å€¼ï¼‰</li>
</ul>
<h5 id="å›åˆ°å¼€å¤´çš„UE4-Cast"><a href="#å›åˆ°å¼€å¤´çš„UE4-Cast" class="headerlink" title="å›åˆ°å¼€å¤´çš„UE4 Cast"></a>å›åˆ°å¼€å¤´çš„UE4 Cast</h5><p>è®²å®Œäº†å››ç§ç±»å‹è½¬æ¢ï¼Œå›è¿‡å¤´æ¥ï¼Œçœ‹ä¸€ä¸‹æ–‡ç« ä¸€å¼€å§‹æåˆ°çš„UE4ä¸­çš„ä¸€ä¸ªè½¬æ¢åœºæ™¯ï¼š</p>
<p>é¦–å…ˆï¼ŒGEngineæ˜¯ä¸€ä¸ªUEngineç±»å‹çš„æŒ‡é’ˆï¼ŒUEngineç±»æ˜¯æ‰€æœ‰å¼•æ“ç±»çš„æŠ½è±¡åŸºç±»ï¼Œç”¨äºç®¡ç†ä¸€äº›å¯¹ç¼–è¾‘å™¨æˆ–æ¸¸æˆå¿…è¦çš„ç³»ç»Ÿï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">&#x2F;**
* Global engine pointer. Can be 0 so don&#39;t use without checking.
*&#x2F;
ENGINE_API UEngine*	GEngine &#x3D; NULL;</code></pre>



<p>ç„¶åï¼Œå®ƒæœ‰ä¸€ä¸ªæ´¾ç”Ÿç±»UGameEngineï¼Œç”¨æ¥ç®¡ç†æ”¯æŒæ¸¸æˆçš„æ ¸å¿ƒç³»ç»Ÿï¼ŒåŒ…å«ä¸€äº›æŒ‡é’ˆæ¯”å¦‚GameViewportWindowç­‰ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">&#x2F;**
 * Engine that manages core systems that enable a game.
 *&#x2F;
UCLASS(config&#x3D;Engine, transient)
class ENGINE_API UGameEngine
	: public UEngine
&#123;
    &#x2F;&#x2F; ...
public:      
	&#x2F;** The game viewport window *&#x2F;
	TWeakPtr&lt;class SWindow&gt; GameViewportWindow;
	&#x2F;** The primary scene viewport *&#x2F;
	TSharedPtr&lt;class FSceneViewport&gt; SceneViewport;
	&#x2F;** The game viewport widget *&#x2F;
	TSharedPtr&lt;class SViewport&gt; GameViewportWidget;
&#125;;</code></pre>



<p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯æ–°å»ºä¸€ä¸ªå­ç±»æŒ‡é’ˆã€æŠŠçˆ¶ç±»æŒ‡é’ˆGEngineè½¬æˆå­ç±»UGameEngineç±»å‹çš„æŒ‡é’ˆï¼Œç„¶åå»è®¿é—®å­ç±»å•ç‹¬å®šä¹‰çš„æˆå‘˜å˜é‡ã€‚è¿™å°±æ˜¯ä½¿ç”¨dynamic_castçš„ç›®çš„ã€‚</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">UGameEngine* GameEngine &#x3D; Cast&lt;UGameEngine&gt;(GEngine);
OutSceneViewport &#x3D; GameEngine-&gt;SceneViewport;
OutInputWindow &#x3D; GameEngine-&gt;GameViewportWindow;</code></pre>



<p>è¿™ä¸ªè½¬æ¢æ»¡è¶³äº†dynamic_castçš„ä¸¤ä¸ªå‰æï¼Œå«æœ‰è™šå‡½æ•°ä¸å¿…å¤šè¯´ã€‚å¦ä¸€ä¸ªå‰æï¼šåŸºç±»æŒ‡é’ˆæœ¬æ¥å°±æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚æˆ‘ä»¬æŸ¥çœ‹GEngineçš„åˆ›å»ºè¿‡ç¨‹ï¼š</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">int32 FEngineLoop::Init()
&#123;
	&#x2F;&#x2F; Figure out which UEngine variant to use.
	UClass* EngineClass &#x3D; nullptr;
	if( !GIsEditor )
	&#123;
		SCOPED_BOOT_TIMING(&quot;Create GEngine&quot;);
		&#x2F;&#x2F; We&#39;re the game.
		FString GameEngineClassName;
		GConfig-&gt;GetString(TEXT(&quot;&#x2F;Script&#x2F;Engine.Engine&quot;), TEXT(&quot;GameEngine&quot;), GameEngineClassName, GEngineIni);
		EngineClass &#x3D; StaticLoadClass( UGameEngine::StaticClass(), nullptr, *GameEngineClassName);
		if (EngineClass &#x3D;&#x3D; nullptr)
		&#123;
			UE_LOG(LogInit, Fatal, TEXT(&quot;Failed to load UnrealEd Engine class &#39;%s&#39;.&quot;), *GameEngineClassName);
		&#125;
		GEngine &#x3D; NewObject&lt;UEngine&gt;(GetTransientPackage(), EngineClass);
	&#125;
&#125;</code></pre>

<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>GEngine</code>åœ¨åˆ›å»ºæ—¶ï¼Œä¼ å…¥äº†ä¸€ä¸ª<code>EngineClass</code>ï¼›<code>EngineClass</code>ä½¿ç”¨<code>UGameEngine::StaticClass()</code>åˆ›å»ºã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæœ€ç»ˆåˆ›å»ºçš„åŸºç±»GEngineæŒ‡é’ˆæŒ‡å‘äº†æ´¾ç”Ÿç±»UGameEngineçš„å¯¹è±¡ã€‚</p>
<p>ä¹Ÿå°±æ˜¯ï¼Œå¯ä»¥ç”¨dynamic_castè¿›è¡Œå®‰å…¨çš„ä¸‹è¡Œè½¬æ¢ï¼Œä½¿ç”¨æ´¾ç”Ÿç±»çš„æˆå‘˜å˜é‡ã€‚</p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬ä»UE4çš„ä¸€å¤„Castï¼Œè®²è§£äº†C++çš„å››ç§ç±»å‹è½¬æ¢ï¼Œå¹¶åœ¨æœ€åå‘ç°ï¼ŒUE4çš„è¿™ä¸€å¤„ç±»å‹è½¬æ¢å®é™…ä¸Šæ˜¯å®‰å…¨çš„ä¸‹è¡Œè½¬æ¢ã€‚</p>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/kenjianqi1647/article/details/121511906">(CSDN) C++11ç±»å‹è½¬æ¢æ€»ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8239262/why-is-the-address-of-this-volatile-variable-always-at-1">(StackOverflow) Why is the address of this volatile variable always at 1?</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/diesa5743/article/details/101275260">(CSDN) const_castå»é™¤consté™åˆ¶ï¼ŒåŒä¸€ç‰‡å†…å­˜</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/344264694">(çŸ¥ä¹) constä¸volatile</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.erratasec.com/2016/11/how-to-teach-endian.html#.YuIvX3ZBxPZ">How to teach endian</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33040213">(çŸ¥ä¹) C++ç±»å‹è½¬æ¢ä¹‹reinterpret_cast</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/302752247">(çŸ¥ä¹) å¦‚ä½•ç†è§£C++ä¸­çš„ reinterpret_castï¼Ÿ</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/410.html">C++å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/29452981/answer/44418335">(çŸ¥ä¹) å¤§ç«¯å°ç«¯ä¸æŒ‡é’ˆçš„å…³ç³»ï¼Ÿ</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiao_Ray/article/details/104977065">(CSDN) å¤§ç«¯å’Œå°ç«¯</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/feifei_csdn/article/details/101520218">(CSDN)C++æ ‡å‡†è½¬æ¢è¿ç®—ç¬¦static_cast</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37834993/article/details/106310012">(CSDN)dynamic_castç”¨æ³•æ€»ç»“</a></li>
</ul>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>miu</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://acbgzm.github.io/2022/09/07/ue-1/" title="ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ1ï¼‰ä»UE4çš„ä¸€å¤„ä¸‹è¡ŒCastï¼Œåˆ°åˆæ­¥ç†è§£C++ç±»å‹è½¬æ¢">http://acbgzm.github.io/2022/09/07/ue-1/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/09/07/ue-2/" rel="prev" title="ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ2ï¼‰æºç é˜…è¯»æ”¯çº¿ä¹‹å¦‚ä½•ç†è§£C++çš„constå…³é”®å­—ï¼Ÿ"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ2ï¼‰æºç é˜…è¯»æ”¯çº¿ä¹‹å¦‚ä½•ç†è§£C++çš„constå…³é”®å­—ï¼Ÿ</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/09/07/ue-0/" rel="next" title="ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ0ï¼‰ç³»åˆ—å¼€ç¯‡ &amp; å…¨ç›®å½•"><span class="post-nav-text">ã€æˆ‘çœ‹UEæºç ã€‘ï¼ˆ0ï¼‰ç³»åˆ—å¼€ç¯‡ &amp; å…¨ç›®å½•</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><style>.utterances {
  max-width: 100%;
}</style><script src="https://utteranc.es/client.js" repo="ACBGZM/ACBGZM.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> miu</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v6.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.9</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div class="search-result-container"></div></div></body></html>