<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="miu"><meta name="copyright" content="miu"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>dl &amp; ai - andrew ng | ä¸´æ—¶ä¸ªäººä¸»é¡µ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...true?.options,
  });
});</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"acbgzm.github.io","root":"/","title":"slowmotion","version":"1.10.9","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="æ•´ç†ä¸€ä¸‹æ·±åº¦å­¦ä¹ åŸºç¡€çš„ç¬”è®°ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="dl &amp; ai - andrew ng">
<meta property="og:url" content="http://acbgzm.github.io/2021/05/27/dlang/index.html">
<meta property="og:site_name" content="ä¸´æ—¶ä¸ªäººä¸»é¡µ">
<meta property="og:description" content="æ•´ç†ä¸€ä¸‹æ·±åº¦å­¦ä¹ åŸºç¡€çš„ç¬”è®°ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/6.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/10.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/11.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/12.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/13.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/14.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/15.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/16.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/17.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/18.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/19.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/20.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/21.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/22.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/23.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/24.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/25.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/26.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/27.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/28.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/29.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/30.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/31.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/30.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/32.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/33.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/34.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/35.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/36.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/37.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/38.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/39.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/40.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/41.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/42.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/43.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/44.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/45.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/46.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/47.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/48.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/49.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/50.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/51.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/52.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/53.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/54.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/55.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/56.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/57.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/58.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/59.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/60.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/61.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/62.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/63.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/64.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/65.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/65-add.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/66.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/67.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/68.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/69.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/70.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/71.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/72.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/73.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/74.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/75.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/76.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/77.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/78.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/79.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/80.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/81.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/82.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/83.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/84.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/85.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/86.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/87.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/88.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/89.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/90.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/91.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/92.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/93.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/94.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/95.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/96.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/97.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/98.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/99.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/100.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/101.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/102.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/103.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/104.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/105.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/106.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/107.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/108.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/109.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/110.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/111.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/112.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/113.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/114.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/115.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/116.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/117.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/118.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/119.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/120.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/121.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/122.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/123.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/124.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/125.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/126.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/127.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/128.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/129.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/130.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/131.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/132.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/133.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/134.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/135.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/136.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/137.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/138.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/139.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/140.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/141.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/142.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/143.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/144.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/145.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/146.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/147.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/148.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/149.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/150.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/151.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/152.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/153.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/154.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/155.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/156.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/157.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/158.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/159.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/160.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/161.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/162.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/163.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/164.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/165.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/166.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/167.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/168.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/169.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/170.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/171.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/172.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/173.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/174.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/175.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/176.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/177.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/178.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/179.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/180.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/181.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/182.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/183.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/184.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/185.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/186.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/187.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/188.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/189.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/190.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/191.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/192.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/193.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/194.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/195.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/196.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/197.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf6.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf10.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf11.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf12.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf13.png">
<meta property="article:published_time" content="2021-05-27T06:49:55.000Z">
<meta property="article:modified_time" content="2022-03-05T07:01:23.268Z">
<meta property="article:author" content="miu">
<meta property="article:tag" content="æœºå™¨å­¦ä¹ ">
<meta property="article:tag" content="è¯¾ç¨‹ç¬”è®°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="miu"><img width="96" loading="lazy" src="/images/avatar.png" alt="miu"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ¸</span></a><div class="site-author-name"><a href="/about/">miu</a></div><span class="site-name">ä¸´æ—¶ä¸ªäººä¸»é¡µ</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">19</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">6</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" href="/lab" title="lab"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/ACBGZM" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/10388034" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:ACBGZM@126.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="å‹é“¾" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:open-arm-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A3B1B%E7%9A%84%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91"><span class="toc-text">ç¬¬ä¸€éƒ¨åˆ†ï¼š3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A%E8%83%A1%E6%B5%A9%E5%9F%BA%E8%80%81%E5%B8%88NN%E3%80%81CNN%E9%83%A8%E5%88%86"><span class="toc-text">ç¬¬äºŒéƒ¨åˆ†ï¼šèƒ¡æµ©åŸºè€å¸ˆNNã€CNNéƒ¨åˆ†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9A%E5%90%B4%E6%81%A9%E8%BE%BEdeeplearning-ai%E7%BD%91%E8%AF%BE"><span class="toc-text">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå´æ©è¾¾deeplearning.aiç½‘è¯¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E8%AF%BE-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%88Neural-Networks-and-Deep-Learning%EF%BC%89"><span class="toc-text">ç¬¬ä¸€è¯¾ ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼ˆNeural Networks and Deep Learningï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%91%A8%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%BC%95%E8%A8%80%EF%BC%88Introduction-to-Deep-Learning%EF%BC%89"><span class="toc-text">ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ å¼•è¨€ï¼ˆIntroduction to Deep Learningï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%AC%A2%E8%BF%8E"><span class="toc-text">1.1 æ¬¢è¿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E4%BB%80%E4%B9%88%E6%98%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%9F"><span class="toc-text">1.2 ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0-Supervised-Learning-with-Neural-Networks"><span class="toc-text">1.3 ç¥ç»ç½‘ç»œçš„ç›‘ç£å­¦ä¹ (Supervised Learning with Neural Networks)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%9A%E6%B5%81%E8%A1%8C%EF%BC%9F"><span class="toc-text">1.4 ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¼šæµè¡Œï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-1-6-%E8%AF%BE%E7%A8%8B%E5%AE%89%E6%8E%92"><span class="toc-text">1.5~1.6 è¯¾ç¨‹å®‰æ’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%91%A8%EF%BC%9A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%EF%BC%88Basics-of-Neural-Network-Programming%EF%BC%89"><span class="toc-text">ç¬¬äºŒå‘¨ï¼šç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network Programmingï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E4%BA%8C%E5%88%86%E7%B1%BB-Binary-Classification"><span class="toc-text">2.1 äºŒåˆ†ç±»(Binary Classification)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92-Logistic-Regression"><span class="toc-text">2.2 é€»è¾‘å›å½’(Logistic Regression)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E7%9A%84%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0"><span class="toc-text">2.3 é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%EF%BC%88Gradient-Descent%EF%BC%89"><span class="toc-text">2.4 æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-6-%E5%AF%BC%E6%95%B0"><span class="toc-text">2.5~2.6 å¯¼æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-%E8%AE%A1%E7%AE%97%E5%9B%BE%EF%BC%88Computation-Graph%EF%BC%89"><span class="toc-text">2.7 è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-%E8%AE%A1%E7%AE%97%E5%9B%BE%E5%AF%BC%E6%95%B0"><span class="toc-text">2.8 è®¡ç®—å›¾å¯¼æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E7%9A%84%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-text">2.9 é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-10-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-text">2.10 æ¢¯åº¦ä¸‹é™çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-11-%E5%90%91%E9%87%8F%E5%8C%96-Vectorization"><span class="toc-text">2.11 å‘é‡åŒ–(Vectorization)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-12-%E6%9B%B4%E5%A4%9A%E7%9A%84%E5%90%91%E9%87%8F%E5%8C%96%E4%BE%8B%E5%AD%90"><span class="toc-text">2.12 æ›´å¤šçš„å‘é‡åŒ–ä¾‹å­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-13-%E5%90%91%E9%87%8F%E5%8C%96%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="toc-text">2.13 å‘é‡åŒ–é€»è¾‘å›å½’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-14-%E5%90%91%E9%87%8F%E5%8C%96%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E7%9A%84%E6%A2%AF%E5%BA%A6%E8%AE%A1%E7%AE%97"><span class="toc-text">2.14 å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è®¡ç®—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-15-Python%E4%B8%AD%E7%9A%84%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6%EF%BC%88Broadcasting-in-Python%EF%BC%89"><span class="toc-text">2.15 Pythonä¸­çš„å¹¿æ’­æœºåˆ¶ï¼ˆBroadcasting in Pythonï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-16-%E5%85%B3%E4%BA%8E-Python%E4%B8%8Enumpy%E5%90%91%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">2.16 å…³äº Pythonä¸numpyå‘é‡çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-17-Jupyter-x2F-iPython-Notebooks%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">2.17 Jupyter&#x2F;iPython Notebookså¿«é€Ÿå…¥é—¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-18-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-text">2.18* é€»è¾‘å›å½’æŸå¤±å‡½æ•°è¯¦è§£</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9A%E6%B5%85%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%88Shallow-Neural-Networks%EF%BC%89"><span class="toc-text">ç¬¬ä¸‰å‘¨ï¼šæµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow Neural Networksï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0"><span class="toc-text">3.1 ç¥ç»ç½‘ç»œæ¦‚è¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="toc-text">3.2 ç¥ç»ç½‘ç»œçš„è¡¨ç¤º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E8%AE%A1%E7%AE%97%E4%B8%80%E4%B8%AA%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E8%BE%93%E5%87%BA"><span class="toc-text">3.3 è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E5%A4%9A%E6%A0%B7%E6%9C%AC%E5%90%91%E9%87%8F%E5%8C%96"><span class="toc-text">3.4 å¤šæ ·æœ¬å‘é‡åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-%E5%90%91%E9%87%8F%E5%8C%96%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%A7%A3%E9%87%8A"><span class="toc-text">3.5 å‘é‡åŒ–å®ç°çš„è§£é‡Š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0%EF%BC%88Activation-functions%EF%BC%89"><span class="toc-text">3.6 æ¿€æ´»å‡½æ•°ï¼ˆActivation functionsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0%EF%BC%9F"><span class="toc-text">3.7 ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%BC%E6%95%B0"><span class="toc-text">3.8 æ¿€æ´»å‡½æ•°çš„å¯¼æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-text">3.9 ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-10%EF%BC%88%E9%80%89%E4%BF%AE%EF%BC%89%E7%9B%B4%E8%A7%82%E7%90%86%E8%A7%A3%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%88Backpropagation-intuition%EF%BC%89"><span class="toc-text">3.10ï¼ˆé€‰ä¿®ï¼‰ç›´è§‚ç†è§£åå‘ä¼ æ’­ï¼ˆBackpropagation intuitionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-11-%E9%9A%8F%E6%9C%BA%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%88Random-Initialization%EF%BC%89"><span class="toc-text">3.11 éšæœºåˆå§‹åŒ–ï¼ˆRandom Initializationï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%91%A8%EF%BC%9A%E6%B7%B1%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">ç¬¬å››å‘¨ï¼šæ·±å±‚ç¥ç»ç½‘ç»œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E6%B7%B1%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">4.1 æ·±å±‚ç¥ç»ç½‘ç»œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="toc-text">4.2 å‰å‘ä¼ æ’­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E6%A3%80%E6%9F%A5%E7%9F%A9%E9%98%B5%E7%9A%84%E7%BB%B4%E6%95%B0"><span class="toc-text">4.3 æ£€æŸ¥çŸ©é˜µçš„ç»´æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E6%B7%B1%E5%B1%82%E8%A1%A8%E7%A4%BA%EF%BC%9F"><span class="toc-text">4.4 ä¸ºä»€ä¹ˆä½¿ç”¨æ·±å±‚è¡¨ç¤ºï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-%E6%90%AD%E5%BB%BA%E6%B7%B1%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9D%97"><span class="toc-text">4.5 æ­å»ºæ·±å±‚ç¥ç»ç½‘ç»œå—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-%E5%89%8D%E5%90%91%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="toc-text">4.6 å‰å‘å’Œåå‘ä¼ æ’­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-%E5%8F%82%E6%95%B0VS%E8%B6%85%E5%8F%82%E6%95%B0%EF%BC%88Parameters-vs-Hyperparameters%EF%BC%89"><span class="toc-text">4.7 å‚æ•°VSè¶…å‚æ•°ï¼ˆParameters vs Hyperparametersï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%92%8C%E4%BA%BA%E7%B1%BB%E5%A4%A7%E8%84%91%E7%9A%84%E5%85%B3%E8%81%94%E6%80%A7"><span class="toc-text">4.8 æ·±åº¦å­¦ä¹ å’Œäººç±»å¤§è„‘çš„å…³è”æ€§</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%AF%BE-%E6%94%B9%E5%96%84%E6%B7%B1%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%B6%85%E5%8F%82%E6%95%B0%E8%B0%83%E8%AF%95%E3%80%81%E6%AD%A3%E5%88%99%E5%8C%96%E4%BB%A5%E5%8F%8A%E4%BC%98%E5%8C%96-Improving-Deep-Neural-Networks-Hyperparameter-tuning-Regularization-and-Optimization"><span class="toc-text">ç¬¬äºŒè¯¾ æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œï¼šè¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–(Improving Deep Neural Networks : Hyperparameter tuning, Regularization and Optimization)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%91%A8%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%AE%9E%E7%94%A8%E5%B1%82%E9%9D%A2"><span class="toc-text">ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E8%AE%AD%E7%BB%83-x2F-%E9%AA%8C%E8%AF%81-x2F-%E6%B5%8B%E8%AF%95%E9%9B%86%EF%BC%88Train-x2F-Dev-x2F-Test-sets%EF%BC%89"><span class="toc-text">1.1 è®­ç»ƒ&#x2F;éªŒè¯&#x2F;æµ‹è¯•é›†ï¼ˆTrain &#x2F; Dev &#x2F; Test setsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%81%8F%E5%B7%AE-x2F-%E6%96%B9%E5%B7%AE%EF%BC%88Bias-x2F-Variance%EF%BC%89"><span class="toc-text">1.2 åå·®&#x2F;æ–¹å·®ï¼ˆBias &#x2F;Varianceï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E5%85%88%E5%90%8E%E9%A1%BA%E5%BA%8F"><span class="toc-text">1.3 å…ˆåé¡ºåº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-%E6%AD%A3%E5%88%99%E5%8C%96%EF%BC%88Regularization%EF%BC%89"><span class="toc-text">1.4 æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AD%A3%E5%88%99%E5%8C%96%E6%9C%89%E5%88%A9%E4%BA%8E%E9%A2%84%E9%98%B2%E8%BF%87%E6%8B%9F%E5%90%88%E5%91%A2%EF%BC%9F"><span class="toc-text">1.5 ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æœ‰åˆ©äºé¢„é˜²è¿‡æ‹Ÿåˆå‘¢ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-dropout-%E6%AD%A3%E5%88%99%E5%8C%96"><span class="toc-text">1.6 dropout æ­£åˆ™åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-%E7%90%86%E8%A7%A3-dropout"><span class="toc-text">1.7 ç†è§£ dropout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-%E5%85%B6%E4%BB%96%E6%AD%A3%E5%88%99%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-text">1.8 å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-%E5%BD%92%E4%B8%80%E5%8C%96%E8%BE%93%E5%85%A5%EF%BC%88Normalizing-inputs%EF%BC%89"><span class="toc-text">1.9 å½’ä¸€åŒ–è¾“å…¥ï¼ˆNormalizing inputsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-%E6%A2%AF%E5%BA%A6%E6%B6%88%E5%A4%B1-x2F-%E6%A2%AF%E5%BA%A6%E7%88%86%E7%82%B8%EF%BC%88Vanishing-x2F-Exploding-gradients%EF%BC%89"><span class="toc-text">1.10 æ¢¯åº¦æ¶ˆå¤±&#x2F;æ¢¯åº¦çˆ†ç‚¸ï¼ˆVanishing &#x2F; Exploding gradientsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E6%9D%83%E9%87%8D%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">1.11 ç¥ç»ç½‘ç»œçš„æƒé‡åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-12-%E6%A2%AF%E5%BA%A6%E7%9A%84%E6%95%B0%E5%80%BC%E8%BF%91%E4%BC%BC"><span class="toc-text">1.12 æ¢¯åº¦çš„æ•°å€¼è¿‘ä¼¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-13-%E6%A2%AF%E5%BA%A6%E6%A3%80%E9%AA%8C%EF%BC%88Gradient-checking%EF%BC%89"><span class="toc-text">1.13 æ¢¯åº¦æ£€éªŒï¼ˆGradient checkingï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-14-%E5%BA%94%E7%94%A8%E6%A2%AF%E5%BA%A6%E6%A3%80%E9%AA%8C%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">1.14 åº”ç”¨æ¢¯åº¦æ£€éªŒçš„æ³¨æ„äº‹é¡¹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%91%A8%EF%BC%9A%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95-Optimization-algorithms"><span class="toc-text">ç¬¬äºŒå‘¨ï¼šä¼˜åŒ–ç®—æ³• (Optimization algorithms)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-Mini-batch-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-text">2.1 Mini-batch æ¢¯åº¦ä¸‹é™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%90%86%E8%A7%A3Mini-batch-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-text">2.2 ç†è§£Mini-batch æ¢¯åº¦ä¸‹é™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E6%8C%87%E6%95%B0%E5%8A%A0%E6%9D%83%E5%B9%B3%E5%9D%87%EF%BC%88Exponentially-weighted-averages%EF%BC%89"><span class="toc-text">2.3 æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially weighted averagesï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E7%90%86%E8%A7%A3%E6%8C%87%E6%95%B0%E5%8A%A0%E6%9D%83%E5%B9%B3%E5%9D%87"><span class="toc-text">2.4 ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E6%8C%87%E6%95%B0%E5%8A%A0%E6%9D%83%E5%B9%B3%E5%9D%87%E7%9A%84%E5%81%8F%E5%B7%AE%E4%BF%AE%E6%AD%A3%EF%BC%88Bias-correction-in-exponentially-weighted-average%EF%BC%89"><span class="toc-text">2.5 æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ï¼ˆBias correction in exponentially weighted averageï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-momentum%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-text">2.6 momentumæ¢¯åº¦ä¸‹é™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-RMSprop-root-mean-square-prop"><span class="toc-text">2.7 RMSprop-root mean square prop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-Adam%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95"><span class="toc-text">2.8 Adamä¼˜åŒ–ç®—æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9-%E5%AD%A6%E4%B9%A0%E7%8E%87%E8%A1%B0%E5%87%8F%EF%BC%88Learning-rate-decay%EF%BC%89"><span class="toc-text">2.9 å­¦ä¹ ç‡è¡°å‡ï¼ˆLearning rate decayï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-10-%E5%B1%80%E9%83%A8%E6%9C%80%E4%BC%98%E9%97%AE%E9%A2%98"><span class="toc-text">2.10 å±€éƒ¨æœ€ä¼˜é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9A%E8%B6%85%E5%8F%82%E6%95%B0%E8%B0%83%E8%AF%95%EF%BC%8C%E6%89%B9%E6%AD%A3%E5%88%99%E5%8C%96%E5%92%8C%E7%A8%8B%E5%BA%8F%E6%A1%86%E6%9E%B6"><span class="toc-text">ç¬¬ä¸‰å‘¨ï¼šè¶…å‚æ•°è°ƒè¯•ï¼Œæ‰¹æ­£åˆ™åŒ–å’Œç¨‹åºæ¡†æ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E8%B0%83%E5%8F%82%E8%A7%84%E5%88%99"><span class="toc-text">3.1 è°ƒå‚è§„åˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%90%88%E9%80%82%E7%9A%84%E5%8F%82%E6%95%B0%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4"><span class="toc-text">3.2 åˆé€‚çš„å‚æ•°å–å€¼èŒƒå›´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E8%B6%85%E5%8F%82%E6%95%B0%E8%AE%AD%E7%BB%83%E7%9A%84%E5%AE%9E%E8%B7%B5%EF%BC%9APandas-vs-Caviar"><span class="toc-text">3.3 è¶…å‚æ•°è®­ç»ƒçš„å®è·µï¼šPandas vs. Caviar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0%E7%9A%84%E5%BD%92%E4%B8%80%E5%8C%96-x2F-%E5%8D%95%E4%B8%80%E9%9A%90%E8%97%8F%E5%B1%82%E4%B8%8A%E7%9A%84%E6%89%B9%E5%BD%92%E4%B8%80%E5%8C%96%EF%BC%88Batch-normalization%EF%BC%89"><span class="toc-text">3.4 æ¿€æ´»å‡½æ•°çš„å½’ä¸€åŒ–&#x2F;å•ä¸€éšè—å±‚ä¸Šçš„æ‰¹å½’ä¸€åŒ–ï¼ˆBatch normalizationï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-%E6%B7%B1%E5%BA%A6%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E6%89%B9%E5%BD%92%E4%B8%80%E5%8C%96"><span class="toc-text">3.5 æ·±åº¦ç¥ç»ç½‘ç»œçš„æ‰¹å½’ä¸€åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-%E4%B8%BA%E4%BB%80%E4%B9%88Batch-Norm%E6%9C%89%E7%94%A8%EF%BC%9F"><span class="toc-text">3.6 ä¸ºä»€ä¹ˆBatch Normæœ‰ç”¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-%E6%B5%8B%E8%AF%95%E6%97%B6%E7%9A%84Batch-Norm"><span class="toc-text">3.7 æµ‹è¯•æ—¶çš„Batch Norm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-Softmax-%E5%9B%9E%E5%BD%92"><span class="toc-text">3.8 Softmax å›å½’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-%E8%AE%AD%E7%BB%83%E4%B8%80%E4%B8%AA-Softmax-%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-text">3.9 è®­ç»ƒä¸€ä¸ª Softmax åˆ†ç±»å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-10-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A1%86%E6%9E%B6"><span class="toc-text">3.10 æ·±åº¦å­¦ä¹ æ¡†æ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-11-TensorFlow"><span class="toc-text">3.11 TensorFlow</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%AF%BE-%E7%BB%93%E6%9E%84%E5%8C%96%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E9%A1%B9%E7%9B%AE-Structuring-Machine-Learning-Projects"><span class="toc-text">ç¬¬ä¸‰è¯¾ ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›® (Structuring Machine Learning Projects)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E8%AF%BE-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%88Convolutional-Neural-Networks%EF%BC%89"><span class="toc-text">ç¬¬å››è¯¾ å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networksï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%91%A8-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-Foundations-of-Convolutional-Neural-Networks"><span class="toc-text">ç¬¬ä¸€å‘¨ å·ç§¯ç¥ç»ç½‘ç»œ(Foundations of Convolutional Neural Networks)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%EF%BC%88Computer-vision%EF%BC%89"><span class="toc-text">1.1 è®¡ç®—æœºè§†è§‰ï¼ˆComputer visionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97-%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B%E4%B8%BA%E4%BE%8B%EF%BC%88Edge-detection%EF%BC%89"><span class="toc-text">1.2 å·ç§¯è¿ç®—-è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼ˆEdge detectionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%9B%B4%E5%A4%9A%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B%E5%86%85%E5%AE%B9"><span class="toc-text">1.3 æ›´å¤šè¾¹ç¼˜æ£€æµ‹å†…å®¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-Padding"><span class="toc-text">1.4 Padding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-%E5%8D%B7%E7%A7%AF%E6%AD%A5%E9%95%BF%EF%BC%88Strided-convolutions%EF%BC%89"><span class="toc-text">1.5 å·ç§¯æ­¥é•¿ï¼ˆStrided convolutionsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-%E4%B8%89%E7%BB%B4%E5%8D%B7%E7%A7%AF%EF%BC%88Convolutions-over-volumes%EF%BC%89"><span class="toc-text">1.6 ä¸‰ç»´å·ç§¯ï¼ˆConvolutions over volumesï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-%E5%8D%95%E5%B1%82%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C"><span class="toc-text">1.7 å•å±‚å·ç§¯ç½‘ç»œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%A4%BA%E4%BE%8B"><span class="toc-text">1.8 ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-%E6%B1%A0%E5%8C%96%E5%B1%82%EF%BC%88Pooling-layers%EF%BC%89"><span class="toc-text">1.9 æ± åŒ–å±‚ï¼ˆPooling layersï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%A4%BA%E4%BE%8B%EF%BC%88Convolutional-neural-network-example%EF%BC%89"><span class="toc-text">1.10 å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆConvolutional neural network exampleï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E5%8D%B7%E7%A7%AF%EF%BC%9F%EF%BC%88Why-convolutions-%EF%BC%89"><span class="toc-text">1.11 ä¸ºä»€ä¹ˆä½¿ç”¨å·ç§¯ï¼Ÿï¼ˆWhy convolutions?ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%91%A8-%E6%B7%B1%E5%BA%A6%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C%EF%BC%9A%E5%AE%9E%E4%BE%8B%E6%8E%A2%E7%A9%B6-Deep-convolutional-models-case-studies"><span class="toc-text">ç¬¬äºŒå‘¨ æ·±åº¦å·ç§¯ç½‘ç»œï¼šå®ä¾‹æ¢ç©¶(Deep convolutional models: case studies)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%AE%9E%E4%BE%8B%E6%8E%A2%E7%A9%B6%EF%BC%9F"><span class="toc-text">2.1 ä¸ºä»€ä¹ˆè¦è¿›è¡Œå®ä¾‹æ¢ç©¶ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E7%BB%8F%E5%85%B8%E7%BD%91%E7%BB%9C"><span class="toc-text">2.2 ç»å…¸ç½‘ç»œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E6%AE%8B%E5%B7%AE%E7%BD%91%E7%BB%9C%EF%BC%88Residual-Networks-ResNets-%EF%BC%89"><span class="toc-text">2.3 æ®‹å·®ç½‘ç»œï¼ˆResidual Networks (ResNets)ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%AE%8B%E5%B7%AE%E7%BD%91%E7%BB%9C%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E7%94%A8%EF%BC%9F"><span class="toc-text">2.4 æ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C-x2F-1%C3%971%E5%8D%B7%E7%A7%AF"><span class="toc-text">2.5 ç½‘ç»œä¸­çš„ç½‘ç»œ &#x2F; 1Ã—1å·ç§¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-Inception-%E6%A8%A1%E5%9D%97%E7%AE%80%E4%BB%8B%E3%80%81"><span class="toc-text">2.6 Inception æ¨¡å—ç®€ä»‹ã€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-Inception-%E7%BD%91%E7%BB%9C-x2F-GoogLeNet%EF%BC%88Inception-network%EF%BC%89"><span class="toc-text">2.7 Inception ç½‘ç»œ &#x2F; GoogLeNetï¼ˆInception networkï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-%E4%BD%BF%E7%94%A8%E5%BC%80%E6%BA%90%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="toc-text">2.8 ä½¿ç”¨å¼€æºçš„å®ç°æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9-%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%EF%BC%88Transfer-Learning%EF%BC%89"><span class="toc-text">2.9 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-10-%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA%EF%BC%88Data-augmentation%EF%BC%89"><span class="toc-text">2.10 æ•°æ®å¢å¼ºï¼ˆData augmentationï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-11-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E7%8E%B0%E7%8A%B6"><span class="toc-text">2.11 è®¡ç®—æœºè§†è§‰ç°çŠ¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%91%A8-%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%88Object-detection%EF%BC%89"><span class="toc-text">ç¬¬ä¸‰å‘¨ ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%9B%AE%E6%A0%87%E5%AE%9A%E4%BD%8D%EF%BC%88Object-localization%EF%BC%89"><span class="toc-text">3.1 ç›®æ ‡å®šä½ï¼ˆObject localizationï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E7%89%B9%E5%BE%81%E7%82%B9%E6%A3%80%E6%B5%8B%EF%BC%88Landmark-detection%EF%BC%89"><span class="toc-text">3.2 ç‰¹å¾ç‚¹æ£€æµ‹ï¼ˆLandmark detectionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%88Object-detection%EF%BC%89"><span class="toc-text">3.3 ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%9A%84%E5%8D%B7%E7%A7%AF%E5%AE%9E%E7%8E%B0%EF%BC%88Convolutional-implementation-of-sliding-windows%EF%BC%89"><span class="toc-text">3.4 æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆConvolutional implementation of sliding windowsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-Bounding-Box-%E9%A2%84%E6%B5%8B-YOLO-%E7%AE%97%E6%B3%95"><span class="toc-text">3.5 Bounding Box é¢„æµ‹ - YOLO ç®—æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-%E4%BA%A4%E5%B9%B6%E6%AF%94%EF%BC%88Intersection-over-union%EF%BC%89"><span class="toc-text">3.6 äº¤å¹¶æ¯”ï¼ˆIntersection over unionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-%E9%9D%9E%E6%9E%81%E5%A4%A7%E5%80%BC%E6%8A%91%E5%88%B6%EF%BC%88Non-max-suppression%EF%BC%89"><span class="toc-text">3.7 éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNon-max suppressionï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-Anchor-Boxes"><span class="toc-text">3.8 Anchor Boxes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-%E6%95%B4%E5%90%88%E8%B5%B7%E6%9D%A5%EF%BC%9AYOLO-%E7%AE%97%E6%B3%95"><span class="toc-text">3.9 æ•´åˆèµ·æ¥ï¼šYOLO ç®—æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-10-%E5%80%99%E9%80%89%E5%8C%BA%E5%9F%9F%EF%BC%88Region-proposals-%EF%BC%89"><span class="toc-text">3.10 *å€™é€‰åŒºåŸŸï¼ˆRegion proposals ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%91%A8-%E7%89%B9%E6%AE%8A%E5%BA%94%E7%94%A8%EF%BC%9A%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E5%92%8C%E9%A3%8E%E6%A0%BC%E8%BF%81%E7%A7%BB"><span class="toc-text">ç¬¬å››å‘¨ ç‰¹æ®Šåº”ç”¨ï¼šäººè„¸è¯†åˆ«å’Œé£æ ¼è¿ç§»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%EF%BC%9F"><span class="toc-text">4.1 ä»€ä¹ˆæ˜¯äººè„¸è¯†åˆ«ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-One-Shot%E5%AD%A6%E4%B9%A0%EF%BC%88One-shot-learning%EF%BC%89"><span class="toc-text">4.2 One-Shotå­¦ä¹ ï¼ˆOne-shot learningï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-Siamese-%E7%BD%91%E7%BB%9C%EF%BC%88Siamese-network%EF%BC%89"><span class="toc-text">4.3 Siamese ç½‘ç»œï¼ˆSiamese networkï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-Triplet-%E6%8D%9F%E5%A4%B1"><span class="toc-text">4.4 Triplet æŸå¤±</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-%E9%9D%A2%E9%83%A8%E9%AA%8C%E8%AF%81%E4%B8%8E%E4%BA%8C%E5%88%86%E7%B1%BB%EF%BC%88Face-verification-and-binary-classification%EF%BC%89"><span class="toc-text">4.5 é¢éƒ¨éªŒè¯ä¸äºŒåˆ†ç±»ï¼ˆFace verification and binary classificationï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-%E4%BB%80%E4%B9%88%E6%98%AF%E7%A5%9E%E7%BB%8F%E9%A3%8E%E6%A0%BC%E8%BF%81%E7%A7%BB%EF%BC%9F%EF%BC%88neural-style-transfer%EF%BC%89"><span class="toc-text">4.6 ä»€ä¹ˆæ˜¯ç¥ç»é£æ ¼è¿ç§»ï¼Ÿï¼ˆneural style transferï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-%E6%B7%B1%E5%BA%A6%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C%E5%9C%A8%E5%AD%A6%E4%B9%A0%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">4.7 æ·±åº¦å·ç§¯ç½‘ç»œåœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8-%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0"><span class="toc-text">4.8 ä»£ä»·å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-9-%E5%86%85%E5%AE%B9%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0"><span class="toc-text">4.9 å†…å®¹ä»£ä»·å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-10-%E9%A3%8E%E6%A0%BC%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0"><span class="toc-text">4.10 é£æ ¼ä»£ä»·å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-%E5%9B%BE%E5%83%8F%E7%9A%84%E4%B8%80%E7%BB%B4%E5%92%8C%E4%B8%89%E7%BB%B4%E6%89%A9%E5%B1%95"><span class="toc-text">4.11 å›¾åƒçš„ä¸€ç»´å’Œä¸‰ç»´æ‰©å±•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E8%AF%BE-%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B-Sequence-Models"><span class="toc-text">ç¬¬äº”è¯¾ åºåˆ—æ¨¡å‹(Sequence Models)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%EF%BC%9ATensorflow-2-0-%E7%AC%94%E8%AE%B0"><span class="toc-text">ç¬¬å››éƒ¨åˆ†ï¼šTensorflow 2.0 ç¬”è®°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">1  åŸºæœ¬æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%BC%A0%E9%87%8F-Tensor"><span class="toc-text">1.1 å¼ é‡ Tensor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">1.2 å¸¸ç”¨å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-text">2 ä¼˜åŒ–æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E4%B8%80%E4%BA%9B%E5%87%BD%E6%95%B0"><span class="toc-text">2.1 ä¸€äº›å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E6%8C%87%E6%95%B0%E8%A1%B0%E5%87%8F%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-text">2. 2 æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0"><span class="toc-text">2.3 æ¿€æ´»å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-text">2.4 æŸå¤±å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-%E7%BC%93%E8%A7%A3%E8%BF%87%E6%8B%9F%E5%90%88"><span class="toc-text">2.5 ç¼“è§£è¿‡æ‹Ÿåˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E4%BC%98%E5%8C%96%E5%99%A8"><span class="toc-text">2.6 ä¼˜åŒ–å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%A0%E7%A7%8D%E4%BC%98%E5%8C%96%E5%99%A8"><span class="toc-text">å‡ ç§ä¼˜åŒ–å™¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E5%85%AB%E8%82%A1"><span class="toc-text">3 ç¥ç»ç½‘ç»œæ­å»ºå…«è‚¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E4%BD%BF%E7%94%A8Sequential%E6%90%AD%E5%BB%BA%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">3.1 ä½¿ç”¨Sequentialæ­å»ºç¥ç»ç½‘ç»œ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Sequential"><span class="toc-text">Sequential</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#compile"><span class="toc-text">compile</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fit"><span class="toc-text">fit</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#summary"><span class="toc-text">summary</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B%EF%BC%9A%E9%B8%A2%E5%B0%BE%E8%8A%B1%E8%AF%86%E5%88%AB"><span class="toc-text">ä¸¾ä¾‹ï¼šé¸¢å°¾èŠ±è¯†åˆ«</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E4%BD%BF%E7%94%A8class%E6%90%AD%E5%BB%BA%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">3.2  ä½¿ç”¨classæ­å»ºç¥ç»ç½‘ç»œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-MNIST-%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">3.3 MNIST æ•°æ®é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Sequential-1"><span class="toc-text">Sequential</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#class"><span class="toc-text">class</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%85%AB%E8%82%A1%E6%89%A9%E5%B1%95"><span class="toc-text">4 å…«è‚¡æ‰©å±•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E8%87%AA%E5%88%B6%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">4.1 è‡ªåˆ¶æ•°æ®é›†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><span class="toc-text">4.2 æ•°æ®å¢å¼º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E6%96%AD%E7%82%B9%E7%BB%AD%E8%AE%AD"><span class="toc-text">4.3 æ–­ç‚¹ç»­è®­</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%A8%A1%E5%9E%8B"><span class="toc-text">è¯»å–æ¨¡å‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="toc-text">ä¿å­˜æ¨¡å‹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-%E5%8F%82%E6%95%B0%E6%8F%90%E5%8F%96"><span class="toc-text">4.4 å‚æ•°æå–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-acc-x2F-loss-%E6%9B%B2%E7%BA%BF"><span class="toc-text">4.5 acc&#x2F;loss æ›²çº¿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-text">4.6 æ¨¡å‹åº”ç”¨ç¨‹åº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">5 å·ç§¯ç¥ç»ç½‘ç»œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E5%8D%B7%E7%A7%AF%E6%A6%82%E5%BF%B5"><span class="toc-text">5.1 å·ç§¯æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97"><span class="toc-text">å·ç§¯è®¡ç®—</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%84%9F%E5%8F%97%E9%87%8E"><span class="toc-text">æ„Ÿå—é‡</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-tensorflow%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">5.2 tensorflowå·ç§¯å±‚çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-padading-%E5%85%A8%E9%9B%B6%E5%A1%AB%E5%85%85"><span class="toc-text">A. padading-å…¨é›¶å¡«å……</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-Conv2D-%E6%8F%8F%E8%BF%B0%E5%8D%B7%E7%A7%AF%E5%B1%82"><span class="toc-text">B. Conv2D-æè¿°å·ç§¯å±‚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-BN-%E6%89%B9%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-text">C. BN-æ‰¹æ ‡å‡†åŒ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D-Pooling-%E6%B1%A0%E5%8C%96"><span class="toc-text">D. Pooling-æ± åŒ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#E-Dropout-%E8%88%8D%E5%BC%83"><span class="toc-text">E. Dropout-èˆå¼ƒ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E7%A4%BA%E4%BE%8B"><span class="toc-text">5.3 å·ç§¯ç¥ç»ç½‘ç»œæ­å»ºç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Cifar-10-%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">Cifar 10 æ•°æ®é›†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E7%A4%BA%E4%BE%8B"><span class="toc-text">æ­å»ºç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-LeNet"><span class="toc-text">5.4 LeNet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-AlexNet"><span class="toc-text">5.5 AlexNet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-VGGNet"><span class="toc-text">5.6 VGGNet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-Inception-Net"><span class="toc-text">5.7 Inception Net</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-ResNet"><span class="toc-text">5.8 ResNet</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://acbgzm.github.io/2021/05/27/dlang/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="miu"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ä¸´æ—¶ä¸ªäººä¸»é¡µ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">dl &amp; ai - andrew ng</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-27 14:49:55" itemprop="dateCreated datePublished" datetime="2021-05-27T14:49:55+08:00">2021-05-27</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">26.2k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">107m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E7%AC%94%E8%AE%B0/" style="--text-color:dimgray" itemprop="url" rel="index"><span itemprop="text">ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">æœºå™¨å­¦ä¹ </span></a><a class="tag-item" href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">è¯¾ç¨‹ç¬”è®°</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>å…¶å®æœ€è¿‘ä¸€ç›´åœ¨çœ‹ä¸€äº›å…·ä½“çš„ä»»åŠ¡äº†ï¼Œä¹‹å‰åŸºç¡€çš„æ·±åº¦å­¦ä¹ ç¬”è®°æ²¡æœ‰æ•´ç†æˆæ–‡ç« ï¼Œç°åœ¨å½’çº³ä¸€ä¸‹ã€‚ä¸»è¦çœ‹äº†è¿™äº›ï¼š</p>
<ul>
<li>3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘</li>
<li>èƒ¡æµ©åŸºè€å¸ˆç½‘è¯¾çš„ä¸€éƒ¨åˆ†</li>
<li>å´æ©è¾¾deeplearning.aiçš„ä¸€éƒ¨åˆ†ï¼ˆä¸»è¦çœ‹çš„è¿™ä¸ªï¼‰</li>
<li>æ›¹å»ºè€å¸ˆçš„tensorflow2è§†é¢‘</li>
</ul>
<h1 id="ç¬¬ä¸€éƒ¨åˆ†ï¼š3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼š3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼š3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼š3B1Bçš„ç¥ç»ç½‘ç»œè§†é¢‘</h1><p>ï¼ˆä¸»è¦æ˜¯ä¸€äº›æ¦‚å¿µçš„ç›´è§‚ç†è§£ã€‚ï¼‰</p>
<p>å­¦ä¹ çš„å«ä¹‰ï¼šæ‰¾åˆ°ç‰¹å®šçš„ $\omega$ å’Œ $b$ ï¼Œä½¿ä»£ä»·å‡½æ•°æœ€å°åŒ–ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b1.png'  width="80%" height="80%"/ loading="lazy">



<p>åå‘ä¼ æ’­ï¼šè®¡ç®—å•ä¸ªè®­ç»ƒæ ·æœ¬æƒ³æ€æ ·ä¿®æ”¹ $\omega$ å’Œ $b$ ã€‚ä¸ä»…æ˜¯æ¯ä¸ªå‚æ•°åº”è¯¥å˜å¤§è¿˜æ˜¯å˜å°ï¼Œè¿˜åŒ…æ‹¬è¿™äº›å˜åŒ–çš„æ¯”ä¾‹æ˜¯å¤šå¤§ï¼Œæ‰èƒ½æœ€å¿«ä¸‹é™æ¢¯åº¦å‡½æ•°ã€‚ä¸€ä¸ªçœŸæ­£çš„æ¢¯åº¦ä¸‹é™è¿‡ç¨‹è¦å¯¹æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬æ±‚å¹³å‡ï¼Œä½†è®¡ç®—å¤ªæ…¢ï¼Œå°±å…ˆæŠŠæ‰€æœ‰çš„æ ·æœ¬åˆ†åˆ°minibatchä¸­ï¼Œï¼Œè®¡ç®—ä¸€ä¸ªminibatchæ¥ä½œä¸ºæ¢¯åº¦ä¸‹é™çš„ä¸€æ­¥ï¼Œæœ€ç»ˆä¼šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹ã€‚</p>
<p>ä¸ºäº†ä½¿ $a_{i+1}$ çš„æŸä¸ªè¾“å‡ºå¢å¤§ï¼Œå¯ä»¥</p>
<ul>
<li>å¢å¤§ $b$ </li>
<li>å¢å¤§ $\omega$ ï¼šå¢åŠ ä¸Šå±‚æ´»è·ƒçš„ç¥ç»å…ƒçš„æƒé‡æ›´å¥½ã€‚ä¾æ®å¯¹åº”æƒé‡å¤§å°ï¼Œå¯¹æ¿€æ´»å€¼åšå‡ºæˆæ¯”ä¾‹çš„æ”¹å˜ã€‚</li>
<li>æ”¹å˜ $a_i$</li>
</ul>
<p>åå‘ä¼ æ’­çš„é“¾å¼æ³•åˆ™</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b2.png'  width="80%" height="80%"/ loading="lazy">



<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3b1b3.png'  width="80%" height="80%"/ loading="lazy">





<h1 id="ç¬¬äºŒéƒ¨åˆ†ï¼šèƒ¡æµ©åŸºè€å¸ˆNNã€CNNéƒ¨åˆ†"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šèƒ¡æµ©åŸºè€å¸ˆNNã€CNNéƒ¨åˆ†" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šèƒ¡æµ©åŸºè€å¸ˆNNã€CNNéƒ¨åˆ†"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šèƒ¡æµ©åŸºè€å¸ˆNNã€CNNéƒ¨åˆ†</h1><p>æ‰‹å†™äº†ç¬”è®°ï¼Œå…¶å®é‡å¤çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œå°±ä¸æ¯å¼ æ‹ç…§ä¸Šä¼ äº†ã€‚åç»­æŠŠå‡ ä¸ªæ‰‹æ¨çš„å…¬å¼æ‹ä¸€ä¸‹ã€‚</p>
<h1 id="ç¬¬ä¸‰éƒ¨åˆ†ï¼šå´æ©è¾¾deeplearning-aiç½‘è¯¾"><a href="#ç¬¬ä¸‰éƒ¨åˆ†ï¼šå´æ©è¾¾deeplearning-aiç½‘è¯¾" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ†ï¼šå´æ©è¾¾deeplearning.aiç½‘è¯¾"></a>ç¬¬ä¸‰éƒ¨åˆ†ï¼šå´æ©è¾¾deeplearning.aiç½‘è¯¾</h1><p>çœ‹çš„ç½‘æ˜“äº‘è¯¾å ‚åšçš„å­—å¹•ç‰ˆæœ¬ï¼Œå¯æƒœå³ä¸Šæ–¹æœ‰æ°´å°ï¼Œæœ‰äº›åœ°æ–¹æœ‰é®æŒ¡ã€‚</p>
<h2 id="ç¬¬ä¸€è¯¾-ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼ˆNeural-Networks-and-Deep-Learningï¼‰"><a href="#ç¬¬ä¸€è¯¾-ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼ˆNeural-Networks-and-Deep-Learningï¼‰" class="headerlink" title="ç¬¬ä¸€è¯¾ ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼ˆNeural Networks and Deep Learningï¼‰"></a>ç¬¬ä¸€è¯¾ ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼ˆNeural Networks and Deep Learningï¼‰</h2><h3 id="ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ å¼•è¨€ï¼ˆIntroduction-to-Deep-Learningï¼‰"><a href="#ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ å¼•è¨€ï¼ˆIntroduction-to-Deep-Learningï¼‰" class="headerlink" title="ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ å¼•è¨€ï¼ˆIntroduction to Deep Learningï¼‰"></a>ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ å¼•è¨€ï¼ˆIntroduction to Deep Learningï¼‰</h3><h4 id="1-1-æ¬¢è¿"><a href="#1-1-æ¬¢è¿" class="headerlink" title="1.1 æ¬¢è¿"></a>1.1 æ¬¢è¿</h4><p>å…³äºè¯¾ç¨‹å®‰æ’</p>
<h4 id="1-2-ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ"><a href="#1-2-ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ" class="headerlink" title="1.2 ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ"></a>1.2 ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ</h4><p>ç¥ç»ç½‘ç»œå¯ä»¥å½“ä½œä¸€ä¸ªå‡½æ•°ã€‚é€šè¿‡æ•°æ®é›†è®¡ç®—ä»xåˆ°yçš„ç²¾å‡†æ˜ å°„å‡½æ•°ï¼Œç„¶åå¯¹äºæ–°çš„æ•°æ®xï¼Œç»™å‡ºé¢„æµ‹çš„ç»“æœyã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/1.png'  width="80%" height="80%"/ loading="lazy">



<h4 id="1-3-ç¥ç»ç½‘ç»œçš„ç›‘ç£å­¦ä¹ -Supervised-Learning-with-Neural-Networks"><a href="#1-3-ç¥ç»ç½‘ç»œçš„ç›‘ç£å­¦ä¹ -Supervised-Learning-with-Neural-Networks" class="headerlink" title="1.3 ç¥ç»ç½‘ç»œçš„ç›‘ç£å­¦ä¹ (Supervised Learning with Neural Networks)"></a>1.3 ç¥ç»ç½‘ç»œçš„ç›‘ç£å­¦ä¹ (Supervised Learning with Neural Networks)</h4><p>ç›‘ç£å­¦ä¹ ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/2.png' width="80%" height="80%"/ loading="lazy">

<p>å¯¹äºå›¾ç‰‡ï¼Œä½¿ç”¨CNNã€‚å¯¹äºåºåˆ—ä¿¡æ¯ï¼ˆéŸ³é¢‘ã€è¯­è¨€ä¿¡æ¯ç­‰ï¼‰ä½¿ç”¨RNNã€‚</p>
<p>ç»“æ„åŒ–æ•°æ®ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/3.png' width="80%" height="80%"/ loading="lazy">

<p>ç¥ç»ç½‘ç»œèƒ½å¸®åŠ©è®¡ç®—æœºç†è§£æ— ç»“æ„åŒ–æ•°æ®ã€‚</p>
<h4 id="1-4-ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¼šæµè¡Œï¼Ÿ"><a href="#1-4-ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¼šæµè¡Œï¼Ÿ" class="headerlink" title="1.4 ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¼šæµè¡Œï¼Ÿ"></a>1.4 ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¼šæµè¡Œï¼Ÿ</h4><p>æ•°æ®å’Œè®¡ç®—è§„æ¨¡çš„è¿›å±•ã€‚ç°åœ¨è·å¾—äº†å¾ˆå¤§çš„æ•°æ®é‡ã€è®¡ç®—äº†å¾ˆå¤æ‚çš„ç½‘ç»œã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/4.png' width="80%" height="80%"/ loading="lazy">

<p>å…¶ä»–åŸå› ï¼šç®—æ³•çš„æ”¹è¿›ï¼Œæ¯”å¦‚ä»sigmoidå‡½æ•°åˆ°reluå‡½æ•°</p>
<h4 id="1-5-1-6-è¯¾ç¨‹å®‰æ’"><a href="#1-5-1-6-è¯¾ç¨‹å®‰æ’" class="headerlink" title="1.5~1.6 è¯¾ç¨‹å®‰æ’"></a>1.5~1.6 è¯¾ç¨‹å®‰æ’</h4><p>ç•¥</p>
<h3 id="ç¬¬äºŒå‘¨ï¼šç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics-of-Neural-Network-Programmingï¼‰"><a href="#ç¬¬äºŒå‘¨ï¼šç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics-of-Neural-Network-Programmingï¼‰" class="headerlink" title="ç¬¬äºŒå‘¨ï¼šç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network Programmingï¼‰"></a>ç¬¬äºŒå‘¨ï¼šç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network Programmingï¼‰</h3><h4 id="2-1-äºŒåˆ†ç±»-Binary-Classification"><a href="#2-1-äºŒåˆ†ç±»-Binary-Classification" class="headerlink" title="2.1 äºŒåˆ†ç±»(Binary Classification)"></a>2.1 äºŒåˆ†ç±»(Binary Classification)</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/6.png' width="80%" height="80%"/ loading="lazy">

<p>æ•°æ®é›†æŒ‰åˆ—ç»„æˆçŸ©é˜µï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/5.png' width="80%" height="80%"/ loading="lazy">

<p>X.shape &#x3D; (n<sub>x</sub>, m)</p>
<p>y.shape &#x3D; (1, m)</p>
<h4 id="2-2-é€»è¾‘å›å½’-Logistic-Regression"><a href="#2-2-é€»è¾‘å›å½’-Logistic-Regression" class="headerlink" title="2.2 é€»è¾‘å›å½’(Logistic Regression)"></a>2.2 é€»è¾‘å›å½’(Logistic Regression)</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/7.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œå°† $b$ å’Œ $w$ åˆ†å¼€è¡¨ç¤ºï¼Œä¸é‡‡ç”¨é€»è¾‘å›å½’é‚£æ ·ç»„åˆæˆ $\theta$ çš„å½¢å¼ã€‚</p>
<h4 id="2-3-é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°"><a href="#2-3-é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°" class="headerlink" title="2.3 é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°"></a>2.3 é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/8.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-4-æ¢¯åº¦ä¸‹é™ï¼ˆGradient-Descentï¼‰"><a href="#2-4-æ¢¯åº¦ä¸‹é™ï¼ˆGradient-Descentï¼‰" class="headerlink" title="2.4 æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰"></a>2.4 æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/9.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-5-2-6-å¯¼æ•°"><a href="#2-5-2-6-å¯¼æ•°" class="headerlink" title="2.5~2.6 å¯¼æ•°"></a>2.5~2.6 å¯¼æ•°</h4><p>ç•¥</p>
<h4 id="2-7-è®¡ç®—å›¾ï¼ˆComputation-Graphï¼‰"><a href="#2-7-è®¡ç®—å›¾ï¼ˆComputation-Graphï¼‰" class="headerlink" title="2.7 è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰"></a>2.7 è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰</h4><p>è®¡ç®—å›¾è¡¨ç¤ºä»å·¦å‘å³çš„è®¡ç®—è¿‡ç¨‹ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/10.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-8-è®¡ç®—å›¾å¯¼æ•°"><a href="#2-8-è®¡ç®—å›¾å¯¼æ•°" class="headerlink" title="2.8 è®¡ç®—å›¾å¯¼æ•°"></a>2.8 è®¡ç®—å›¾å¯¼æ•°</h4><p>æ ¹æ®è®¡ç®—å›¾ï¼Œä»å³åˆ°å·¦è®¡ç®—å‡½æ•° J çš„å¯¼æ•°ã€‚ï¼ˆé“¾å¼æ±‚å¯¼ï¼‰</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/11.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-9-é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™"><a href="#2-9-é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.9 é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™"></a>2.9 é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™</h4><p>ç”¨è®¡ç®—å›¾ç†è§£é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/12.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-10-æ¢¯åº¦ä¸‹é™çš„ä¾‹å­"><a href="#2-10-æ¢¯åº¦ä¸‹é™çš„ä¾‹å­" class="headerlink" title="2.10 æ¢¯åº¦ä¸‹é™çš„ä¾‹å­"></a>2.10 æ¢¯åº¦ä¸‹é™çš„ä¾‹å­</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/13.png' width="80%" height="80%"/ loading="lazy">

<p>dw<sub>1</sub>ã€ dw<sub>2</sub>ã€db ä½œä¸ºç´¯åŠ å™¨ã€‚æ•°æ®é›†å¾ªç¯åï¼ŒJã€ dw<sub>1</sub>ã€ dw<sub>2</sub>ã€db é™¤ä»¥æ ·æœ¬ä¸ªæ•°ã€‚</p>
<p>ä¸€æ¬¡æ¢¯åº¦ä¸‹é™æœ‰ä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚å¾ªç¯éå†æ‰€æœ‰æ•°æ®æ ·æœ¬ï¼ˆmä¸ªï¼‰ï¼Œå†…å±‚å¾ªç¯éå†æ‰€æœ‰ç‰¹å¾ wï¼ˆnä¸ªï¼‰ã€‚</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ•°æ®é‡å¾ˆå¤§ï¼Œ<strong>ä¸ºäº†ä¸ç”¨æ˜¾å¼çš„forå¾ªç¯ï¼Œä½¿ç”¨å‘é‡åŒ–</strong>ã€‚</p>
<h4 id="2-11-å‘é‡åŒ–-Vectorization"><a href="#2-11-å‘é‡åŒ–-Vectorization" class="headerlink" title="2.11 å‘é‡åŒ–(Vectorization)"></a>2.11 å‘é‡åŒ–(Vectorization)</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/14.png' width="80%" height="80%"/ loading="lazy">

<p>å‘é‡åŒ–æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚åœ¨ä¸Šå›¾1000000ç»´å‘é‡ç›¸ä¹˜è¿ç®—ä¸­ï¼Œä½¿ç”¨å‘é‡åŒ–æ¯”ä½¿ç”¨forå¾ªç¯èŠ‚çœ300å€çš„æ—¶é—´ã€‚</p>
<h4 id="2-12-æ›´å¤šçš„å‘é‡åŒ–ä¾‹å­"><a href="#2-12-æ›´å¤šçš„å‘é‡åŒ–ä¾‹å­" class="headerlink" title="2.12 æ›´å¤šçš„å‘é‡åŒ–ä¾‹å­"></a>2.12 æ›´å¤šçš„å‘é‡åŒ–ä¾‹å­</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/15.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-13-å‘é‡åŒ–é€»è¾‘å›å½’"><a href="#2-13-å‘é‡åŒ–é€»è¾‘å›å½’" class="headerlink" title="2.13 å‘é‡åŒ–é€»è¾‘å›å½’"></a>2.13 å‘é‡åŒ–é€»è¾‘å›å½’</h4><p>å‘é‡åŒ–é€»è¾‘å›å½’çš„æ­£å‘ä¼ æ’­ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/16.png' width="80%" height="80%"/ loading="lazy">

<p>Z &#x3D; np.dot(w.T, X) + b</p>
<blockquote>
<p>w.shape  &#x3D;(n_x, 1)ï¼Œæ¯ä¸ªç‰¹å¾å¯¹åº”ä¸€ä¸ªwï¼Œåˆ—å‘é‡</p>
<p>X.shape &#x3D; (n_x, m)</p>
<p>z.shape &#x3D; (1, m)</p>
<p>bæœ¬æ¥æ˜¯ä¸€ä¸ªå®æ•°ï¼Œpythonçš„broadcastingæœºåˆ¶åœ¨ç›¸åŠ æ—¶ï¼ŒæŠŠbæ‰©å±•ä¸º ï¼ˆ1ï¼Œ m) ç»´çš„è¡Œå‘é‡ã€‚</p>
</blockquote>
<h4 id="2-14-å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è®¡ç®—"><a href="#2-14-å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è®¡ç®—" class="headerlink" title="2.14 å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è®¡ç®—"></a>2.14 å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è®¡ç®—</h4><p>å‘é‡åŒ–é€»è¾‘å›å½’çš„åå‘ä¼ æ’­ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/17.png' width="80%" height="80%"/ loading="lazy">

<p>dZ &#x3D; A - Y</p>
<p>db &#x3D; np.sum(dZ) &#x2F; m</p>
<p>dw &#x3D;  np.dot(X, dZ.T) &#x2F; m</p>
<blockquote>
<p>X.shape &#x3D; (n_x, m)</p>
<p>dZ.shape &#x3D; (1, m)</p>
<p>dw.shape &#x3D; (n_x, 1)</p>
</blockquote>
<p>ä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/18.png' width="80%" height="80%"/ loading="lazy">





<h4 id="2-15-Pythonä¸­çš„å¹¿æ’­æœºåˆ¶ï¼ˆBroadcasting-in-Pythonï¼‰"><a href="#2-15-Pythonä¸­çš„å¹¿æ’­æœºåˆ¶ï¼ˆBroadcasting-in-Pythonï¼‰" class="headerlink" title="2.15 Pythonä¸­çš„å¹¿æ’­æœºåˆ¶ï¼ˆBroadcasting in Pythonï¼‰"></a>2.15 Pythonä¸­çš„å¹¿æ’­æœºåˆ¶ï¼ˆBroadcasting in Pythonï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/19.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-16-å…³äº-Pythonä¸numpyå‘é‡çš„ä½¿ç”¨"><a href="#2-16-å…³äº-Pythonä¸numpyå‘é‡çš„ä½¿ç”¨" class="headerlink" title="2.16 å…³äº Pythonä¸numpyå‘é‡çš„ä½¿ç”¨"></a>2.16 å…³äº Pythonä¸numpyå‘é‡çš„ä½¿ç”¨</h4><p><code> a = np.random.randn(5)</code></p>
<blockquote>
<p>a.shape &#x3D; (5, )</p>
</blockquote>
<p>è¿™æ˜¯numpyçš„ç‰¹æ®Šæ ¼å¼â€rank 1 arrayâ€ï¼Œ<code>a.T</code> æ“ä½œä»ç„¶å¾—åˆ°è¿™ç§æ ¼å¼çš„æ•°ç»„ã€‚</p>
<p>åœ¨ç¥ç»ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œé¿å…ä½¿ç”¨è¿™ç§ç§©ä¸º1çš„æ•°ç»„ã€‚</p>
<p>ç”¨ <code> a = np.random.randn(5, 1)</code> ä½œä¸ºæ›¿ä»£ã€‚æ­¤æ—¶å°±å¯ä»¥ç”¨ <code>np.dot(a, a.T)</code> å¾—åˆ°ä¸€ä¸ªçŸ©é˜µäº†ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç”¨ <code>assert</code> æˆ– <code>reshape</code> ä¿®æ”¹ä¸ºçŸ©é˜µæ ¼å¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/20.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-17-Jupyter-x2F-iPython-Notebookså¿«é€Ÿå…¥é—¨"><a href="#2-17-Jupyter-x2F-iPython-Notebookså¿«é€Ÿå…¥é—¨" class="headerlink" title="2.17 Jupyter&#x2F;iPython Notebookså¿«é€Ÿå…¥é—¨"></a>2.17 Jupyter&#x2F;iPython Notebookså¿«é€Ÿå…¥é—¨</h4><p>ç•¥</p>
<h4 id="2-18-é€»è¾‘å›å½’æŸå¤±å‡½æ•°è¯¦è§£"><a href="#2-18-é€»è¾‘å›å½’æŸå¤±å‡½æ•°è¯¦è§£" class="headerlink" title="2.18* é€»è¾‘å›å½’æŸå¤±å‡½æ•°è¯¦è§£"></a>2.18* é€»è¾‘å›å½’æŸå¤±å‡½æ•°è¯¦è§£</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/21.png' width="80%" height="80%"/ loading="lazy">



<p>åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šçš„æƒ…å†µï¼šå‡è®¾æ ·æœ¬æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå¯ä»¥ç´¯ä¹˜ï¼Œåšæœ€å¤§ä¼¼ç„¶ä¼°è®¡ä½¿è¿™ä¸ªå¼å­å–æœ€å¤§å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/22.png' width="80%" height="80%"/ loading="lazy">





<h3 id="ç¬¬ä¸‰å‘¨ï¼šæµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow-Neural-Networksï¼‰"><a href="#ç¬¬ä¸‰å‘¨ï¼šæµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow-Neural-Networksï¼‰" class="headerlink" title="ç¬¬ä¸‰å‘¨ï¼šæµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow Neural Networksï¼‰"></a>ç¬¬ä¸‰å‘¨ï¼šæµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow Neural Networksï¼‰</h3><h4 id="3-1-ç¥ç»ç½‘ç»œæ¦‚è¿°"><a href="#3-1-ç¥ç»ç½‘ç»œæ¦‚è¿°" class="headerlink" title="3.1 ç¥ç»ç½‘ç»œæ¦‚è¿°"></a>3.1 ç¥ç»ç½‘ç»œæ¦‚è¿°</h4><p>æ­£å‘ä¼ æ’­ï¼Œè®¡ç®—æŸå¤±å‡½æ•° $L$ ï¼›åå‘ä¼ æ’­ï¼Œè®¡ç®—æ¢¯åº¦ä¸‹é™éœ€è¦çš„ $dW$ã€$db$ ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/23.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-2-ç¥ç»ç½‘ç»œçš„è¡¨ç¤º"><a href="#3-2-ç¥ç»ç½‘ç»œçš„è¡¨ç¤º" class="headerlink" title="3.2 ç¥ç»ç½‘ç»œçš„è¡¨ç¤º"></a>3.2 ç¥ç»ç½‘ç»œçš„è¡¨ç¤º</h4><p>$ a^{[i]}$ è¡¨ç¤ºç¬¬ $i$ å±‚çš„æ¿€æ´»å€¼ï¼Œ$a^{[0]}&#x3D;X$</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/24.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-3-è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡º"><a href="#3-3-è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡º" class="headerlink" title="3.3 è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡º"></a>3.3 è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡º</h4><p>å‘é‡åŒ–çš„å‰å‘ä¼ æ’­</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/25.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-4-å¤šæ ·æœ¬å‘é‡åŒ–"><a href="#3-4-å¤šæ ·æœ¬å‘é‡åŒ–" class="headerlink" title="3.4 å¤šæ ·æœ¬å‘é‡åŒ–"></a>3.4 å¤šæ ·æœ¬å‘é‡åŒ–</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/26.png' width="80%" height="80%"/ loading="lazy">

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/27.png' width="80%" height="80%"/ loading="lazy">

<p>$X,Z,A$ éƒ½æ˜¯æŒ‰åˆ—ç»„åˆèµ·æ¥çš„çŸ©é˜µã€‚</p>
<h4 id="3-5-å‘é‡åŒ–å®ç°çš„è§£é‡Š"><a href="#3-5-å‘é‡åŒ–å®ç°çš„è§£é‡Š" class="headerlink" title="3.5 å‘é‡åŒ–å®ç°çš„è§£é‡Š"></a>3.5 å‘é‡åŒ–å®ç°çš„è§£é‡Š</h4><p>$Z^{[1]}$ çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ $X_i$ ç»è¿‡ $W^{[1]}$ è®¡ç®—è€Œæ¥çš„ã€‚</p>
<p>å½“å¤„ç†å¤šä¸ªè®­ç»ƒæ ·æœ¬æ—¶ï¼Œ$X$ æ˜¯åˆ—å‘é‡æ‹¼èµ·æ¥çš„å½¢å¼ï¼Œåˆ™ $Z$ ä¹Ÿæ˜¯ $X$ çš„æ¯ä¸€åˆ—çš„è®¡ç®—ç»“æœã€‚</p>
<p>æŠŠ $b$ åŠ ä¸Šä¹Ÿä¸€æ ·ï¼Œå¯èƒ½ç”¨åˆ°å¹¿æ’­æœºåˆ¶ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/28.png' width="80%" height="80%"/ loading="lazy">

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/29.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-6-æ¿€æ´»å‡½æ•°ï¼ˆActivation-functionsï¼‰"><a href="#3-6-æ¿€æ´»å‡½æ•°ï¼ˆActivation-functionsï¼‰" class="headerlink" title="3.6 æ¿€æ´»å‡½æ•°ï¼ˆActivation functionsï¼‰"></a>3.6 æ¿€æ´»å‡½æ•°ï¼ˆActivation functionsï¼‰</h4><p>ä¸åŒå±‚çš„æ¿€æ´»å‡½æ•°å¯ä»¥ä¸ä¸€æ ·ã€‚åœ¨éšè—å±‚ä¸­ï¼Œtanhå‡½æ•°æ•ˆæœæ¯”sigmoidå¥½ï¼›ä½†åœ¨è¾“å‡ºå±‚ï¼ŒäºŒåˆ†ç±»ä»»åŠ¡ç”¨sigmoidæ¯”è¾ƒå¥½ï¼Œå› ä¸ºè¾“å‡ºæ˜¯0~1.</p>
<p>tanhå’Œsigmoidå‡½æ•°çš„é—®é¢˜æ˜¯ï¼šå½“xå¾ˆå¤§æˆ–å¾ˆå°ï¼Œå‡½æ•°çš„æ¢¯åº¦çº¦ä¸º0ï¼Œä¼šæ‹–æ…¢æ¢¯åº¦ä¸‹é™ã€‚å› æ­¤åœ¨éšè—å±‚ç”¨ReLUå‡½æ•°æ›´å¥½ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/30.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-7-ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ"><a href="#3-7-ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ" class="headerlink" title="3.7 ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ"></a>3.7 ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ</h4><p>å¦‚æœä¸ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œç¥ç»ç½‘ç»œçš„è¾“å‡ºå°±æ˜¯ $X$ çš„çº¿æ€§ç»„åˆã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/31.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-8-æ¿€æ´»å‡½æ•°çš„å¯¼æ•°"><a href="#3-8-æ¿€æ´»å‡½æ•°çš„å¯¼æ•°" class="headerlink" title="3.8 æ¿€æ´»å‡½æ•°çš„å¯¼æ•°"></a>3.8 æ¿€æ´»å‡½æ•°çš„å¯¼æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/30.png' width="80%" height="80%"/ loading="lazy">

<p>Sigmoidï¼š</p>
<p>$$a &#x3D; g(z) &#x3D; \frac{1}{1+e^{-z}}$$</p>
<p>$$gâ€™(z)&#x3D;\frac{d}{dz}g(z) &#x3D; g(z)(1-g(z))&#x3D;a(1-a)$$</p>
<p>tanhï¼š</p>
<p>$$g(z)&#x3D;\frac{e^z-e^{-z}}{e^z+e^{-z}}$$</p>
<p>$$gâ€™(z)&#x3D;\frac{d}{dz}g(z) &#x3D; 1-(g(z))^2$$</p>
<p>ReLUï¼šåœ¨0å¤„å¯ä»¥æŒ‡å®šå¯¼æ•°çš„å€¼</p>
<p>$$g(z)&#x3D;max(0, z)$$</p>
<p>$$ gâ€™(z)&#x3D; \begin{cases}  0,&amp;\text{if } z&lt;0 \ 1,&amp;\text{if } zâ‰¥0 \end{cases} $$</p>
<p>Leaky ReLUï¼š</p>
<p>$$g(z)&#x3D;max(0.01z, z)$$</p>
<p>$$ gâ€™(z)&#x3D; \begin{cases}  0.01,&amp;\text{if } z&lt;0 \ 1,&amp;\text{if } zâ‰¥0 \end{cases} $$</p>
<h4 id="3-9-ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™"><a href="#3-9-ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="3.9 ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™"></a>3.9 ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/32.png' width="80%" height="80%"/ loading="lazy">

<p>å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼š</p>
<blockquote>
<p>$Z^{[1]} &#x3D; W^{[1]}X + b^{[1]}$</p>
<p>$A^{[1]} &#x3D; g^{[1]}(Z^{[1]})$</p>
<p>$Z^{[2]} &#x3D; W^{[2]}A^{[1]} + b^{[2]}$</p>
<p>$A^{[2]} &#x3D; g^{[2]}(Z^{[2]})$</p>
</blockquote>
<p>åå‘ä¼ æ’­è¿‡ç¨‹ï¼š</p>
<blockquote>
<p>$dZ^{[2]}&#x3D;A^{[2]}-Y$</p>
<p>$dW^{[2]}&#x3D;\frac{1}{m} dZ^{[2]} (A^{[1]} )^T$</p>
<p>$db^{[2]} &#x3D; \frac{1}{m}np.sum(dZ^{[2]}, axis&#x3D;1, keepdims&#x3D;ture)$ </p>
<p>$dZ^{[1]} &#x3D;( W^{[2]})^T  dZ^{[2]} * g^{â€˜[1]}(Z^{[1]})$</p>
<p>$dW^{[1]}&#x3D;\frac{1}{m} dZ^{[1]} X^T$</p>
<p>$db^{[1]} &#x3D; \frac{1}{m}np.sum(dZ^{[1]}, axis&#x3D;1, keepdims&#x3D;ture)$</p>
</blockquote>
<h4 id="3-10ï¼ˆé€‰ä¿®ï¼‰ç›´è§‚ç†è§£åå‘ä¼ æ’­ï¼ˆBackpropagation-intuitionï¼‰"><a href="#3-10ï¼ˆé€‰ä¿®ï¼‰ç›´è§‚ç†è§£åå‘ä¼ æ’­ï¼ˆBackpropagation-intuitionï¼‰" class="headerlink" title="3.10ï¼ˆé€‰ä¿®ï¼‰ç›´è§‚ç†è§£åå‘ä¼ æ’­ï¼ˆBackpropagation intuitionï¼‰"></a>3.10ï¼ˆé€‰ä¿®ï¼‰ç›´è§‚ç†è§£åå‘ä¼ æ’­ï¼ˆBackpropagation intuitionï¼‰</h4><p>æƒ³ä¸€æƒ³çŸ©é˜µçš„ç»´åº¦ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/33.png' width="80%" height="80%"/ loading="lazy">

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/34.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-11-éšæœºåˆå§‹åŒ–ï¼ˆRandom-Initializationï¼‰"><a href="#3-11-éšæœºåˆå§‹åŒ–ï¼ˆRandom-Initializationï¼‰" class="headerlink" title="3.11 éšæœºåˆå§‹åŒ–ï¼ˆRandom Initializationï¼‰"></a>3.11 éšæœºåˆå§‹åŒ–ï¼ˆRandom Initializationï¼‰</h4><p>ä¸èƒ½ç”¨å…¨0åˆå§‹åŒ–ç¥ç»ç½‘ç»œï¼Œè¿™ä¼šå¯¼è‡´ç¥ç»å…ƒçš„å¯¹ç§°æ€§å’Œåå‘ä¼ æ’­å¤±æ•ˆã€‚</p>
<p>éšæœºåˆå§‹åŒ–ï¼šç”¨å¾ˆå°çš„éšæœºæ•°åˆå§‹åŒ– $W$ ï¼Œç”¨0åˆå§‹åŒ– $b$ .</p>
<p>å¦‚æœ $W$ çš„å€¼å¤ªå¤§ï¼Œ$z$ ä¼šè½åœ¨tanhå‡½æ•°å’Œsigmoidå‡½æ•°å¹³ç¼“çš„éƒ¨åˆ†ï¼Œæ¢¯åº¦ä¸‹é™ä¼šå¾ˆæ…¢ã€‚å¦‚æœå®Œå…¨æ²¡æœ‰ç”¨åˆ°è¿™ä¸¤ä¸ªå‡½æ•°å°±æ²¡æœ‰å½±å“ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/35.png' width="80%" height="80%"/ loading="lazy">

<p>è®­ç»ƒæµ…å±‚ç¥ç»ç½‘ç»œï¼Œ0.01æ˜¯å¯ç”¨çš„ï¼›å½“è®­ç»ƒæ·±å±‚ç¥ç»ç½‘ç»œï¼Œè¦ä½¿ç”¨å…¶ä»–çš„å¸¸æ•°ï¼Œåœ¨ä¹‹åè®²ã€‚</p>
<h3 id="ç¬¬å››å‘¨ï¼šæ·±å±‚ç¥ç»ç½‘ç»œ"><a href="#ç¬¬å››å‘¨ï¼šæ·±å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="ç¬¬å››å‘¨ï¼šæ·±å±‚ç¥ç»ç½‘ç»œ"></a>ç¬¬å››å‘¨ï¼šæ·±å±‚ç¥ç»ç½‘ç»œ</h3><h4 id="4-1-æ·±å±‚ç¥ç»ç½‘ç»œ"><a href="#4-1-æ·±å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1 æ·±å±‚ç¥ç»ç½‘ç»œ"></a>4.1 æ·±å±‚ç¥ç»ç½‘ç»œ</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/36.png' width="80%" height="80%"/ loading="lazy">

<p>$L$ï¼šå±‚æ•°ï¼Œä»0å¼€å§‹è®¡æ•°ã€‚</p>
<p>$n^{[l]}$ï¼š$l$ å±‚çš„ç¥ç»å…ƒä¸ªæ•°ã€‚</p>
<p>å›¾ä¸­ $L&#x3D;4$ ï¼Œ$n^{[L]}&#x3D;1$ï¼Œ$n^{[1]} &#x3D; n^{[2]} &#x3D;5$ ã€‚</p>
<h4 id="4-2-å‰å‘ä¼ æ’­"><a href="#4-2-å‰å‘ä¼ æ’­" class="headerlink" title="4.2 å‰å‘ä¼ æ’­"></a>4.2 å‰å‘ä¼ æ’­</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/37.png' width="80%" height="80%"/ loading="lazy">

<p>åŸºæœ¬è¿‡ç¨‹ï¼š</p>
<ul>
<li>$z^{[l]} &#x3D; w^{[l]} a^{[l-1]} +b^{[l]}$ </li>
<li>$a^{[l]} &#x3D; g(z^{[l]})$</li>
</ul>
<p>å‘é‡åŒ–è§å›¾å³ä¸‹æ–¹ã€‚</p>
<p>åœ¨å‰å‘ä¼ æ’­çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨æ˜¾ç¤ºçš„forå¾ªç¯ï¼Œæ¥éå†ä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚ã€‚</p>
<h4 id="4-3-æ£€æŸ¥çŸ©é˜µçš„ç»´æ•°"><a href="#4-3-æ£€æŸ¥çŸ©é˜µçš„ç»´æ•°" class="headerlink" title="4.3 æ£€æŸ¥çŸ©é˜µçš„ç»´æ•°"></a>4.3 æ£€æŸ¥çŸ©é˜µçš„ç»´æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/38.png' width="80%" height="80%"/ loading="lazy">

<p>åŒæ ·æœ¬æ’åˆ—æˆä¸€åˆ—ï¼ˆå¦‚ $(x_1,x_2)^T$ã€$(z_1,z_2)^T$ï¼‰ï¼Œä¸åŒçš„æ ·æœ¬mçºµå‘ç»„åˆèµ·æ¥ï¼ˆå¦‚ $(A[0],A[1])$ã€$(Z[1],Z[2])$ï¼‰ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/39.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨å‘é‡åŒ–çš„åœºåˆï¼Œpythonçš„broadcastingæœºåˆ¶æŠŠ $b[1]$ ç»´åº¦ $(n^{[1]},1)$ æ‰©å±•æˆ $(n^{[1]},m)$ã€‚</p>
<h4 id="4-4-ä¸ºä»€ä¹ˆä½¿ç”¨æ·±å±‚è¡¨ç¤ºï¼Ÿ"><a href="#4-4-ä¸ºä»€ä¹ˆä½¿ç”¨æ·±å±‚è¡¨ç¤ºï¼Ÿ" class="headerlink" title="4.4 ä¸ºä»€ä¹ˆä½¿ç”¨æ·±å±‚è¡¨ç¤ºï¼Ÿ"></a>4.4 ä¸ºä»€ä¹ˆä½¿ç”¨æ·±å±‚è¡¨ç¤ºï¼Ÿ</h4><p>ç¥ç»ç½‘ç»œå¯ä»¥ä¸ç”¨å¾ˆå¤§ï¼Œä½†æ·±å±‚æœ‰å¥½å¤„ã€‚</p>
<p>åœ¨ç›´è§‰å±‚é¢ç†è§£ï¼Œæ·±å±‚ç¥ç»ç½‘ç»œèƒ½ç»„åˆä»ç®€å•åˆ°å¤æ‚çš„ä¿¡æ¯ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/40.png' width="80%" height="80%"/ loading="lazy">



<p>å¦ä¸€ç§ç›´è§‰ç†è§£ï¼Œä»ç”µè·¯è§’åº¦ï¼Œç”¨å°è§„æ¨¡ä½†æ·±å±‚çš„ç”µè·¯ç»“æ„ï¼Œå¯ä»¥è¿›è¡Œå¤æ‚çš„è®¡ç®—ï¼›ä½†ç”¨æµ…å±‚çš„ç”µè·¯æ¨¡å‹ï¼Œè¦ç”¨æŒ‡æ•°çº§å¢é•¿çš„è¿ç®—å•å…ƒæ‰èƒ½å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/41.png' width="80%" height="80%"/ loading="lazy">



<h4 id="4-5-æ­å»ºæ·±å±‚ç¥ç»ç½‘ç»œå—"><a href="#4-5-æ­å»ºæ·±å±‚ç¥ç»ç½‘ç»œå—" class="headerlink" title="4.5 æ­å»ºæ·±å±‚ç¥ç»ç½‘ç»œå—"></a>4.5 æ­å»ºæ·±å±‚ç¥ç»ç½‘ç»œå—</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/42.png' width="80%" height="80%"/ loading="lazy">

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/43.png' width="80%" height="80%"/ loading="lazy">



<h4 id="4-6-å‰å‘å’Œåå‘ä¼ æ’­"><a href="#4-6-å‰å‘å’Œåå‘ä¼ æ’­" class="headerlink" title="4.6 å‰å‘å’Œåå‘ä¼ æ’­"></a>4.6 å‰å‘å’Œåå‘ä¼ æ’­</h4><p>å‰å‘ä¼ æ’­çš„å®ç°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/44.png' width="80%" height="80%"/ loading="lazy">

<p>åå‘ä¼ æ’­çš„å®ç°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/45.png' width="80%" height="80%"/ loading="lazy">



<h4 id="4-7-å‚æ•°VSè¶…å‚æ•°ï¼ˆParameters-vs-Hyperparametersï¼‰"><a href="#4-7-å‚æ•°VSè¶…å‚æ•°ï¼ˆParameters-vs-Hyperparametersï¼‰" class="headerlink" title="4.7 å‚æ•°VSè¶…å‚æ•°ï¼ˆParameters vs Hyperparametersï¼‰"></a>4.7 å‚æ•°VSè¶…å‚æ•°ï¼ˆParameters vs Hyperparametersï¼‰</h4><p>Parameters: W, b</p>
<p>Hyperparameters:</p>
<ul>
<li>learning rate(Î±), #iterations, #hidden layers(L), #hidden units(n), choice of activation function.</li>
<li>momentum, mini-batch size, regularization parameters, â€¦</li>
</ul>
<p>å°è¯•ä¸åŒçš„è¶…å‚æ•°å€¼ï¼Œæ‰¾åˆ°åˆé€‚çš„å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/46.png' width="80%" height="80%"/ loading="lazy">



<h4 id="4-8-æ·±åº¦å­¦ä¹ å’Œäººç±»å¤§è„‘çš„å…³è”æ€§"><a href="#4-8-æ·±åº¦å­¦ä¹ å’Œäººç±»å¤§è„‘çš„å…³è”æ€§" class="headerlink" title="4.8 æ·±åº¦å­¦ä¹ å’Œäººç±»å¤§è„‘çš„å…³è”æ€§"></a>4.8 æ·±åº¦å­¦ä¹ å’Œäººç±»å¤§è„‘çš„å…³è”æ€§</h4><p>ç›®å‰å¯¹äººè„‘çš„è®¤è¯†æ²¡æœ‰è¾¾åˆ°å»ºç«‹æ•°å­¦æ¨¡å‹çš„ç¨‹åº¦ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/47.png' width="80%" height="80%"/ loading="lazy">







<h2 id="ç¬¬äºŒè¯¾-æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œï¼šè¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–-Improving-Deep-Neural-Networks-Hyperparameter-tuning-Regularization-and-Optimization"><a href="#ç¬¬äºŒè¯¾-æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œï¼šè¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–-Improving-Deep-Neural-Networks-Hyperparameter-tuning-Regularization-and-Optimization" class="headerlink" title="ç¬¬äºŒè¯¾ æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œï¼šè¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–(Improving Deep Neural Networks : Hyperparameter tuning, Regularization and Optimization)"></a>ç¬¬äºŒè¯¾ æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œï¼šè¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–(Improving Deep Neural Networks : Hyperparameter tuning, Regularization and Optimization)</h2><h3 id="ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢"><a href="#ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢" class="headerlink" title="ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢"></a>ç¬¬ä¸€å‘¨ï¼šæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢</h3><blockquote>
<p>æ·±åº¦å­¦ä¹ çš„åº”ç”¨æ–¹æ³•ã€‚æ•°æ®é›†çš„åˆ’åˆ†ï¼›åå·®&#x2F;æ–¹å·®ï¼›é€šè¿‡æ­£åˆ™åŒ–æ¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ˆåŒ…æ‹¬L1L2ï¼Œdropoutï¼Œå…¶ä»–æ–¹æ³•å¦‚æ•°æ®å¢å¼ºå’Œæå‰åœæ­¢ï¼‰ï¼›è¾“å…¥å½’ä¸€åŒ–ï¼›é€šè¿‡åˆç†çš„æƒé‡åˆå§‹åŒ–æ¥é¿å…æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼›è¿›è¡Œæ¢¯åº¦æ£€éªŒç¡®ä¿æ¢¯åº¦ä¸‹é™ç®—æ³•æ­£ç¡®è¿è¡Œã€‚æœ€åä¸€èŠ‚è®²äº†ä»¥ä¸Šæ–¹æ³•çš„å®è·µç»éªŒã€‚</p>
</blockquote>
<h4 id="1-1-è®­ç»ƒ-x2F-éªŒè¯-x2F-æµ‹è¯•é›†ï¼ˆTrain-x2F-Dev-x2F-Test-setsï¼‰"><a href="#1-1-è®­ç»ƒ-x2F-éªŒè¯-x2F-æµ‹è¯•é›†ï¼ˆTrain-x2F-Dev-x2F-Test-setsï¼‰" class="headerlink" title="1.1 è®­ç»ƒ&#x2F;éªŒè¯&#x2F;æµ‹è¯•é›†ï¼ˆTrain &#x2F; Dev &#x2F; Test setsï¼‰"></a>1.1 è®­ç»ƒ&#x2F;éªŒè¯&#x2F;æµ‹è¯•é›†ï¼ˆTrain &#x2F; Dev &#x2F; Test setsï¼‰</h4><p>åœ¨è®­ç»ƒé›†è¿›è¡Œè®­ç»ƒï¼Œæ ¹æ®åœ¨éªŒè¯é›†ä¸Šçš„å¾—åˆ†é€‰æ‹©æœ€å¥½çš„æ¨¡å‹ï¼Œåœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè¯„ä¼°ã€‚</p>
<p>åœ¨æ•°æ®é›†å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æŠŠéªŒè¯é›†ã€æµ‹è¯•é›†åˆ’åˆ†å¾—å°‘ä¸€ç‚¹ã€‚åœ¨ç™¾ä¸‡æ¡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œç”šè‡³å¯ä»¥åˆ’åˆ†99.5%&#x2F;0.25%&#x2F;0.25%ã€‚</p>
<ul>
<li><p>æ³¨æ„1ï¼š<strong>ä¿è¯éªŒè¯é›†å’Œæµ‹è¯•é›†çš„æ•°æ®æ¥è‡ªåŒä¸€åˆ†å¸ƒ</strong>ã€‚</p>
<p>å¦‚ï¼šè®­ç»ƒé›†æ˜¯ç½‘ç«™ä¸Šæ¯”è¾ƒç²¾ç¾ã€æ¸…æ™°çš„å›¾ç‰‡ï¼›éªŒè¯é›†ã€è®­ç»ƒé›†æ˜¯ç”¨æˆ·éšæ‰‹æ‹çš„å›¾ç‰‡ã€‚</p>
</li>
<li><p>æ³¨æ„2ï¼šä¸åšæµ‹è¯•é›†ä¹Ÿå¯ä»¥ã€‚å¦‚æœä¸éœ€è¦å¯¹æœ€ç»ˆçš„ç¥ç»ç½‘ç»œåšæ— åè¯„ä¼°ï¼Œä¹Ÿå¯ä»¥ä¸è®¾ç½®æµ‹è¯•é›†ã€‚</p>
</li>
</ul>
<h4 id="1-2-åå·®-x2F-æ–¹å·®ï¼ˆBias-x2F-Varianceï¼‰"><a href="#1-2-åå·®-x2F-æ–¹å·®ï¼ˆBias-x2F-Varianceï¼‰" class="headerlink" title="1.2 åå·®&#x2F;æ–¹å·®ï¼ˆBias &#x2F;Varianceï¼‰"></a>1.2 åå·®&#x2F;æ–¹å·®ï¼ˆBias &#x2F;Varianceï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/48.png' width="80%" height="80%"/ loading="lazy">

<p>å‰æï¼šåŸºæœ¬errorå¾ˆä½ï¼›éªŒè¯é›†å’Œæµ‹è¯•é›†æ¥è‡ªåŒä¸€åˆ†å¸ƒã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/49.png' width="80%" height="80%"/ loading="lazy">

<p>è®­ç»ƒé›†çš„errorè¦è·ŸåŸºæœ¬erroræ¯”ï¼ŒåŸºæœ¬erroré€šå¸¸æ˜¯äººå·¥è¯†åˆ«çš„errorã€‚</p>
<h4 id="1-3-å…ˆåé¡ºåº"><a href="#1-3-å…ˆåé¡ºåº" class="headerlink" title="1.3 å…ˆåé¡ºåº"></a>1.3 å…ˆåé¡ºåº</h4><p>æŒ‰æ­¥éª¤ç¡®è®¤ï¼š</p>
<ol>
<li><p>high biasï¼Ÿ å¢å¤§ç½‘ç»œè§„æ¨¡ã€è®­ç»ƒæ›´é•¿æ—¶é—´ã€ï¼ˆä¿®æ”¹ç½‘ç»œç»“æ„ï¼‰</p>
</li>
<li><p>high varianceï¼Ÿ è·å¾—æ›´å¤šæ•°æ®ã€æ­£åˆ™åŒ–ã€ï¼ˆä¿®æ”¹ç½‘ç»œç»“æ„ï¼‰</p>
</li>
<li><p>å®Œæˆï¼Œè·å¾— low bias &amp; variance çš„æ¨¡å‹ã€‚</p>
</li>
</ol>
<p>åœ¨ç°åœ¨æ·±åº¦å­¦ä¹ ã€å¤§æ•°æ®çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥åšåˆ°åœ¨å‡å°biasæˆ–varianceçš„è¿‡ç¨‹ä¸­ï¼Œä¸å¯¹å¦ä¸€æ–¹äº§ç”Ÿè¿‡å¤šä¸è‰¯å½±å“ã€‚æˆ‘ä»¬ä¸ç”¨å¤ªè¿‡å…³æ³¨å¦‚ä½• tradeoffã€‚</p>
<h4 id="1-4-æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰"><a href="#1-4-æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰" class="headerlink" title="1.4 æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰"></a>1.4 æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</h4><p>é€»è¾‘å›å½’çš„æ­£åˆ™åŒ–ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/50.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœç”¨çš„æ˜¯L1æ­£åˆ™åŒ–ï¼ŒWæœ€ç»ˆä¼šæ˜¯ç¨€ç–çš„ï¼Œä¹Ÿå°±æ˜¯Wå‘é‡ä¸­æœ‰å¾ˆå¤š0ã€‚</p>
<p>ç°åœ¨æ›´å€¾å‘äºL2æ­£åˆ™åŒ–ã€‚</p>
<p>$\lambda$ ä¹Ÿæ˜¯ä¸€ä¸ªéœ€è¦è°ƒæ•´çš„è¶…å‚æ•°ã€‚ä¸ºäº†é˜²æ­¢ä¸pythonçš„å…³é”®å­—é‡å¤ï¼Œåœ¨ä»£ç ä¸­ä¸€èˆ¬å†™ä½œlambdã€‚ </p>
<p>ç¥ç»ç½‘ç»œçš„æ­£åˆ™åŒ–ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/51.png' width="80%" height="80%"/ loading="lazy">

<p>ç”±äºå†å²åŸå› ï¼Œä¸å«çŸ©é˜µçš„L2æ­£åˆ™åŒ–ï¼Œè€Œæ˜¯å« frobenius normã€‚</p>
<p>åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œæ­£åˆ™åŒ–é¡¹æ±‚å¯¼ååŠ åœ¨ $dW$ çš„åé¢ï¼Œè®©æ¢¯åº¦ä¸‹é™çš„å¹…åº¦å¤§ä¸€äº›ã€‚ä¹Ÿè¢«ç§°ä¸º weight decay ã€‚</p>
<h4 id="1-5-ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æœ‰åˆ©äºé¢„é˜²è¿‡æ‹Ÿåˆå‘¢ï¼Ÿ"><a href="#1-5-ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æœ‰åˆ©äºé¢„é˜²è¿‡æ‹Ÿåˆå‘¢ï¼Ÿ" class="headerlink" title="1.5 ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æœ‰åˆ©äºé¢„é˜²è¿‡æ‹Ÿåˆå‘¢ï¼Ÿ"></a>1.5 ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æœ‰åˆ©äºé¢„é˜²è¿‡æ‹Ÿåˆå‘¢ï¼Ÿ</h4><p>ä»ç›´è§‚ä¸Šç†è§£ï¼Œæ­£åˆ™åŒ–é¡¹é™ä½äº† $W$ çš„å€¼ï¼Œä¹Ÿå°±æ˜¯é™ä½äº†ä¸€äº›ç¥ç»å…ƒçš„ä½œç”¨ï¼Œç®€åŒ–äº†æ¨¡å‹ï¼Œè®©æ¨¡å‹ä»è¿‡æ‹Ÿåˆå‘æ¬ æ‹Ÿåˆå‘å±•ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/52.png' width="80%" height="80%"/ loading="lazy">



<p>ç¬¬äºŒç§ç›´è§‚ç†è§£æ–¹æ³•ï¼š$W$ å€¼å˜å°ï¼Œ$z$ é›†ä¸­åœ¨æ¿€æ´»å‡½æ•°çš„çº¿æ€§éƒ¨åˆ†ï¼Œåˆ™æ¨¡å‹çš„æ¯ä¸€å±‚éƒ½ç›¸å½“äºçº¿æ€§å˜æ¢ï¼Œæ¨¡å‹ä¸é€‚ç”¨äºå¤æ‚çš„å†³ç­–ï¼Œé™ä½äº†è¿‡æ‹Ÿåˆç¨‹åº¦ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/53.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœå®æ–½äº†å¸¦æ­£åˆ™åŒ–é¡¹çš„æŸå¤±å‡½æ•°ï¼Œå½“ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ—¶ï¼Œä¸ºäº†è°ƒè¯•æ¢¯åº¦ä¸‹é™ï¼Œè¦ä½¿ç”¨è¿™ä¸ªæ–°å®šä¹‰çš„æŸå¤±å‡½æ•°ï¼Œå¦åˆ™æŸå¤±å‡½æ•°å¯èƒ½ä¸ä¼šå†æ‰€æœ‰çš„è°ƒå¹…èŒƒå›´å†…éƒ½å•è°ƒé€’å‡ã€‚</p>
<h4 id="1-6-dropout-æ­£åˆ™åŒ–"><a href="#1-6-dropout-æ­£åˆ™åŒ–" class="headerlink" title="1.6 dropout æ­£åˆ™åŒ–"></a>1.6 dropout æ­£åˆ™åŒ–</h4><p>å¯¹æ¯ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œéå†ç¥ç»ç½‘ç»œçš„æ¯ä¸€å±‚ï¼Œå¹¶è®¾ç½®æ¶ˆé™¤ç¥ç»ç½‘ç»œä¸­èŠ‚ç‚¹çš„æ¦‚ç‡ï¼Œæ¶ˆé™¤ä¸€äº›èŠ‚ç‚¹ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´å°è§„æ¨¡çš„ç¥ç»ç½‘ç»œï¼Œè®­ç»ƒè¿™ä¸ªç²¾ç®€åçš„ç½‘ç»œã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/54.png' width="80%" height="80%"/ loading="lazy">

<p> ä¸€ç§å®ç°æ–¹æ³•ï¼šinverted dropoutï¼ˆåå‘éšæœºå¤±æ´»ï¼‰</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/55.png' width="80%" height="80%"/ loading="lazy">

<p>ç”¨ä¸ç­‰å¼ç»™dèµ‹å€¼ä¸ºtrueæˆ–falseï¼Œè·Ÿaç›¸ä¹˜è®©açš„ä¸€éƒ¨åˆ†å€¼å¤±æ•ˆã€‚</p>
<p>æœ‰ä¸€ä¸ª <code>a/=deep_prob</code> æ“ä½œï¼Œ ä¿®æ­£æˆ–å¼¥è¡¥ä¸¢æ‰çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè®©açš„æœŸæœ›å€¼ä¸å˜ã€‚</p>
<p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œä¸ä½¿ç”¨dropoutã€‚</p>
<h4 id="1-7-ç†è§£-dropout"><a href="#1-7-ç†è§£-dropout" class="headerlink" title="1.7 ç†è§£ dropout"></a>1.7 ç†è§£ dropout</h4><p>ç›´è§‚ä¸Šç†è§£ï¼Œdropoutè®©ç¥ç»å…ƒä¸ä¾èµ–äºæŸä¸€ä¸ªç‰¹å¾ï¼Œè€Œè®©æƒé‡æ›´åŠ åˆ†æ•£ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/56.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœæ›´æ‹…å¿ƒåœ¨æŸäº›å±‚æœ‰è¿‡æ‹Ÿåˆï¼Œå°±æŠŠæŸäº›å±‚çš„keep-probè®¾ç½®å¾—ä½ä¸€äº›ã€‚ç¼ºç‚¹æ˜¯åœ¨éªŒè¯é›†ä¸Šè°ƒå‚å·¥ä½œé‡å¢å¤§ã€‚</p>
<p>dropoutæœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ­£åˆ™åŒ–æ–¹æ³•ï¼Œç”¨æ¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚åœ¨è®¡ç®—æœºè§†è§‰é—®é¢˜ä¸­ï¼Œè¾“å…¥çš„åƒç´ å¾ˆå¤šï¼Œä»¥è‡³äºæ²¡æœ‰è¶³å¤Ÿçš„æ•°æ®ï¼Œç»å¸¸ä¸€ç›´å¤„äºè¿‡æ‹Ÿåˆæƒ…å†µã€‚å› æ­¤dropoutåœ¨CVåº”ç”¨çš„æ¯”è¾ƒé¢‘ç¹ã€‚åœ¨å…¶ä»–é¢†åŸŸï¼Œå¦‚æœæ²¡æœ‰è¿‡æ‹Ÿåˆé—®é¢˜å°±ä¸å¿…ä½¿ç”¨ã€‚</p>
<p>dropoutä¸€å¤§ç¼ºç‚¹å°±æ˜¯ä»£ä»·å‡½æ•° $J$ ä¸å†è¢«æ˜ç¡®å®šä¹‰ã€‚æ¯æ¬¡è¿­ä»£éƒ½éšæœºä¿ç•™ç¥ç»å…ƒï¼Œå¾ˆéš¾å¯¹æ¯æ¬¡çš„åå‘ä¼ æ’­æ¢¯åº¦ä¸‹é™è¿›è¡Œå¤æŸ¥ã€‚ä¹Ÿå°±å¤±å»äº†ç»˜åˆ¶é€’å‡çš„ä»£ä»·å‡½æ•°å›¾åƒçš„å·¥å…·ã€‚é€šå¸¸å…ˆå…³é—­dropoutï¼Œè¿è¡Œä»£ç ç¡®ä¿ä»£ä»·å‡½æ•°å•è°ƒé€’å‡ï¼Œå†å¼€å¯dropoutã€‚</p>
<h4 id="1-8-å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•"><a href="#1-8-å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•" class="headerlink" title="1.8 å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•"></a>1.8 å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•</h4><p>data augment</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/57.png' width="80%" height="80%"/ loading="lazy">



<p>early stopping</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/58.png' width="80%" height="80%"/ loading="lazy">

<p>å»ºç«‹æ¨¡å‹çš„ä¸¤ä¸ªè¿‡ç¨‹ï¼šå…¶ä¸€æ˜¯è®© $J(w, b)$ å–åˆ°æœ€å°å€¼ï¼Œæ‰‹æ®µåŒ…æ‹¬æ¢¯åº¦ä¸‹é™ç­‰ï¼›å…¶äºŒæ˜¯é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œåˆç§°ä¸ºorthogonalizationï¼Œæ‰‹æ®µåŒ…æ‹¬æ­£åˆ™åŒ–ç­‰ã€‚early stopping çš„ç¼ºç‚¹æ˜¯ç ´åäº†è¿™ä¸¤ä¸ªè¿‡ç¨‹ç›¸äº’çš„ç‹¬ç«‹æ€§ã€‚æå‰ç»“æŸè®­ç»ƒè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰“æ–­äº†ç¬¬ä¸€ä¸ªè¿‡ç¨‹ã€‚</p>
<p>å¦‚æœä½¿ç”¨L2æ­£åˆ™åŒ–ï¼Œå°±é¿å…äº†è¿™ä¸ªç¼ºç‚¹ï¼Œéšä¹‹è€Œæ¥çš„æ˜¯ $\lambda$ çš„è°ƒå‚å·¥ä½œé‡ï¼Œè€Œä¸æ˜¯åªè¿›è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™å°±å¯ä»¥æ‰¾åˆ°early stoppingçš„ä½ç½®ã€‚</p>
<h4 id="1-9-å½’ä¸€åŒ–è¾“å…¥ï¼ˆNormalizing-inputsï¼‰"><a href="#1-9-å½’ä¸€åŒ–è¾“å…¥ï¼ˆNormalizing-inputsï¼‰" class="headerlink" title="1.9 å½’ä¸€åŒ–è¾“å…¥ï¼ˆNormalizing inputsï¼‰"></a>1.9 å½’ä¸€åŒ–è¾“å…¥ï¼ˆNormalizing inputsï¼‰</h4><p>ç¬¬ä¸€æ­¥ï¼šé›¶å‡å€¼åŒ–ï¼›ç¬¬äºŒæ­¥ï¼šæ–¹å·®å½’ä¸€åŒ–ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/59.png' width="80%" height="80%"/ loading="lazy">

<p>æ³¨æ„ï¼šåœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šè¦ç”¨ç›¸åŒçš„ $\mu,\sigma$ ã€‚</p>
<p>è¿™æ ·åšçš„åŸå› ï¼šè®©ä¼˜åŒ–å˜å¿«ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/60.png' width="80%" height="80%"/ loading="lazy">



<h4 id="1-10-æ¢¯åº¦æ¶ˆå¤±-x2F-æ¢¯åº¦çˆ†ç‚¸ï¼ˆVanishing-x2F-Exploding-gradientsï¼‰"><a href="#1-10-æ¢¯åº¦æ¶ˆå¤±-x2F-æ¢¯åº¦çˆ†ç‚¸ï¼ˆVanishing-x2F-Exploding-gradientsï¼‰" class="headerlink" title="1.10 æ¢¯åº¦æ¶ˆå¤±&#x2F;æ¢¯åº¦çˆ†ç‚¸ï¼ˆVanishing &#x2F; Exploding gradientsï¼‰"></a>1.10 æ¢¯åº¦æ¶ˆå¤±&#x2F;æ¢¯åº¦çˆ†ç‚¸ï¼ˆVanishing &#x2F; Exploding gradientsï¼‰</h4><p>activationsä»¥æŒ‡æ•°çº§å¢é•¿æˆ–ä¸‹é™ï¼Œç»™æ¢¯åº¦ä¸‹é™é€ æˆå›°éš¾ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/61.png' width="80%" height="80%"/ loading="lazy">

<p>ä»¥å›¾ä¸­ç®€åŒ– $b$ ã€$w$ å…¨éƒ¨æ˜¯å¯¹è§’çŸ©é˜µçš„ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼š$w$ æ¯”å•ä½çŸ©é˜µå¤§ä¸€ç‚¹ï¼Œæ¿€æ´»å€¼ä»¥æŒ‡æ•°çº§å¢é•¿ï¼›w æ¯”å•ä½çŸ©é˜µå°ä¸€ç‚¹ï¼Œæ¿€æ´»å€¼ä»¥æŒ‡æ•°çº§å‡å°ã€‚</p>
<h4 id="1-11-ç¥ç»ç½‘ç»œçš„æƒé‡åˆå§‹åŒ–"><a href="#1-11-ç¥ç»ç½‘ç»œçš„æƒé‡åˆå§‹åŒ–" class="headerlink" title="1.11 ç¥ç»ç½‘ç»œçš„æƒé‡åˆå§‹åŒ–"></a>1.11 ç¥ç»ç½‘ç»œçš„æƒé‡åˆå§‹åŒ–</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/62.png' width="80%" height="80%"/ loading="lazy">

<p>é€šè¿‡ç»™ $W$ è®¾ç½®åˆç†çš„åˆå§‹å€¼ï¼ˆä¸èƒ½æ¯”1å¤§&#x2F;å°å¤ªå¤šï¼‰ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<p>ä»¥å›¾ä¸­å»æ‰ $b$ çš„å•ä¸ªç¥ç»å…ƒä¸ºä¾‹ï¼Œæœ€åˆç†çš„æ–¹å¼æ˜¯è®¾ç½® $w$ æ¥è¿‘ $\frac{1}{n}$ ã€‚</p>
<p>å› æ­¤è¿›è¡Œè¿™æ ·çš„åˆå§‹åŒ–ï¼š$W^{[l]} &#x3D; np.random.randn(shape)*np.sqrt(\frac{2}{n^{[l-1]]}})$</p>
<p>å½“ç”¨ReLUå‡½æ•°ï¼Œæ˜¯ $\sqrt{\frac{2}{n^{[l-1]]}}}$ ï¼›å½“ç”¨tanhå‡½æ•°ï¼Œæ˜¯ $\sqrt{\frac{1}{n^{[l-1]]}}}$ï¼›ä¹Ÿæœ‰äººç”¨ $\sqrt{\frac{2}{n^{[l-1]]}+n^{[l]}}}$ ã€‚</p>
<h4 id="1-12-æ¢¯åº¦çš„æ•°å€¼è¿‘ä¼¼"><a href="#1-12-æ¢¯åº¦çš„æ•°å€¼è¿‘ä¼¼" class="headerlink" title="1.12 æ¢¯åº¦çš„æ•°å€¼è¿‘ä¼¼"></a>1.12 æ¢¯åº¦çš„æ•°å€¼è¿‘ä¼¼</h4><p>åœ¨å®æ–½åå‘ä¼ æ’­æ—¶ï¼Œè¿›è¡Œgradient checkingï¼Œå¯ä»¥ç¡®ä¿åå‘ä¼ æ’­æ­£åœ¨æ­£ç¡®è¿›è¡Œã€‚</p>
<p>ç”¨ $\frac{f(\theta+\epsilon)-f(\theta-\epsilon)}{2\epsilon}\approx g(\theta)$ è¿‘ä¼¼è®¡ç®— $\theta$ çš„æ¢¯åº¦ $g(\theta)$ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/63.png' width="80%" height="80%"/ loading="lazy">



<h4 id="1-13-æ¢¯åº¦æ£€éªŒï¼ˆGradient-checkingï¼‰"><a href="#1-13-æ¢¯åº¦æ£€éªŒï¼ˆGradient-checkingï¼‰" class="headerlink" title="1.13 æ¢¯åº¦æ£€éªŒï¼ˆGradient checkingï¼‰"></a>1.13 æ¢¯åº¦æ£€éªŒï¼ˆGradient checkingï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/64.png' width="80%" height="80%"/ loading="lazy">

<p>æŠŠæ‰€æœ‰å±‚çš„$w,b$ ç»„åˆæˆçŸ©é˜µ $\theta$ï¼Œæ‰€æœ‰å±‚çš„$dW,db$ ç»„åˆæˆçŸ©é˜µ $d\theta$ ã€‚æˆ‘ä»¬éœ€è¦éªŒè¯ï¼š$d\theta$ æ˜¯ $\theta$ çš„æ¢¯åº¦ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/65.png' width="80%" height="80%"/ loading="lazy">

<p>è®¡ç®—è¿‘ä¼¼æ¢¯åº¦ï¼š</p>
<p>$$ d\theta_{approx}[i] &#x3D;\frac{J(\theta_1, \theta_2,â€¦,\theta_i+\epsilon,â€¦)-J(\theta_1, \theta_2,â€¦,\theta_i-\epsilon,â€¦)}{2\epsilon} \approx d\theta[i] &#x3D; \frac{\partial J}{\partial \theta_i}$$</p>
<p>$$check: \frac{||d\theta_{approx}-d\theta||_2}{||d\theta_{approx}||_2+||d\theta||_2} \approx 10^{-7}$$</p>
<p>å¦‚æœ $\approx10^{-5}$ï¼Œæ£€æŸ¥å‘é‡ï¼Œç¡®ä¿æ²¡æœ‰ä¸€é¡¹è¯¯å·®è¿‡å¤§ï¼Œç¡®ä¿æ²¡æœ‰bugï¼›å¦‚æœ $\approx10^{-3}$ï¼Œéœ€è¦å°å¿ƒæœ‰bugã€‚å¯ä»¥æ£€æŸ¥å“ªä¸€é¡¹çš„å¯¼æ•°è®¡ç®—ç»“æœå’Œä¼°è®¡å€¼åå·®å¾ˆå¤§ï¼Œå¹¶åæ¨æ±‚å¯¼è¿‡ç¨‹ï¼Œæ£€æŸ¥bugã€‚</p>
<h4 id="1-14-åº”ç”¨æ¢¯åº¦æ£€éªŒçš„æ³¨æ„äº‹é¡¹"><a href="#1-14-åº”ç”¨æ¢¯åº¦æ£€éªŒçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="1.14 åº”ç”¨æ¢¯åº¦æ£€éªŒçš„æ³¨æ„äº‹é¡¹"></a>1.14 åº”ç”¨æ¢¯åº¦æ£€éªŒçš„æ³¨æ„äº‹é¡¹</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/65-add.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li>ä¸è¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨æ¢¯åº¦æ£€éªŒï¼Œåªç”¨äºè°ƒè¯•ã€‚</li>
<li>å¦‚æœæ¢¯åº¦æ£€éªŒå¤±è´¥ï¼Œæ£€æŸ¥å“ªä¸€é¡¹çš„å¯¼æ•°è®¡ç®—ç»“æœå’Œä¼°è®¡å€¼åå·®å¾ˆå¤§ï¼Œç¡®å®šbugä½ç½®ï¼Œæ¯”å¦‚åœ¨æŸä¸€å±‚çš„æ±‚å¯¼ç»“æœè·Ÿä¼°è®¡å€¼å·®å¾ˆå¤§ã€‚</li>
<li>æ¢¯åº¦æ£€éªŒçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†æ­£åˆ™åŒ–ï¼Œè¦è®°ä½è®¡ç®—ä¸­åº”åŒ…æ‹¬æ­£åˆ™åŒ–é¡¹ã€‚</li>
<li><strong>æ¢¯åº¦æ£€éªŒä¸èƒ½ä¸dropoutä¸€èµ·ä½¿ç”¨</strong>ã€‚dropoutè®©æˆ‘ä»¬éš¾ä»¥è®¡ç®— $J$ ã€‚å¯ä»¥å…ˆæŠŠ keep_prob è®¾ç½®ä¸º1ï¼ŒéªŒè¯æ¢¯åº¦ä¸‹é™æ˜¯æ­£ç¡®çš„ï¼›å†å¼€å¯dropout.</li>
<li>å‡ ä¹ä¸ä¼šå‡ºç°çš„æƒ…å†µï¼šéšæœºåˆå§‹åŒ– $w,b$ æ¥è¿‘0ï¼Œæ¢¯åº¦ä¸‹é™çš„å®æ–½æ˜¯æ­£ç¡®çš„ï¼Œä½†åœ¨è¿è¡Œæ¢¯åº¦ä¸‹é™æ—¶ï¼Œ$w,b$ å˜å¤§ï¼Œå¯èƒ½åªæœ‰åœ¨ $w,b$ æ¥è¿‘0æ—¶ï¼Œæ¢¯åº¦ä¸‹é™æ‰æ˜¯æ­£ç¡®çš„ï¼Œä½† $w,b$ å˜å¤§æ—¶å®ƒå˜å¾—è¶Šæ¥è¶Šä¸å‡†ç¡®ã€‚åšæ³•ï¼ˆåŸºæœ¬ä¸ç”¨ï¼‰ï¼šåœ¨éšæœºåˆå§‹åŒ–è¿‡ç¨‹ä¸­è¿›è¡Œæ¢¯åº¦æ£€éªŒï¼Œç„¶åå†è®­ç»ƒç½‘ç»œï¼Œå¦‚æœéšæœºåˆå§‹åŒ–å€¼æ¯”è¾ƒå°ï¼Œ$w,b$ ä¼šæœ‰ä¸€æ®µæ—¶é—´è¿œç¦»0 ï¼›åå¤è®­ç»ƒç½‘ç»œä¹‹åå†é‡æ–°è¿›è¡Œæ¢¯åº¦æ£€éªŒã€‚ï¼ˆå¼€å§‹åšä¸€ä¸‹æ¢¯åº¦æ£€éªŒï¼Œè®­ç»ƒåå†è¿›è¡Œä¸€æ¬¡æ¢¯åº¦æ£€éªŒï¼Œä¿è¯æ­£ç¡®ã€‚ï¼‰</li>
</ul>
<h3 id="ç¬¬äºŒå‘¨ï¼šä¼˜åŒ–ç®—æ³•-Optimization-algorithms"><a href="#ç¬¬äºŒå‘¨ï¼šä¼˜åŒ–ç®—æ³•-Optimization-algorithms" class="headerlink" title="ç¬¬äºŒå‘¨ï¼šä¼˜åŒ–ç®—æ³• (Optimization algorithms)"></a>ç¬¬äºŒå‘¨ï¼šä¼˜åŒ–ç®—æ³• (Optimization algorithms)</h3><p>è®©æ¢¯åº¦ä¸‹é™åŠ é€Ÿçš„ä¼˜åŒ–æ–¹æ³•ã€‚åŒ…æ‹¬mini-batchæ¢¯åº¦ä¸‹é™ã€momentum&#x2F;RMSprop&#x2F;Adamç®—æ³•ï¼ˆå’Œéœ€è¦äº†è§£çš„æŒ‡æ•°åŠ æƒå¹³å‡ã€åå·®ä¿®æ­£åŸºç¡€ï¼‰ã€å­¦ä¹ ç‡è¡°å‡ã€‚æœ€åä¸€èŠ‚è®²äº†å±€éƒ¨æœ€ä¼˜é—®é¢˜ã€‚</p>
<h4 id="2-1-Mini-batch-æ¢¯åº¦ä¸‹é™"><a href="#2-1-Mini-batch-æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.1 Mini-batch æ¢¯åº¦ä¸‹é™"></a>2.1 Mini-batch æ¢¯åº¦ä¸‹é™</h4><p>batchæ¢¯åº¦ä¸‹é™ï¼šåœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šè¿›è¡Œæ¢¯åº¦ä¸‹é™ã€‚</p>
<p>mini-batchæ¢¯åº¦ä¸‹é™ï¼šæŠŠæ•´ä¸ªæ•°æ®é›†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªmini-batchï¼Œåœ¨æ¯ä¸ªmini-batchä¸Šè¿›è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ã€‚</p>
<p>å®ç°è¿‡ç¨‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/66.png' width="80%" height="80%"/ loading="lazy">

<p>å‰å‘ä¼ æ’­ã€æ±‚å¹³å‡æŸå¤± â€“&gt; åå‘ä¼ æ’­ã€æ¢¯åº¦ä¸‹é™ã€‚åœ¨æ¯ä¸ªmini-batchä¸­è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚</p>
<p>å®Œæ•´çš„éå†ä¸€æ¬¡è®­ç»ƒé›†ç§°ä¸º 1 epochã€‚mini-batchå¯ä»¥åœ¨ 1 epoch ä¸­å®Œæˆå¤šæ¬¡æ¢¯åº¦ä¸‹é™ã€‚</p>
<h4 id="2-2-ç†è§£Mini-batch-æ¢¯åº¦ä¸‹é™"><a href="#2-2-ç†è§£Mini-batch-æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.2 ç†è§£Mini-batch æ¢¯åº¦ä¸‹é™"></a>2.2 ç†è§£Mini-batch æ¢¯åº¦ä¸‹é™</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/67.png' width="80%" height="80%"/ loading="lazy">

<p>mini-batchä¼šè®©æ¢¯åº¦ä¸‹é™æœ‰å™ªå£°ï¼Œä½†æœ€ç»ˆä¹Ÿä¼šæ”¶æ•›åˆ°æ¯”è¾ƒå°çš„æ°´å¹³ã€‚</p>
<p>mini-batchæ¢¯åº¦ä¸‹é™çš„ä¼˜åŠ¿ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/68.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>mini-batch size &#x3D; mï¼Œå³ batch æ¢¯åº¦ä¸‹é™ï¼šæ­¥é•¿å¤§ï¼Œå™ªå£°å°‘ã€‚å•æ¬¡è¿­ä»£è€—æ—¶é•¿ã€‚</p>
</li>
<li><p>mini-batch size &#x3D; 1ï¼Œå³ éšæœº æ¢¯åº¦ä¸‹é™ï¼šæ­¥é•¿å°ï¼Œå™ªå£°å¤šï¼Œæ°¸è¿œä¸æ”¶æ•›ï¼ˆåœ¨æœ€å°å€¼é™„è¿‘æ³¢åŠ¨ã€‚å¤±å»å‘é‡åŒ–æ–¹æ³•å¸¦æ¥çš„è®¡ç®—åŠ é€Ÿã€‚</p>
</li>
<li><p>mini-batchæ¢¯åº¦ä¸‹é™ï¼šæ—¢èƒ½å¯¹æ ·æœ¬è¿›è¡Œå‘é‡åŒ–ï¼Œåˆèƒ½å¿«é€Ÿè¿­ä»£ã€‚</p>
</li>
</ul>
<p>é€‰æ‹© mini-batch size çš„æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><p>æ ·æœ¬é›†å°ï¼ˆ&lt;2000ï¼‰ï¼Œç›´æ¥ç”¨batchæ¢¯åº¦ä¸‹é™ã€‚</p>
</li>
<li><p>ä¸€èˆ¬æŠŠ mini-batch size è®¾ç½®ä¸º2çš„æ¬¡æ–¹æ•°ã€‚</p>
</li>
<li><p>ç¡®ä¿mini-batchå†…çš„æ•°æ® $(X^,Y^)$ ç¬¦åˆ CPU&#x2F;GPU çš„å†…å­˜ã€‚</p>
</li>
<li><p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ª hyperparameter ï¼Œéœ€è¦å¤šæ¬¡å°è¯•ï¼Œæ‰¾åˆ°è®©æ¢¯åº¦ä¸‹é™æœ€é«˜æ•ˆçš„å–å€¼ã€‚</p>
</li>
</ul>
<p>è¿˜æœ‰æ¯”æ¢¯åº¦ä¸‹é™å’Œmini-batchæ¢¯åº¦ä¸‹é™éƒ½è¦é«˜æ•ˆå¾—å¤šçš„ç®—æ³•ï¼Œåœ¨åé¢è®²ã€‚</p>
<h4 id="2-3-æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially-weighted-averagesï¼‰"><a href="#2-3-æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially-weighted-averagesï¼‰" class="headerlink" title="2.3 æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially weighted averagesï¼‰"></a><span id = "2.2.3">2.3 æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially weighted averagesï¼‰</span></h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/69.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨ç»Ÿè®¡å­¦ä¸­å«æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡å€¼ã€‚</p>
<p>$$V_t &#x3D; \beta V_{t-1} + (1-\beta) \theta_t$$ </p>
<p>$V_t$ å¯ä»¥çœ‹ä½œåœ¨ $\frac{1}{1-\beta}$ å¤©ä¸­ï¼Œæ¸©åº¦$\theta$ çš„å¹³å‡å€¼ã€‚</p>
<p>é€šè¿‡è°ƒæ•´å‚æ•° $\beta$ ï¼Œè·å¾—ä¸åŒçš„æ•ˆæœã€‚</p>
<ul>
<li>$\beta$ å¤§ï¼Œå¹³å‡çš„æ ·æœ¬å¤šï¼Œæ›²çº¿å¹³æ»‘ä½†æœ‰åç§»ã€‚ï¼ˆå›¾ä¸­ç»¿è‰²çº¿æ˜¯50å¤©çš„å¹³å‡å€¼ï¼‰</li>
<li>$\beta$ å°ï¼Œå¹³å‡çš„æ ·æœ¬å°‘ï¼Œæ›²çº¿æ›´æ‹Ÿåˆï¼Œä½†å™ªå£°å¤§ã€‚ï¼ˆå›¾ä¸­é»„è‰²çº¿æ˜¯2å¤©çš„å¹³å‡å€¼ï¼Œçº¢è‰²çº¿æ˜¯10å¤©çš„å¹³å‡å€¼ï¼‰</li>
</ul>
<h4 id="2-4-ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡"><a href="#2-4-ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡" class="headerlink" title="2.4 ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡"></a>2.4 ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/70.png' width="80%" height="80%"/ loading="lazy">

<p>æŠŠç®—å¼å±•å¼€ï¼Œæ˜¯sum(æ¯å¤©çš„æ¸©åº¦Ã—æŒ‡æ•°è¡°å‡ç³»æ•°)çš„å½¢å¼ã€‚ï¼ˆå³ä¸Šæ–¹ä¸¤ä¸ªå›¾ä¸­å¯¹åº”å€¼ç›¸ä¹˜ï¼‰</p>
<p>$$V_{100} &#x3D; 0.1\times\theta_{100}+0.1\times 0.9\times\theta_{99}+0.1\times 0.9\times 0.9\times\theta_{98}+ â€¦$$</p>
<p>æ‰€æœ‰ç³»æ•°åŠ èµ·æ¥è¿‘ä¼¼ï¼1ã€‚</p>
<p>æœ‰ $(1-\epsilon)^{\frac{1}{\epsilon}}\approx \frac{1}{e}$ ï¼Œåœ¨æ­¤æ—¶æƒé‡ç³»æ•°è¡°å‡çš„ä¸‹é™å¹…åº¦å¾ˆå¤§ã€‚å› æ­¤å¯ä»¥è¿‘ä¼¼è®¤ä¸ºï¼Œä»Šå¤©çš„ $V$ çš„å€¼æ˜¯å–äº†å‰ $\frac{1}{\epsilon} &#x3D; \frac{1}{1-\beta}$ å¤©çš„å¹³å‡å€¼ã€‚å¦‚å›¾ä¸­çš„ $V$ æ˜¯å–äº† $\frac{1}{0.1}&#x3D;10$ å¤©çš„æ¸©åº¦å¹³å‡å€¼ã€‚</p>
<p>å®ç°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/71.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨å®ç°ä¸Šï¼Œåªéœ€è¦å­˜å‚¨å•ä¸ªå˜é‡ $V$ å¹¶ä¸”ä¸æ–­æ›´æ–°å³å¯ã€‚$V$ è¿‘ä¼¼äº†å¹³å‡å€¼ï¼Œçœå»äº†ä½¿ç”¨æ»‘åŠ¨çª—å£æ±‚å’Œæ±‚ç²¾ç¡®å¹³å‡å€¼æ‰€éœ€çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>åœ¨ä¹‹åçš„ç« èŠ‚ä¸­ï¼Œéœ€è¦è®¡ç®—å¤šä¸ªå˜é‡çš„å¹³å‡å€¼ï¼Œä½¿ç”¨æŒ‡æ•°åŠ æƒå¹³å‡æ˜¯ä¸€ä¸ªå¥½çš„è¿‘ä¼¼è®¡ç®—æ–¹æ³•ã€‚</p>
<h4 id="2-5-æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ï¼ˆBias-correction-in-exponentially-weighted-averageï¼‰"><a href="#2-5-æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ï¼ˆBias-correction-in-exponentially-weighted-averageï¼‰" class="headerlink" title="2.5 æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ï¼ˆBias correction in exponentially weighted averageï¼‰"></a>2.5 æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ï¼ˆBias correction in exponentially weighted averageï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/72.png' width="80%" height="80%"/ loading="lazy">

<p>ä»¥ $\beta&#x3D;0.98$ ä¸ºä¾‹ï¼Œåœ¨å®é™…å®ç°ä¸Šï¼Œä¼šå¾—åˆ°ç´«çº¿è€Œä¸æ˜¯ç»¿çº¿ã€‚ä»¥ä¸ºåˆå§‹åŒ– $V&#x3D;0$ ï¼Œå‰å‡ é¡¹ä¼šå¾ˆå°ã€‚ï¼ˆè§å·¦ä¸‹ç®—å¼ï¼‰</p>
<p>ä½¿ç”¨åå·®ä¿®æ­£ï¼Œè®©å¹³å‡å€¼è¿‘ä¼¼è®¡ç®—æ›´åŠ å‡†ç¡®ï¼šç”¨ $\frac{V_t}{1-\beta^t}$ ä»£æ›¿ $V_t$ ã€‚åœ¨åˆšå¼€å§‹ $t$ è¾ƒå°æ—¶ï¼Œ$\frac{V_t}{1-\beta^t}$ æ±‚çš„æ˜¯ $\theta$ çš„åŠ æƒå¹³å‡æ•°ï¼ˆå³ä¸‹è¡¨è¾¾å¼ï¼‰ï¼›$t$ å˜å¤§æ—¶ï¼Œ$\beta^t$ æ¥è¿‘ 0ã€‚</p>
<p>åå·®ä¿®æ­£èƒ½åœ¨æ—©æœŸè·å¾—æ›´å¥½çš„ä¼°è®¡ï¼Œä½†ä¹Ÿå¯ä»¥é€‰æ‹©ç†¬è¿‡åˆå§‹æ—¶æœŸï¼Œä¸ä½¿ç”¨åå·®ä¿®æ­£ã€‚</p>
<h4 id="2-6-momentumæ¢¯åº¦ä¸‹é™"><a href="#2-6-momentumæ¢¯åº¦ä¸‹é™" class="headerlink" title="2.6 momentumæ¢¯åº¦ä¸‹é™"></a>2.6 momentumæ¢¯åº¦ä¸‹é™</h4><p>è®¡ç®—æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ•°ï¼ŒåŠ é€Ÿæ¢¯åº¦ä¸‹é™ã€‚è¿™ä¸ªæ–¹æ³•å¥½äºæ™®é€šæ¢¯åº¦ä¸‹é™ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/73.png' width="80%" height="80%"/ loading="lazy">

<p>æ¢¯åº¦ä¸‹é™çš„æ³¢åŠ¨ï¼Œè¦æ±‚æˆ‘ä»¬ä¸èƒ½ç”¨å¾ˆå¤§çš„å­¦ä¹ ç‡ã€‚åœ¨çºµè½´ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ æ…¢ä¸€ç‚¹ï¼›åœ¨æ¨ªè½´ä¸Šï¼Œå¸Œæœ›å­¦ä¹ å¿«ä¸€ç‚¹ã€‚</p>
<p>å¹³å‡äº†è¿™äº›æ¢¯åº¦ä¹‹åï¼Œä¼šå‘ç°çºµè½´ä¸Šçš„æ‘†åŠ¨å¹³å‡å€¼æ¥è¿‘ 0ï¼ˆå›¾ä¸­çº¢ç®­å¤´ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨å¤§ä¸€äº›çš„å­¦ä¹ ç‡äº†ã€‚</p>
<p>ä¸€ä¸ªç›´è§‚ä¸Šçš„ç†è§£ï¼šå°çƒä»ç¢—çŠ¶å‡½æ•°åƒåº•éƒ¨æ»šåŠ¨ï¼Œå¾®åˆ†é¡¹ $dw,db$ æ˜¯åŠ é€Ÿåº¦ï¼Œmomentumé¡¹ $V_{dw},V_{db}$ æ˜¯é€Ÿåº¦ï¼ŒçƒåŠ é€Ÿå‘åº•éƒ¨æ»šåŠ¨ï¼Œè€Œ $\beta$ ç›¸å½“äºæ‘©æ“¦åŠ›ï¼Œè®©å°çƒä¸ä¼šæ— é™åŠ é€Ÿã€‚ä¸åƒæ¢¯åº¦ä¸‹é™æ³•æ¯ä¸€æ­¥éƒ½ç‹¬ç«‹äºä¹‹å‰çš„æ­¥éª¤ï¼Œç°åœ¨å°çƒå¯ä»¥å‘ä¸‹æ»šï¼Œè·å¾—åŠ¨é‡ï¼ˆmomentumï¼‰ã€‚</p>
<p>å®ç°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/74.png' width="80%" height="80%"/ loading="lazy">

<p>$\beta$ çš„å¸¸ç”¨å€¼æ˜¯ 0.9ï¼Œå³å¹³å‡å‰åæ¬¡è¿­ä»£çš„æ¢¯åº¦ã€‚åŒæ—¶ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨åå·®ä¿®æ­£ $\frac{V_t}{1-\beta^t}$ ï¼Œå› ä¸º10æ¬¡åå·²ç»å¯ä»¥æ­£å¸¸è¿‘ä¼¼äº†ã€‚</p>
<p>ä¹Ÿæœ‰èµ„æ–™å°† $(1-\beta)$ å¿½ç•¥ï¼Œä½¿ç”¨å³è¾¹çš„å¼å­ï¼Œè¿™ä¸¤è€…åœ¨æ•ˆæœä¸Šæ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯ä¼šå½±å“åˆ° $\alpha$ çš„æœ€ä½³å€¼ã€‚è€å¸ˆè®¤ä¸ºå·¦è¾¹çš„è®¡ç®—æ–¹æ³•æ›´ç¬¦åˆç›´è§‰ï¼Œå› ä¸ºå¦‚æœè¦è°ƒæ•´è¶…å‚æ•° $\beta$ï¼Œå°±ä¼šå½±å“åˆ° $V_{dw}$ å’Œ $V_{db}$ ï¼Œä¹Ÿè®¸è¿˜è¦ä¿®æ”¹ $\alpha$ã€‚</p>
<h4 id="2-7-RMSprop-root-mean-square-prop"><a href="#2-7-RMSprop-root-mean-square-prop" class="headerlink" title="2.7 RMSprop-root mean square prop"></a>2.7 RMSprop-root mean square prop</h4><p>å¦ä¸€ç§æ¶ˆé™¤æ¢¯åº¦ä¸‹é™çš„æ‘†åŠ¨ï¼ŒåŠ å¿«æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/75.png' width="80%" height="80%"/ loading="lazy">

<p>å½“åœ¨æŸä¸ªæ–¹å‘æ³¢åŠ¨å¤§ï¼ˆå¦‚å›¾ä¸­ä¸¾ä¾‹ $db$ ï¼Œåœ¨æ¢¯åº¦ä¸‹é™å‡å»ä¸€ä¸ªåˆ†æ¯è¾ƒå¤§çš„æ•° $b:&#x3D; b-\alpha \frac{db}{\sqrt{db}}$ï¼Œè®©æ¢¯åº¦ä¸‹é™çš„å¹…åº¦å‡å°ã€‚åœ¨æŸä¸ªæ–¹å‘æ¢¯åº¦ä¸‹é™å¹…åº¦å°ï¼ˆå¦‚å›¾ä¸­ä¸¾ä¾‹ $dw$ ï¼Œåœ¨æ¢¯åº¦ä¸‹é™å‡å»ä¸€ä¸ªè¾ƒå°çš„æ•° $w:&#x3D; w-\alpha \frac{dw}{\sqrt{dw}}$ï¼Œè®©æ¢¯åº¦ä¸‹é™çš„å¹…åº¦å¢å¤§ã€‚</p>
<p>å…¶ä»–ï¼šä¸ºäº†è·Ÿmomentumç»“åˆèµ·æ¥ï¼Œå°†RMSpropçš„è¶…å‚æ•°å‘½åä¸º $\beta_2$ ï¼›é˜²æ­¢é™¤ä»¥0ï¼Œåœ¨åˆ†æ¯åŠ ä¸Šå¾ˆå°çš„æ•° $\epsilon &#x3D; 10^{-8}$ ã€‚</p>
<h4 id="2-8-Adamä¼˜åŒ–ç®—æ³•"><a href="#2-8-Adamä¼˜åŒ–ç®—æ³•" class="headerlink" title="2.8 Adamä¼˜åŒ–ç®—æ³•"></a>2.8 Adamä¼˜åŒ–ç®—æ³•</h4><p>æŠŠmomentumå’ŒRMSpropç»„åˆèµ·æ¥ã€‚åœ¨ä¸åŒçš„æ¨¡å‹ä¸Šéƒ½æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œæœ‰å¾ˆå¹¿æ³›çš„åº”ç”¨ã€‚</p>
<p>Adamç®—æ³•éœ€è¦è¿›è¡Œåå·®ä¿®æ­£ã€‚</p>
<p>momentumï¼š$w&#x3D;w-\alpha V_{dw}$ </p>
<p>RMSpropï¼š$w &#x3D; w - \alpha \frac{dw}{\sqrt{S_{dw}+\epsilon}}$ </p>
<p>Adamï¼š$w &#x3D; w - \alpha \frac{V_{dw}}{\sqrt{S_{dw}+\epsilon}}$ </p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/76.png' width="80%" height="80%"/ loading="lazy">



<p>å‡ ä¸ªè¶…å‚æ•°ï¼Œå½“åº”ç”¨adamç®—æ³•æ—¶ï¼Œ$\beta_1,\beta_2,\epsilon$ å¸¸å¸¸éƒ½æ˜¯ç”¨ç¼ºçœå€¼ï¼Œ$\alpha$ éœ€è¦å®éªŒç¡®å®šã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/77.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-9-å­¦ä¹ ç‡è¡°å‡ï¼ˆLearning-rate-decayï¼‰"><a href="#2-9-å­¦ä¹ ç‡è¡°å‡ï¼ˆLearning-rate-decayï¼‰" class="headerlink" title="2.9 å­¦ä¹ ç‡è¡°å‡ï¼ˆLearning rate decayï¼‰"></a>2.9 å­¦ä¹ ç‡è¡°å‡ï¼ˆLearning rate decayï¼‰</h4><p>éšæ—¶é—´æ…¢æ…¢å‡å°å­¦ä¹ ç‡ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/78.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸€ç§æ–¹æ³•ï¼š</p>
<p>$$\alpha &#x3D; \frac{1}{1+decay_rate \times epoch_num}\alpha_{init}$$</p>
<p>decay_rate æ˜¯éœ€è¦è°ƒæ•´çš„è¶…å‚æ•°ã€‚ </p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/79.png' width="80%" height="80%"/ loading="lazy">



<p>å…¶ä»–å‡ ç§æ–¹æ³•ï¼šæŒ‡æ•°è¡°å‡ã€é™¤ä»¥epoch_numçš„å¼€æ–¹ã€ç¦»æ•£è¡°å‡ç­‰ã€‚ä¹Ÿæœ‰çœ‹ç€æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ï¼Œç„¶åæ‰‹åŠ¨è¿›è¡Œè¡°å‡çš„æ–¹æ³•ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/80.png' width="80%" height="80%"/ loading="lazy">



<h4 id="2-10-å±€éƒ¨æœ€ä¼˜é—®é¢˜"><a href="#2-10-å±€éƒ¨æœ€ä¼˜é—®é¢˜" class="headerlink" title="2.10 å±€éƒ¨æœ€ä¼˜é—®é¢˜"></a>2.10 å±€éƒ¨æœ€ä¼˜é—®é¢˜</h4><p>åœ¨ç»´æ•°å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œæ›´å¤šçš„æƒ…å†µæ˜¯æ”¶æ•›åˆ°éå½¢éƒ¨ä½ï¼ˆéç‚¹ï¼Œå›¾å³æ–¹ï¼‰ï¼Œè€Œä¸æ˜¯å±€éƒ¨æœ€ä¼˜ç‚¹ï¼ˆå›¾å·¦æ–¹ï¼‰ã€‚åœ¨éç‚¹ï¼Œä¸€äº›æ–¹å‘çš„æ›²çº¿å‘ä¸‹å¼¯æ›²ï¼Œä¸€äº›æ–¹å‘çš„æ›²çº¿å‘ä¸Šå¼¯æ›²ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/81.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨éä¸Šç§°ä¸ºplateausé—®é¢˜ï¼Œè¿™æ®µæ—¶é—´è®­ç»ƒå¾—æ¯”è¾ƒæ…¢ï¼Œä½¿ç”¨momentumç­‰ç®—æ³•å¯ä»¥åŠ é€Ÿæ­¤è¿‡ç¨‹ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/82.png' width="80%" height="80%"/ loading="lazy">





<h3 id="ç¬¬ä¸‰å‘¨ï¼šè¶…å‚æ•°è°ƒè¯•ï¼Œæ‰¹æ­£åˆ™åŒ–å’Œç¨‹åºæ¡†æ¶"><a href="#ç¬¬ä¸‰å‘¨ï¼šè¶…å‚æ•°è°ƒè¯•ï¼Œæ‰¹æ­£åˆ™åŒ–å’Œç¨‹åºæ¡†æ¶" class="headerlink" title="ç¬¬ä¸‰å‘¨ï¼šè¶…å‚æ•°è°ƒè¯•ï¼Œæ‰¹æ­£åˆ™åŒ–å’Œç¨‹åºæ¡†æ¶"></a>ç¬¬ä¸‰å‘¨ï¼šè¶…å‚æ•°è°ƒè¯•ï¼Œæ‰¹æ­£åˆ™åŒ–å’Œç¨‹åºæ¡†æ¶</h3><p>è°ƒå‚çš„åŸºæœ¬è§„åˆ™å’Œæ–¹æ³•ï¼›batch normè®©å­¦ä¹ ç®—æ³•è¿è¡Œé€Ÿåº¦æ›´å¿«ï¼›softmaxå›å½’ï¼›æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚</p>
<h4 id="3-1-è°ƒå‚è§„åˆ™"><a href="#3-1-è°ƒå‚è§„åˆ™" class="headerlink" title="3.1 è°ƒå‚è§„åˆ™"></a>3.1 è°ƒå‚è§„åˆ™</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/83.png' width="50%" height="50%"/ loading="lazy">

<p>è°ƒå‚é‡è¦æ€§æ’åºï¼šçº¢ &gt; é»„ &gt; ç´«ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/84.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œä¸è¦ç”¨ç½‘æ ¼å–å€¼è¿›è¡Œå®éªŒï¼ˆå›¾å·¦ï¼‰ã€‚</p>
<p>åº”è¯¥éšæœºå–è¶…å‚æ•°çš„å€¼å¹¶è¿›è¡Œå®éªŒï¼ˆå›¾å³ï¼‰ã€‚å› ä¸ºä¸çŸ¥é“å“ªä¸ªè¶…å‚æ•°æ˜¯æ›´é‡è¦çš„ï¼Œéœ€è¦æ¢ç©¶é‡è¦çš„è¶…å‚æ•°çš„æ›´å¤šæ½œåœ¨å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/85.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨ä»ç²—ç•¥åˆ°ç²¾ç»†ï¼ˆcoarse to fineï¼‰çš„ç­–ç•¥ã€‚åœ¨è¡¨ç°å¥½çš„åŒºåŸŸä¸Šè¿›è¡Œæ›´å¯†é›†çš„å–å€¼å°è¯•</p>
<h4 id="3-2-åˆé€‚çš„å‚æ•°å–å€¼èŒƒå›´"><a href="#3-2-åˆé€‚çš„å‚æ•°å–å€¼èŒƒå›´" class="headerlink" title="3.2 åˆé€‚çš„å‚æ•°å–å€¼èŒƒå›´"></a>3.2 åˆé€‚çš„å‚æ•°å–å€¼èŒƒå›´</h4><p>æœ‰äº›è¶…å‚æ•°ï¼Œå¯ä»¥åœ¨åˆç†çš„èŒƒå›´å†…ï¼Œåœ¨<strong>çº¿æ€§è½´</strong>ä¸Šï¼Œåšéšæœºå‡åŒ€å–å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/86.png' width="80%" height="80%"/ loading="lazy">



<p>å­¦ä¹ ç‡ç­‰è¶…å‚æ•°ï¼Œæ›´åˆé€‚çš„æ–¹æ³•æ˜¯åœ¨<strong>å¯¹æ•°è½´</strong>ä¸Šå‡åŒ€éšæœºå–å€¼ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python">r <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token punctuation">)</span>
alpha <span class="token operator">=</span> exp<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span></code></pre>

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/87.png' width="80%" height="80%"/ loading="lazy">





<p>åœ¨ $1-\beta$ å–å€¼ï¼Œè€Œä¸æ˜¯åœ¨ $\beta$ å–å€¼ã€‚å› ä¸ºåœ¨ $\beta$ è¶Šæ¥è¿‘ 1ï¼Œå¹³å‡çš„æ ·æœ¬ä¸ªæ•°æœ‰æ›´å¤§çš„å˜åŒ–ï¼Œéœ€è¦æ›´å¯†é›†çš„å–å€¼ã€‚æ‰€ä»¥åœ¨ $1-\beta$ æ¥è¿‘ 0 æ—¶è¿›è¡Œæ›´å¯†é›†çš„å–å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/88.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-3-è¶…å‚æ•°è®­ç»ƒçš„å®è·µï¼šPandas-vs-Caviar"><a href="#3-3-è¶…å‚æ•°è®­ç»ƒçš„å®è·µï¼šPandas-vs-Caviar" class="headerlink" title="3.3 è¶…å‚æ•°è®­ç»ƒçš„å®è·µï¼šPandas vs. Caviar"></a>3.3 è¶…å‚æ•°è®­ç»ƒçš„å®è·µï¼šPandas vs. Caviar</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/89.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨ä¸åŒé¢†åŸŸçš„å‚æ•°è®¾ç½®å¯èƒ½æœ‰ç›¸ä¼¼çš„éƒ¨åˆ†ï¼Œå¤šäº†è§£å…¶ä»–å·¥ä½œï¼›å¤šè¿›è¡Œå°è¯•ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/90.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸€ç§æ–¹æ³•ï¼šåœ¨è®­ç»ƒä¸­ç…§çœ‹ï¼ˆbabysittingï¼‰æ¨¡å‹ï¼Œæ¯”å¦‚è¿›è¡Œå­¦ä¹ ç‡çš„è°ƒæ•´ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•ï¼šåŒæ—¶è®­ç»ƒè¶…å‚æ•°å–å€¼ä¸åŒçš„å¤šä¸ªæ¨¡å‹ã€‚</p>
<h4 id="3-4-æ¿€æ´»å‡½æ•°çš„å½’ä¸€åŒ–-x2F-å•ä¸€éšè—å±‚ä¸Šçš„æ‰¹å½’ä¸€åŒ–ï¼ˆBatch-normalizationï¼‰"><a href="#3-4-æ¿€æ´»å‡½æ•°çš„å½’ä¸€åŒ–-x2F-å•ä¸€éšè—å±‚ä¸Šçš„æ‰¹å½’ä¸€åŒ–ï¼ˆBatch-normalizationï¼‰" class="headerlink" title="3.4 æ¿€æ´»å‡½æ•°çš„å½’ä¸€åŒ–&#x2F;å•ä¸€éšè—å±‚ä¸Šçš„æ‰¹å½’ä¸€åŒ–ï¼ˆBatch normalizationï¼‰"></a>3.4 æ¿€æ´»å‡½æ•°çš„å½’ä¸€åŒ–&#x2F;å•ä¸€éšè—å±‚ä¸Šçš„æ‰¹å½’ä¸€åŒ–ï¼ˆBatch normalizationï¼‰</h4><p>batch normalization ä¼šä½¿å‚æ•°æœç´¢é—®é¢˜å˜å¾—å¾ˆå®¹æ˜“ï¼Œä½¿ç¥ç»ç½‘ç»œå¯¹è¶…å‚æ•°çš„é€‰æ‹©æ›´åŠ ç¨³å®šã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/91.png' width="80%" height="80%"/ loading="lazy">

<p>å¯¹é€»è¾‘å›å½’ã€ç¥ç»ç½‘ç»œçš„è¾“å…¥å½’ä¸€åŒ–è€Œè¨€ï¼Œè¿›è¡Œè¾“å…¥ç‰¹å¾å€¼çš„å½’ä¸€åŒ–æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚å›¾çš„ä¸ŠåŠéƒ¨åˆ†ï¼Œå¯¹ $x_1,x_2,x_3$ è¿›è¡Œå½’ä¸€åŒ–å¯¹ $w,b$ çš„è®­ç»ƒæœ‰å¸®åŠ©ã€‚</p>
<p>åŒæ ·çš„æ€æƒ³ï¼šå¯¹æ·±å±‚çš„æ¨¡å‹ï¼Œèƒ½å¦å¯¹ $a^{[i]}$ è¿›è¡Œå½’ä¸€åŒ–ï¼Œæ”¹è¿› $w^{[i+1]},b^{[i+1]}$ çš„è®­ç»ƒï¼Ÿ</p>
<p>åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬ä¸å¯¹ $a^{[i]}$ åšå½’ä¸€åŒ–ï¼Œè€Œæ˜¯å¯¹ $z^{[i]}$ åšå½’ä¸€åŒ–ã€‚è¿™ä¸€ç‚¹ä¸€ç›´æœ‰äº‰è®ºã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/92.png' width="80%" height="80%"/ loading="lazy">

<p>å®ç°ï¼š</p>
<p>$$z_{norm}^{(i)} &#x3D; \frac{z^{(i)}-\mu}{\sqrt{\sigma^2+\epsilon}}$$ </p>
<p>$$\widetilde{z}^{(i)} &#x3D; \gamma z_{norm}^{(i)} + \beta$$ </p>
<ul>
<li><p>$\gamma,\beta$ æ˜¯å¯ä»¥å­¦ä¹ çš„å‚æ•°ï¼ˆä¸æ˜¯è¶…å‚æ•°ï¼‰ã€‚å¦‚æœ $\gamma&#x3D;\sqrt{\sigma^2+\epsilon},\beta&#x3D;\mu$ï¼Œåˆ™ $\widetilde{z}^{(i)} &#x3D; {z}^{(i)}$ï¼Œbatch normalizationä¸èµ·ä½œç”¨ã€‚ $\gamma$ æ§åˆ¶æ–¹å·®ï¼Œ$\beta$ å€¼æ§åˆ¶å‡å€¼ã€‚é€šè¿‡ç»™å®ƒä»¬èµ‹å€¼ï¼Œå¯ä»¥æ„é€ å«å¹³å‡å€¼å’Œæ–¹å·®çš„éšè—å•å…ƒå€¼ã€‚</p>
</li>
<li><p>ç”¨  $\widetilde{z}^{(i)}$ å–ä»£ ${z}^{(i)}$ ï¼Œå‚ä¸ç¥ç»ç½‘ç»œçš„åç»­è®¡ç®—ã€‚</p>
</li>
<li><p>ä¸ä¸€å®šéè¦å½’ä¸€åŒ–æˆå‡å€¼ä¸º0çš„åˆ†å¸ƒã€‚å¯ä»¥å½’ä¸€åŒ–åˆ°å‡å€¼ä¸æ˜¯0ï¼Œæ–¹å·®å¤§ä¸€ç‚¹ï¼Œç¬¦åˆsigmoidç­‰æ¿€æ´»å‡½æ•°çš„ç‰¹æ€§ã€‚</p>
</li>
<li><p>batch normalizationæœ¬è´¨ä¸Šæ˜¯è®©éšè—å•å…ƒå€¼çš„å‡å€¼å’Œæ–¹å·®æ ‡å‡†åŒ–ï¼Œå³ $z^{[i]}$ æœ‰å›ºå®šçš„å‡å€¼å’Œæ–¹å·®ï¼Œç”± $\gamma,\beta$ ä¸¤ä¸ªå‚æ•°æ§åˆ¶ã€‚</p>
</li>
</ul>
<h4 id="3-5-æ·±åº¦ç¥ç»ç½‘ç»œçš„æ‰¹å½’ä¸€åŒ–"><a href="#3-5-æ·±åº¦ç¥ç»ç½‘ç»œçš„æ‰¹å½’ä¸€åŒ–" class="headerlink" title="3.5 æ·±åº¦ç¥ç»ç½‘ç»œçš„æ‰¹å½’ä¸€åŒ–"></a>3.5 æ·±åº¦ç¥ç»ç½‘ç»œçš„æ‰¹å½’ä¸€åŒ–</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/93.png' width="80%" height="80%"/ loading="lazy">

<p>batch normæ˜¯å‘ç”Ÿåœ¨è®¡ç®— $z$ å’Œ $a$ ä¹‹é—´çš„ã€‚ç»™ç¥ç»ç½‘ç»œæ·»åŠ äº†æ–°çš„å‚æ•° $\gamma,\beta$ ã€‚ï¼ˆæ³¨æ„ï¼Œè·Ÿmomentumç­‰ä¼˜åŒ–ç®—æ³•çš„è¶…å‚æ•° $\beta$ åŒºåˆ†ã€‚è¿™ä¸¤è€…çš„è®ºæ–‡éƒ½ä½¿ç”¨ $\beta$ ä½œä¸ºå‚æ•°çš„åç§°ã€‚ï¼‰</p>
<p>ä½¿ç”¨ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™æˆ–Adamç­‰ï¼‰ï¼Œå¯¹è¿™äº›å‚æ•° $w,b,\gamma,\beta$ è¿›è¡Œæ›´æ–°ã€‚</p>
<p>åœ¨æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸­ï¼Œå¯ä»¥ç”¨ä¸€è¡Œä»£ç å®Œæˆbatch normçš„æ“ä½œï¼Œæ— éœ€è‡ªå·±å®ç°ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/94.png' width="80%" height="80%"/ loading="lazy">

<p>batch normé€šå¸¸å’Œè®­ç»ƒé›†çš„mini-batchä¸€èµ·ä½¿ç”¨ã€‚åœ¨æ¯ä¸€ä¸ªmini-batchä¸Šï¼Œåšä¸€æ¬¡æ¢¯åº¦ä¸‹é™ã€‚</p>
<p>åœ¨ä¸Šä¸€æ®µä¸­ï¼Œæåˆ°å¯¹å‚æ•° $w,b,\gamma,\beta$ è¿›è¡Œæ›´æ–°ã€‚ä½†å®é™…çš„è®¡ç®—æ­¥éª¤ä¸ºï¼š</p>
<ul>
<li>å…ˆè®¡ç®— $z^{[l]}  &#x3D; w^{[l]}a^{[l-1]}+b^{[l]}$ï¼›</li>
<li>ç„¶åå¯¹ $z^{[l]}$ è¿›è¡Œå½’ä¸€åŒ–è®¡ç®— $z_{norm}^{[l]}$ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ä¼šå‡å»å‡å€¼ï¼Œ <strong>$b^{[l]}$ è¿™ä¸ªåŠ ä¸Šå»çš„å‚æ•°æ˜¯æ— æ•ˆçš„ã€‚</strong></li>
<li>ç”¨ $\widetilde{z}^{[l]} &#x3D; \gamma^{[l]}z_{norm}^{[l]} + \beta^{[l]}$ è¿›è¡Œåç»­è®¡ç®—ã€‚<strong>å½¢å¼ä¸Šï¼Œ $\beta$ ä»£æ›¿äº†å‚æ•° $b$ ã€‚</strong></li>
</ul>
<p>å®é™…è®¡ç®—æ­¥éª¤ï¼š</p>
<ul>
<li>$z^{[l]}  &#x3D; w^{[l]}a^{[l-1]}$ </li>
<li>è®¡ç®— $z_{norm}^{[l]}$ </li>
<li>$\widetilde{z}^{[l]} &#x3D; \gamma^{[l]}z_{norm}^{[l]} + \beta^{[l]}$</li>
</ul>
<p>æ­¤å¤–ï¼Œæ³¨æ„å‚æ•°çš„ç»´åº¦ï¼š$z,b,\beta,\gamma$ ç»´åº¦éƒ½æ˜¯ $(n^{[l]}, 1)$</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/95.png' width="80%" height="80%"/ loading="lazy">

<p>å®ç°ï¼š</p>
<p>å¯¹äºæ¯ä¸€ä¸ªmini-batchï¼šåœ¨å‰å‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¯ä¸ªéšè—å±‚ä½¿ç”¨ batch normï¼›åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ï¼›è¿›è¡Œæ¢¯åº¦ä¸‹é™æˆ–ä½¿ç”¨å…¶ä»–ä¼˜åŒ–ç®—æ³•ã€‚</p>
<h4 id="3-6-ä¸ºä»€ä¹ˆBatch-Normæœ‰ç”¨ï¼Ÿ"><a href="#3-6-ä¸ºä»€ä¹ˆBatch-Normæœ‰ç”¨ï¼Ÿ" class="headerlink" title="3.6 ä¸ºä»€ä¹ˆBatch Normæœ‰ç”¨ï¼Ÿ"></a>3.6 ä¸ºä»€ä¹ˆBatch Normæœ‰ç”¨ï¼Ÿ</h4><p>ç¬¬ä¸€ä¸ªåŸå› ï¼šè·Ÿé€»è¾‘å›å½’ç±»ä¼¼ï¼Œè®©æ‰€æœ‰ç‰¹å¾å½’ä¸€åˆ°åŒä¸€å°ºåº¦ï¼ŒåŠ é€Ÿæ¢¯åº¦ä¸‹é™çš„è¿‡ç¨‹ã€‚ </p>
<p>ç¬¬äºŒä¸ªåŸå› ï¼šè®©æƒé‡æ¯”ç½‘ç»œæ›´æ»åæˆ–æ›´æ·±å±‚ï¼Œè®©æ•°å€¼æ›´ç¨³å®šã€‚ç¬¬10å±‚çš„æƒé‡æ¯”ç¬¬1å±‚çš„æƒé‡æ›´robustã€‚åœ¨ä¹‹å‰å±‚çš„æƒé‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œ$z$ ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†batch normä¿è¯äº† $z$  çš„å‡å€¼å’Œæ–¹å·®ä¿æŒä¸å˜ã€‚å› æ­¤é™åˆ¶äº†åœ¨å‰å±‚çš„å‚æ•°æ›´æ–°å¯¹æ•°å€¼åˆ†å¸ƒçš„å½±å“ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/96.png' width="80%" height="80%"/ loading="lazy">

<p>ç¬¬ä¸‰ä¸ªåŸå› ï¼šbatch normæœ‰ä¸€ç‚¹æ­£åˆ™åŒ–çš„æ•ˆæœã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/97.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-7-æµ‹è¯•æ—¶çš„Batch-Norm"><a href="#3-7-æµ‹è¯•æ—¶çš„Batch-Norm" class="headerlink" title="3.7 æµ‹è¯•æ—¶çš„Batch Norm"></a>3.7 æµ‹è¯•æ—¶çš„Batch Norm</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/98.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œbatch normä¸€æ¬¡ä½œç”¨åœ¨ä¸€ä¸ªmini-batchä¸Šï¼Œæ±‚è¿™ä¸ªmini-batchä¸Šçš„å‡å€¼å’Œæ–¹å·®ï¼ˆå›¾å·¦ï¼‰ï¼›åœ¨è¯„ä¼°é˜¶æ®µï¼Œbatch normåªä½œç”¨åœ¨å•ä¸ªæµ‹è¯•æ ·æœ¬ä¸Šï¼Œè™½ç„¶å¯ä»¥åœ¨æ•´ä¸ªæµ‹è¯•é›†ä¸Šè®¡ç®— $\mu,\sigma^2$ï¼Œä½†åœ¨å®é™…æ“ä½œä¸­ï¼Œé€šå¸¸ä½¿ç”¨æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆå›¾å³ï¼‰ã€‚</p>
<p>è¿½è¸ªè®­ç»ƒè¿‡ç¨‹ä¸­æ¯ä¸ªmini-batchçš„ $\mu,\sigma^2$ çš„å€¼ï¼Œç„¶åä½¿ç”¨ä¹‹å‰æ±‚æ¸©åº¦ $\theta_1,\theta_2,\theta_3$ çš„æŒ‡æ•°åŠ æƒå¹³å‡çš„æ–¹æ³•ï¼ˆè§<a href="#2.2.3">ç¬¬äºŒè¯¾ç¬¬äºŒå‘¨ç¬¬ä¸‰èŠ‚</a>ï¼Œæ±‚ $\mu,\sigma^2$ çš„è¿‘ä¼¼å€¼ï¼Œç„¶åç”¨äºä¸‹ä¸€æ­¥è®¡ç®— $z_{norm} &#x3D; \frac{z-\mu}{\sqrt{\sigma^2+\epsilon}}$ã€‚</p>
<p>å®é™…ä¸Šï¼Œä¸ç®¡ç”¨ä»€ä¹ˆæ ·çš„ä¼°è®¡æ–¹æ³•ï¼Œæ•´å¥—è¿‡ç¨‹éƒ½æ˜¯æ¯”è¾ƒrobustçš„ã€‚</p>
<p>å½“ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶æ—¶ï¼Œé€šå¸¸ä¼šæœ‰é»˜è®¤çš„ä¼°ç®— $\mu,\sigma^2$ çš„æ–¹æ³•ã€‚</p>
<h4 id="3-8-Softmax-å›å½’"><a href="#3-8-Softmax-å›å½’" class="headerlink" title="3.8 Softmax å›å½’"></a>3.8 Softmax å›å½’</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/99.png' width="80%" height="80%"/ loading="lazy">

<p>å¤šåˆ†ç±»é—®é¢˜ä¸­ï¼Œé¢„æµ‹ä¸€ç»„ç›¸åŠ ä¸º1çš„æ¦‚ç‡å€¼ä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/100.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨softmaxæ¿€æ´»å‡½æ•°è¿›è¡Œä»æƒå€¼åˆ°æ¦‚ç‡çš„è½¬æ¢ã€‚$t^i&#x3D;e^{z^i}$ï¼Œ$a^i &#x3D; \frac{t^i}{\sum t}$ </p>
<p>ReLUå’ŒSigmoidå‡½æ•°è¾“å…¥ä¸€ä¸ªå®æ•°ï¼Œè¾“å‡ºä¸€ä¸ªå®æ•°ï¼›è€Œsoftmaxå‡½æ•°å› ä¸ºè¦å¯¹æ‰€æœ‰çš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–ï¼ˆè®¡ç®—æ¦‚ç‡ï¼‰ï¼Œéœ€è¦è¾“å…¥ä¸€ä¸ªå‘é‡ï¼Œè¾“å‡ºä¸€ä¸ªå‘é‡ã€‚</p>
<p>ç›´è§‚çš„softmaxåˆ†ç±»çš„ä¾‹å­ï¼šç¥ç»ç½‘ç»œåªæœ‰ä¸€å±‚softmaxå±‚ã€‚ç¥ç»å…ƒæœ‰ä¸‰ä¸ªï¼Œå°±åˆ†æˆ3ç±»ï¼Œæ¯ç±»ä¹‹é—´éƒ½æ˜¯çº¿æ€§å†³ç­–è¾¹ç•Œã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/101.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-9-è®­ç»ƒä¸€ä¸ª-Softmax-åˆ†ç±»å™¨"><a href="#3-9-è®­ç»ƒä¸€ä¸ª-Softmax-åˆ†ç±»å™¨" class="headerlink" title="3.9 è®­ç»ƒä¸€ä¸ª Softmax åˆ†ç±»å™¨"></a>3.9 è®­ç»ƒä¸€ä¸ª Softmax åˆ†ç±»å™¨</h4><p>softmaxè·Ÿhardmaxç›¸å¯¹ï¼ŒæŠŠæœ€å¤§å€¼æ›´æ¸©å’Œåœ°è½¬æ¢æˆä¸€ä¸ªæ¦‚ç‡ï¼Œè€Œä¸æ˜¯å…¨éƒ¨æ”¹ä¸º0å’Œ1.</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/102.png' width="80%" height="80%"/ loading="lazy">



<p><strong>è®­ç»ƒ-æŸå¤±å‡½æ•°</strong>ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/103.png' width="80%" height="80%"/ loading="lazy">

<p>å•ä¸ªè®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°ï¼š$$L(\hat{y}, y) &#x3D; -\sum^C_{j&#x3D;1}y_jlog\hat{y_j}$$</p>
<p>åœ¨çœŸå®æƒ…å†µä¸­ï¼Œ$y_j$ åªæœ‰ä¸€ä¸ªä¸º1ï¼Œå…¶ä½™éƒ½ä¸º0ï¼Œå› æ­¤æŸå¤±å‡½æ•°æ˜¯ $-log\hat{y_i}$ ï¼ŒæŸå¤±å‡½æ•°è¯•å›¾è®© $y&#x3D;1$ å¯¹åº”çš„ $\hat{y}$ å°½é‡åœ°å¤§ã€‚è¿™ä¹Ÿæ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ä¸€ç§å½¢å¼ã€‚</p>
<p>æ•´ä¸ªè®­ç»ƒé›†çš„æŸå¤±å‡½æ•°ï¼š$$J(w,b) &#x3D; \frac{1}{m}\sum^m_{i&#x3D;1} L(\hat{y}, y)$$ </p>
<p>$\hat{y},y$ çš„ç»´åº¦éƒ½æ˜¯ $(4, m) $ã€‚</p>
<p><strong>è®­ç»ƒ-æ¢¯åº¦ä¸‹é™</strong>ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/104.png' width="80%" height="80%"/ loading="lazy">

<p>æ¢¯åº¦ï¼š$$dz^{[l]} &#x3D; \hat{y} - y$$ </p>
<p>åœ¨æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸­ï¼Œä¸»è¦ç²¾åŠ›æ”¾åœ¨å°†å‰å‘ä¼ æ’­åšå¥½ã€‚é€šå¸¸æ¡†æ¶è‡ªå·±ä¼šå¼„æ˜ç™½æ€æ ·åå‘ä¼ æ’­ã€‚</p>
<h4 id="3-10-æ·±åº¦å­¦ä¹ æ¡†æ¶"><a href="#3-10-æ·±åº¦å­¦ä¹ æ¡†æ¶" class="headerlink" title="3.10 æ·±åº¦å­¦ä¹ æ¡†æ¶"></a>3.10 æ·±åº¦å­¦ä¹ æ¡†æ¶</h4><p>ç°å­˜çš„æ¡†æ¶ï¼›é€‰æ‹©æ¡†æ¶çš„æ ‡å‡†ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/105.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-11-TensorFlow"><a href="#3-11-TensorFlow" class="headerlink" title="3.11 TensorFlow"></a>3.11 TensorFlow</h4><p>åœ¨tensorflowä¸­å®šä¹‰æŸå¤±å‡½æ•°costï¼Œå¯ä»¥ç†è§£ä¸ºtensorflowä¼šå»ºç«‹èµ·ä¸€ä¸ªè®¡ç®—å›¾ï¼Œæ¥è‡ªåŠ¨å®Œæˆåç»­çš„åå‘ä¼ æ’­ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/106.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨æ¡†æ¶ä¸­ï¼Œå¯ä»¥åªç”¨ä¸€è¡Œä»£ç ä¿®æ”¹å¾ˆå¤šå·¥ä½œï¼Œæ¯”å¦‚è®­ç»ƒçš„æ–¹æ³•æ˜¯æ¢¯åº¦ä¸‹é™è¿˜æ˜¯Adamã€‚è¿™æ”¯æŒæˆ‘ä»¬å¿«é€Ÿå®ç°å¤æ‚çš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚</p>
<h2 id="ç¬¬ä¸‰è¯¾-ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›®-Structuring-Machine-Learning-Projects"><a href="#ç¬¬ä¸‰è¯¾-ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›®-Structuring-Machine-Learning-Projects" class="headerlink" title="ç¬¬ä¸‰è¯¾ ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›® (Structuring Machine Learning Projects)"></a>ç¬¬ä¸‰è¯¾ ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›® (Structuring Machine Learning Projects)</h2><p>æš‚æ—¶ç©ºç¼º</p>
<h2 id="ç¬¬å››è¯¾-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional-Neural-Networksï¼‰"><a href="#ç¬¬å››è¯¾-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional-Neural-Networksï¼‰" class="headerlink" title="ç¬¬å››è¯¾ å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networksï¼‰"></a>ç¬¬å››è¯¾ å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networksï¼‰</h2><h3 id="ç¬¬ä¸€å‘¨-å·ç§¯ç¥ç»ç½‘ç»œ-Foundations-of-Convolutional-Neural-Networks"><a href="#ç¬¬ä¸€å‘¨-å·ç§¯ç¥ç»ç½‘ç»œ-Foundations-of-Convolutional-Neural-Networks" class="headerlink" title="ç¬¬ä¸€å‘¨ å·ç§¯ç¥ç»ç½‘ç»œ(Foundations of Convolutional Neural Networks)"></a>ç¬¬ä¸€å‘¨ å·ç§¯ç¥ç»ç½‘ç»œ(Foundations of Convolutional Neural Networks)</h3><p>å·ç§¯è¿ç®—ï¼ˆpaddingã€strideï¼‰å’Œä¸åŒçš„å·ç§¯æ ¸ï¼›å°†å·ç§¯æ ¸å åŠ çš„ä¸‰ç»´å·ç§¯å’Œå•å±‚å·ç§¯ç½‘ç»œï¼›å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCONVã€POOLã€FNï¼‰ã€‚</p>
<h4 id="1-1-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-visionï¼‰"><a href="#1-1-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-visionï¼‰" class="headerlink" title="1.1 è®¡ç®—æœºè§†è§‰ï¼ˆComputer visionï¼‰"></a>1.1 è®¡ç®—æœºè§†è§‰ï¼ˆComputer visionï¼‰</h4><p>è®¡ç®—æœºè§†è§‰çš„åº”ç”¨ï¼šå›¾ç‰‡åˆ†ç±»ï¼Œç›®æ ‡æ£€æµ‹ï¼Œé£æ ¼è¿ç§»ç­‰ã€‚</p>
<p>è®¡ç®—æœºè§†è§‰çš„ä¸€ä¸ªé—®é¢˜æ˜¯æ•°æ®é‡éå¸¸å¤§ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/107.png' width="80%" height="80%"/ loading="lazy">



<h4 id="1-2-å·ç§¯è¿ç®—-è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼ˆEdge-detectionï¼‰"><a href="#1-2-å·ç§¯è¿ç®—-è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼ˆEdge-detectionï¼‰" class="headerlink" title="1.2 å·ç§¯è¿ç®—-è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼ˆEdge detectionï¼‰"></a>1.2 å·ç§¯è¿ç®—-è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼ˆEdge detectionï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/108.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨ç¥ç»ç½‘ç»œéšè—å±‚ä¸­ï¼Œä¸åŒå±‚è¯†åˆ«ä¸åŒçš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œæµ…å±‚è¯†åˆ«ç‰©ä½“çš„è¾¹ç¼˜ï¼Œæ·±å±‚è¯†åˆ«äººè„¸çš„éƒ¨ä½ï¼Œæ›´æ·±å±‚è¯†åˆ«æ•´ä¸ªäººè„¸ã€‚ä»¥è¾¹ç¼˜æ£€æµ‹ä¸ºä¾‹ï¼Œå±•ç¤ºå·ç§¯è®¡ç®—çš„è¿‡ç¨‹ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/109.png' width="80%" height="80%"/ loading="lazy">

<p>ä»¥ä¸­é—´çŸ©é˜µçš„åŒºåŸŸï¼Œåœ¨å·¦è¾¹çŸ©é˜µçš„æ¯ä¸ªå¯¹åº”åŒºåŸŸï¼Œè¿›è¡Œå¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œç„¶ååŠ èµ·æ¥ï¼Œä½œä¸ºå³è¾¹çŸ©é˜µçš„ä¸€ä¸ªå€¼ã€‚</p>
<p>å·¦è¾¹çš„çŸ©é˜µç†è§£ä¸ºå›¾ç‰‡ï¼›ä¸­é—´çš„çŸ©é˜µæ˜¯è¿‡æ»¤å™¨ï¼ˆfilterï¼‰æˆ–å·ç§¯æ ¸ï¼ˆkernelï¼‰ï¼›å³è¾¹çš„çŸ©é˜µå¯ä»¥ç†è§£ä¸ºå¦ä¸€å¼ å›¾ç‰‡ã€‚* æ˜¯æ•°å­¦ä¸Šçš„å·ç§¯è¿ç®—ç¬¦ï¼Œä½†åœ¨pythonä¸­ï¼Œ * ä¹Ÿè¢«é‡è½½åšå¾ˆå¤šåœºåˆçš„ä¹˜æ³•è¿ç®—ï¼Œæ‰€ä»¥åœ¨ç¼–ç¨‹ä¸­ä½¿ç”¨å…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚tensorflowä¸­æ˜¯ <code>tf.nn.conv2d</code>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯çºµå‘è¾¹ç¼˜çš„è®¡ç®—è¿‡ç¨‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/110.png' width="80%" height="80%"/ loading="lazy">

<p>è¶Šå¤§çš„å€¼ç†è§£ä¸ºé¢œè‰²è¶Šæµ…ã€‚æœ¬ä¾‹è®¡ç®—å‡ºçš„è¾¹ç•Œæ¯”è¾ƒå®½ï¼Œæ˜¯å› ä¸ºåŸå›¾ç‰‡ç›¸å¯¹æ¥è¯´éå¸¸å°ã€‚</p>
<h4 id="1-3-æ›´å¤šè¾¹ç¼˜æ£€æµ‹å†…å®¹"><a href="#1-3-æ›´å¤šè¾¹ç¼˜æ£€æµ‹å†…å®¹" class="headerlink" title="1.3 æ›´å¤šè¾¹ç¼˜æ£€æµ‹å†…å®¹"></a>1.3 æ›´å¤šè¾¹ç¼˜æ£€æµ‹å†…å®¹</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/111.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨ç›¸åŒçš„filterï¼Œå¯ä»¥åœ¨è¾“å‡ºå›¾åƒä¸­åŒºåˆ†æºå›¾åƒä»äº®åˆ°æš—&amp;ä»æš—åˆ°äº®è¿™ä¸¤ç§å˜åŒ–ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/112.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸åŒçš„filterå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°å‚ç›´æˆ–æ°´å¹³çš„è¾¹ç¼˜ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/113.png' width="80%" height="80%"/ loading="lazy">

<p>ä¹Ÿæœ‰ç›¸å…³å·¥ä½œæå‡ºæ›´robustçš„filterå–å€¼ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä¸æ‰‹åŠ¨å®šä¹‰filterï¼Œè€ŒæŠŠè¿™äº›æ•°å­—å½“æˆå‚æ•°ï¼Œé€šè¿‡åå‘ä¼ æ’­å­¦ä¹ æ›´å¥½çš„filterï¼ˆä¹‹åçš„å†…å®¹ï¼‰ã€‚</p>
<p>é€šè¿‡åˆç†è®¾ç½®filterï¼Œä¸ä»…èƒ½æ£€æŸ¥æ°´å¹³ã€å‚ç›´çš„è¾¹ç¼˜ï¼Œä¹Ÿå¯ä»¥æ£€æµ‹ä»»ä½•è§’åº¦çš„è¾¹ç¼˜ã€‚</p>
<p>é€šè¿‡æŠŠfilterçš„æ‰€æœ‰æ•°å­—è®¾ç½®æˆå‚æ•°ï¼Œå¹¶è®©è®¡ç®—æœºè‡ªåŠ¨å­¦ä¹ å®ƒä»¬ï¼Œæˆ‘ä»¬å‘ç°ï¼šç¥ç»ç½‘ç»œå¯ä»¥å­¦ä¹ ä¸€äº›ä½çº§çš„ç‰¹å¾ï¼Œæ¯”å¦‚å›¾ç‰‡çš„è¾¹ç¼˜ç‰¹å¾ã€‚æ„æˆè¿™äº›è¿ç®—çš„åŸºç¡€ä¾ç„¶æ˜¯å·ç§¯è¿ç®—ï¼ˆconvolutionï¼‰ï¼Œä½¿å¾—åå‘ä¼ æ’­ç®—æ³•å¯ä»¥å­¦ä¹ ä»»ä½•æ‰€éœ€çš„3Ã—3 filterï¼Œå¹¶åœ¨æ•´å¼ å›¾ç‰‡ä¸Šåº”ç”¨å®ƒã€‚</p>
<h4 id="1-4-Padding"><a href="#1-4-Padding" class="headerlink" title="1.4 Padding"></a>1.4 Padding</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/114.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨ $f\times f$ çš„å·ç§¯æ ¸ï¼Œå·ç§¯ $n\times n$ çš„æºå›¾åƒï¼Œå¾—åˆ° $(n-f+1)\times(n-f+1)$ çš„æ–°å›¾è±¡ã€‚</p>
<p>å·ç§¯çš„ä¸¤ä¸ªç¼ºç‚¹ï¼š</p>
<ul>
<li>å·ç§¯ä¼šè®©å›¾ç‰‡å°ºå¯¸ç¼©å°ã€‚å¯èƒ½åšå‡ æ¬¡ä¹‹åå›¾åƒå°±å˜å¾—å¾ˆå°äº†ã€‚</li>
<li>è¾¹ç¼˜çš„åƒç´ å‚ä¸çš„å·ç§¯è¿ç®—å¾ˆå°‘ï¼Œä¸­é—´çš„åƒç´ ç”¨å¾—å¾ˆå¤šã€‚æ„å‘³ç€å·ç§¯ä¸¢å¤±äº†å›¾åƒè¾¹ç¼˜çš„ä¿¡æ¯ã€‚</li>
</ul>
<p>é€šè¿‡paddingè§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼šåœ¨å›¾åƒå‘¨å›´å†æ·»åŠ  $p$ åœˆåƒç´ ã€‚</p>
<p>ä½¿ç”¨ $f\times f$ çš„å·ç§¯æ ¸ï¼Œå·ç§¯ $(n+p)\times (n+p)$ çš„æºå›¾åƒï¼Œå¾—åˆ° $(n+2p-f+1)\times(n+2p-f+1)$ çš„æ–°å›¾è±¡ã€‚</p>
<p>å¦‚å›¾ $p&#x3D;1$ï¼š</p>
<ul>
<li>$8\times 8$ çš„æ–°å›¾è±¡ç»è¿‡å·ç§¯ï¼Œå¾—åˆ° $6\times 6$ çš„å›¾åƒï¼Œå°ºå¯¸æ²¡æœ‰å˜å°ã€‚</li>
<li>è¾¹ç¼˜çš„åƒç´ å‚ä¸çš„å·ç§¯è¿ç®—æ›´å¤šäº†ã€‚</li>
</ul>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/115.png' width="80%" height="80%"/ loading="lazy">

<p> å…³äºpaddingå¤šå°‘ï¼š</p>
<ul>
<li>Valid convolutionï¼šä¸paddingã€‚ $(n\times n) * (f\times f) \longrightarrow (n-f+1)\times(n-f+1)$</li>
<li>Same convolutionï¼špaddingåå¾—åˆ°çš„è¾“å‡ºå›¾åƒå°ºå¯¸æ˜¯æºå›¾åƒå°ºå¯¸ã€‚ $(n\times n) * (f\times f) \longrightarrow n\times n$ï¼Œ$p&#x3D;\frac{f-1}{2}$</li>
</ul>
<p>åœ¨è®¡ç®—æœºè§†è§‰é—®é¢˜ä¸­ï¼Œ$f$ ä¸€èˆ¬æ˜¯å¥‡æ•°ã€‚</p>
<h4 id="1-5-å·ç§¯æ­¥é•¿ï¼ˆStrided-convolutionsï¼‰"><a href="#1-5-å·ç§¯æ­¥é•¿ï¼ˆStrided-convolutionsï¼‰" class="headerlink" title="1.5 å·ç§¯æ­¥é•¿ï¼ˆStrided convolutionsï¼‰"></a>1.5 å·ç§¯æ­¥é•¿ï¼ˆStrided convolutionsï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/116.png' width="80%" height="80%"/ loading="lazy">

<p>padding pï¼Œstride sï¼š</p>
<p>$$(n\times n) * (f\times f) \longrightarrow (\lfloor \frac{n+2p-f}{2} +1\rfloor)\times(\lfloor \frac{n+2p-f}{2} +1\rfloor)$$</p>
<p>æƒ¯ä¾‹ï¼šä¸æ˜¯æ•´æ•°å°±å‘ä¸‹å–æ•´ï¼Œè¶…å‡ºè¾¹ç¼˜çš„å·ç§¯ä¸è¿›è¡Œè®¡ç®—ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/117.png' width="80%" height="80%"/ loading="lazy">

<p>æ•°å­¦ä¸­çš„convolutionè¿˜è¦è¿›è¡Œåè½¬filterçš„æ“ä½œï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­åˆ™ä¸è¿›è¡Œã€‚æœºå™¨å­¦ä¹ çš„è¿ç®—åœ¨æ•°å­¦ä¸­è¢«ç§°ä¸ºcross-correlationï¼Œä½†åœ¨è®ºæ–‡ä¸­æˆ‘ä»¬å»¶ç»­convolutionè¿™ä¸€è¯´æ³•ï¼Œè¦æ³¨æ„ä¸æ•°å­¦ç¯å¢ƒä¸­çš„convolutionåšåŒºåˆ†ã€‚</p>
<h4 id="1-6-ä¸‰ç»´å·ç§¯ï¼ˆConvolutions-over-volumesï¼‰"><a href="#1-6-ä¸‰ç»´å·ç§¯ï¼ˆConvolutions-over-volumesï¼‰" class="headerlink" title="1.6 ä¸‰ç»´å·ç§¯ï¼ˆConvolutions over volumesï¼‰"></a>1.6 ä¸‰ç»´å·ç§¯ï¼ˆConvolutions over volumesï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/118.png' width="80%" height="80%"/ loading="lazy">

<p>æºå›¾åƒå’Œfilterçš„channelæ•°é‡å¿…é¡»ç›¸åŒã€‚æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªäºŒç»´è¾“å‡ºã€‚</p>
<p>å°†27ä¸ªæ•°å¯¹åº”ç›¸ä¹˜å†æ±‚å’Œï¼Œå¾—åˆ°è¾“å‡ºå›¾åƒä¸Šçš„ä¸€ä¸ªæ•°ã€‚</p>
<p>é€šè¿‡ä¸åŒçš„filterçš„å‚æ•°é€‰æ‹©ï¼Œè·å¾—ä¸åŒçš„ç‰¹å¾æ£€æµ‹å™¨ã€‚å¦‚å›¾ï¼Œå¯ä»¥æ„å»ºåªå…³å¿ƒçº¢è‰²é€šé“çš„çºµå‘è¾¹ç¼˜çš„filterï¼›ä¹Ÿå¯ä»¥æ„å»ºä¸å…³å¿ƒä»»ä½•é¢œè‰²ï¼Œåªå…³å¿ƒçºµå‘è¾¹ç¼˜çš„filterã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/119.png' width="80%" height="80%"/ loading="lazy">

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªfilterã€‚å¦‚å›¾ï¼Œå°†çºµå‘è¾¹ç¼˜filterã€æ¨ªå‘è¾¹ç¼˜filterå·ç§¯è€Œæ¥çš„ä¸¤å¼ å›¾ç‰‡ç»“åˆèµ·æ¥ï¼Œå¾—åˆ° $4\times 4\times 2$ çš„æ–°å›¾åƒã€‚è¿™ç§æ€æƒ³ä½¿æˆ‘ä»¬å¯ä»¥æ£€æµ‹å¾ˆå¤šä¸ªä¸åŒçš„ç‰¹å¾ï¼Œå¹¶ä¸”è¾“å‡ºçš„é€šé“æ•°ç­‰äºè¦æ£€æµ‹çš„ç‰¹å¾æ•°ï¼Œå³filterçš„ä¸ªæ•°ã€‚</p>
<h4 id="1-7-å•å±‚å·ç§¯ç½‘ç»œ"><a href="#1-7-å•å±‚å·ç§¯ç½‘ç»œ" class="headerlink" title="1.7 å•å±‚å·ç§¯ç½‘ç»œ"></a>1.7 å•å±‚å·ç§¯ç½‘ç»œ</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/120.png' width="80%" height="80%"/ loading="lazy">

<p>å•å±‚å·ç§¯ç½‘ç»œçš„å‰å‘ä¼ æ’­ï¼š</p>
<ul>
<li><p>å·ç§¯è¿ç®—ã€‚å¯¹åº” $w^{[1]}a^{[0]}$ã€‚$w^{[1]}$æ˜¯filterï¼Œ$a^{[0]}$æ˜¯æºå›¾åƒã€‚</p>
</li>
<li><p>å¯¹å¾—åˆ°çš„ $4\times 4$ çŸ©é˜µåŠ ä¸€ä¸ªæƒå€¼ï¼ˆä½¿ç”¨ broadcastingï¼‰ã€‚å¯¹åº” $z^{[1]} &#x3D; w^{[1]}a^{[0]} + b^{[1]}$ã€‚</p>
</li>
<li><p>è¿›è¡Œéçº¿æ€§å‡½æ•°å¤„ç†ï¼Œå¦‚ ReLUï¼Œå¾—åˆ°æ–°çš„  $4\times 4$ çŸ©é˜µã€‚å¯¹åº” $a^{[1]} &#x3D; g(z^{[1]})$ ã€‚</p>
</li>
<li><p>å¤šä¸ªfilterï¼Œè®¡ç®—ç»“æœå åŠ èµ·æ¥ï¼Œå¾—åˆ°  $$4\times 4 \times num_filters$$ çŸ©é˜µ</p>
</li>
</ul>
<p>å‚æ•°æ•°é‡ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/121.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸ç®¡è¾“å…¥å›¾ç‰‡çš„å°ºå¯¸æœ‰å¤šå¤§ï¼Œå‚æ•°çš„ä¸ªæ•°åªè·Ÿfilteræœ‰å…³ã€‚è¿™æ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªç‰¹æ€§ï¼Œå¯ä»¥é¿å…è¿‡æ‹Ÿåˆã€‚</p>
<p>ç¬¦å·æ€»ç»“ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/122.png' width="80%" height="80%"/ loading="lazy">

<p>æ¯å±‚è¾“å‡ºå›¾åƒçš„å°ºå¯¸ï¼š</p>
<ul>
<li><p>$n_H^{[l]} &#x3D; \lfloor \frac{n_H^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}} +1 \rfloor  $ </p>
</li>
<li><p>$n_W^{[l]} &#x3D; \lfloor \frac{n_W^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}} +1 \rfloor $</p>
</li>
</ul>
<p>æ¯ä¸ªfilterçš„å°ºå¯¸éœ€è¦åŒ¹é…ä¸Šå±‚è¾“å‡ºå›¾åƒçš„channelæ•°é‡ï¼š</p>
<ul>
<li>$f^{[l]} \times f^{[l]} \times n_c^{[l-1]}$</li>
</ul>
<p>æ‰€æœ‰çš„filterï¼š</p>
<ul>
<li>$f^{[l]} \times f^{[l]} \times n_c^{[l-1]} \times n_c^{[l]}$</li>
</ul>
<p>æœ¬å±‚å›¾åƒç»è¿‡biaså’Œéçº¿æ€§å‡½æ•°å¾—åˆ°çš„activationå°ºå¯¸ï¼š</p>
<ul>
<li>$a^{[l]}:n_H^{[l]} \times n_W^{[l]} \times n_c^{[l]}$</li>
</ul>
<p>ä¸€ä¸ªmini-batchçš„æ‰€æœ‰activationsï¼š</p>
<ul>
<li>$A^{[l]}:m \times n_H^{[l]} \times n_W^{[l]} \times n_c^{[l]}$</li>
</ul>
<p>ä¹Ÿä¸æ˜¯æ‰€æœ‰äººéƒ½ç”¨è¿™ä¸€å¥—æ ‡è®°æ³•ï¼Œæœ‰äº›äººæŠŠchannelçš„æ•°é‡å†™åœ¨å‰é¢ã€‚</p>
<h4 id="1-8-ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹"><a href="#1-8-ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹" class="headerlink" title="1.8 ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹"></a>1.8 ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹</h4><p>é¢„æµ‹ $39\times 39 \times 3$ çš„å›¾åƒä¸Šæ˜¯å¦æœ‰ä¸€åªçŒ«ï¼Œè®¾è®¡ä»¥ä¸‹å·ç§¯ç¥ç»ç½‘ç»œï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/123.png' width="80%" height="80%"/ loading="lazy">

<p>ç»è¿‡å‡ æ­¥å·ç§¯åï¼Œè·å¾— $7\times 7 \times 40$ çš„ç‰¹å¾å›¾ï¼Œå°†å®ƒä»¬å±•å¼€æˆ 1960 é•¿åº¦çš„åˆ—å‘é‡ï¼Œè¿›è¡Œlogisticæˆ–softmaxå›å½’ï¼Œé¢„æµ‹å›¾ç‰‡ä¸­æ˜¯å¦æœ‰çŒ«ã€‚</p>
<p>åœ¨å·ç§¯çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰è¿™æ ·çš„è¶‹åŠ¿ï¼šå›¾åƒçš„å¤§å°åœ¨å‡å°‘ï¼Œé€šé“æ•°é‡åœ¨å¢å¤šã€‚</p>
<p>é€‰æ‹©è¶…å‚æ•°æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œ$f,s,p,num_filters$ ç­‰ã€‚åœ¨ä¹‹åçš„è¯¾ç¨‹ä¸­ä¼šæä¾›ä¸€äº›å»ºè®®å’ŒæŒ‡å¯¼ã€‚</p>
<p>å·ç§¯ç¥ç»ç½‘ç»œé€šå¸¸ç”±ä¸‰ç§layerç»„æˆï¼š</p>
<ul>
<li>Convolutionï¼Œå·ç§¯å±‚ï¼ŒCONV</li>
<li>Poolingï¼Œæ± åŒ–å±‚ï¼ŒPOOL</li>
<li>Fully connectiedï¼Œå…¨è¿æ¥å±‚ï¼ŒFC</li>
</ul>
<h4 id="1-9-æ± åŒ–å±‚ï¼ˆPooling-layersï¼‰"><a href="#1-9-æ± åŒ–å±‚ï¼ˆPooling-layersï¼‰" class="headerlink" title="1.9 æ± åŒ–å±‚ï¼ˆPooling layersï¼‰"></a>1.9 æ± åŒ–å±‚ï¼ˆPooling layersï¼‰</h4><p>ä½¿ç”¨æ± åŒ–å±‚ï¼Œæ¥ç¼©å‡æ¨¡å‹çš„å¤§å°ï¼Œæé«˜è®¡ç®—é€Ÿåº¦ï¼ŒåŒæ—¶è®©æ‰€æå–çš„ç‰¹å¾robustã€‚</p>
<p>max poolingï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/124.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>max poolingå¯¹æ¯ä¸€ä¸ªé€šé“ç‹¬ç«‹å¤„ç†ï¼Œä¸æ”¹å˜é€šé“ä¸ªæ•°ã€‚</p>
</li>
<li><p>æœ‰ä¸¤ä¸ªè¶…å‚æ•° $f,s$ ï¼Œä¸éœ€è¦ç½‘ç»œå­¦ä¹ ï¼Œæ‰‹åŠ¨è®¾ç½®åå°±ä¸å†æ”¹å˜ã€‚</p>
</li>
<li><p>å¯ä»¥ç›´è§‰ç†è§£ä¸ºï¼šæ•°å­—å¤§æ„å‘³ç€å¯èƒ½æå–äº†æŸäº›ç‰¹å®šç‰¹å¾ã€‚</p>
</li>
</ul>
<p>average poolingï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/125.png' width="80%" height="80%"/ loading="lazy">

<p>è·Ÿmax poolingå·®ä¸å¤šã€‚</p>
<p>é€šå¸¸ï¼Œmax poolingæ›´åŠ å¸¸ç”¨ï¼›ä½†æœ‰æ—¶ï¼Œåœ¨å¾ˆæ·±çš„ç¥ç»ç½‘ç»œä¹Ÿä¼šç”¨åˆ°average poolingã€‚ï¼ˆæœ‰æ—¶ç”¨ï¼Œåœ¨ä¸‹å‘¨è®²ï¼‰</p>
<p>æ± åŒ–å±‚çš„è¶…å‚æ•°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/126.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>æœ‰å¸¸ç”¨çš„è®¾ç½® $f&#x3D;2,s&#x3D;2$ ï¼Œæ„å‘³ç€æŠŠå›¾ç‰‡é•¿å®½éƒ½ç¼©å°ä¸€åŠã€‚</p>
</li>
<li><p>å¯ä»¥è‡ªå·±å¢åŠ paddingå‚æ•° $p$ï¼Œä½†æå°‘è¿™æ ·åšã€‚ï¼ˆæœ‰æ„å¤–ï¼Œåœ¨ä¸‹å‘¨è®²ï¼‰</p>
</li>
<li><p>$n_H \times n_W \times n_c \longrightarrow \lfloor \frac{n_H-f}{s}+1 \rfloor \times \lfloor \frac{n_H-f}{s}+1 \rfloor \times n_c$ ï¼Œ<strong>æ± åŒ–å±‚ä¸æ”¹å˜é€šé“çš„ä¸ªæ•°</strong>ã€‚</p>
</li>
<li><p><strong>æ± åŒ–å±‚æ²¡æœ‰éœ€è¦è®­ç»ƒçš„å‚æ•°ï¼Œåªæœ‰è¶…å‚æ•°</strong>ã€‚</p>
</li>
</ul>
<h4 id="1-10-å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆConvolutional-neural-network-exampleï¼‰"><a href="#1-10-å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆConvolutional-neural-network-exampleï¼‰" class="headerlink" title="1.10 å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆConvolutional neural network exampleï¼‰"></a>1.10 å·ç§¯ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆConvolutional neural network exampleï¼‰</h4><p>æ‰‹å†™æ•°å­—è¯†åˆ«ï¼ˆè·Ÿ LeNet-5 ç›¸ä¼¼ï¼‰ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/127.png' width="80%" height="80%"/ loading="lazy">

<p>æœ‰ä¸€ç§å«æ³•æ˜¯æŠŠ CONV+POOL ä½œä¸ºä¸€å±‚å·ç§¯ï¼Œå› ä¸º POOL å±‚æ²¡æœ‰æƒé‡ï¼Œåªæœ‰è¶…å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­åŒæ ·å°† CONV1+POOL1 ä½œä¸º layer 1ã€‚</p>
<p>å…¨è¿æ¥å±‚ç›¸å½“äºå•å±‚æ™®é€šç¥ç»ç½‘ç»œï¼Œç¥ç»å…ƒå…¨éƒ¨ç›¸è¿ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªæƒå€¼ã€‚</p>
<ul>
<li><p>ç¬¬ä¸€å±‚ï¼šå·ç§¯+æœ€å¤§æ± åŒ–ã€‚å‚æ•°æ˜¯6ä¸ªfiltersã€‚</p>
</li>
<li><p>ç¬¬äºŒå±‚ï¼šå·ç§¯+æœ€å¤§æ± åŒ–ã€‚å‚æ•°æ˜¯16ä¸ªfiltersã€‚</p>
</li>
<li><p>ç¬¬ä¸‰å±‚ï¼šflattenåï¼Œ400åˆ°120çš„å…¨è¿æ¥ã€‚å‚æ•°æ˜¯ $w,b$ã€‚</p>
</li>
<li><p>ç¬¬å››å±‚ï¼š120åˆ°84çš„å…¨è¿æ¥ã€‚å‚æ•°æ˜¯ $w,b$ã€‚</p>
</li>
<li><p>è¾“å‡ºï¼šå¯¹84ä¸ªç¥ç»å…ƒè¿›è¡Œ softmax ï¼Œé¢„æµ‹æ‰‹å†™æ•°å­—ã€‚</p>
</li>
</ul>
<p>å¸¸è§çš„æ¨¡å¼ï¼š</p>
<ul>
<li>å›¾åƒå°ºå¯¸é€æ¸å˜å°ï¼Œé€šé“æ•°é‡é€æ¸å¢å¤šã€‚</li>
<li>ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯å±‚åæ¥ä¸€ä¸ªæ± åŒ–å±‚ï¼Œé‡å¤å‡ æ¬¡ï¼Œæœ€åæ˜¯å‡ ä¸ªå…¨è¿æ¥å±‚ï¼Œæœ€ç»ˆè¿›è¡Œsoftmaxç­‰å‡½æ•°è¾“å‡ºã€‚</li>
</ul>
<p>å¸¸è§„åšæ³•ï¼šå°½é‡ä¸è¦è‡ªå·±è®¾ç½®è¶…å‚æ•°ï¼Œè€Œæ˜¯æŸ¥çœ‹æ–‡çŒ®ï¼Œä½¿ç”¨åˆ«äººåœ¨ä»»åŠ¡ä¸­æ•ˆæœå¾ˆå¥½çš„æ¶æ„ã€‚ï¼ˆä¸‹å‘¨ç»†è®²ï¼‰</p>
<p>å·ç§¯ç¥ç»ç½‘ç»œçš„ä¸€äº›ç»†èŠ‚ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/128.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li>å‚æ•°<ul>
<li>æ± åŒ–å±‚æ²¡æœ‰ä»»ä½•å‚æ•°ã€‚</li>
<li>å·ç§¯å±‚å‚æ•°æ•°é‡è¾ƒå°ï¼Œè¿™ç‚¹åœ¨ä¹‹å‰æè¿‡ã€‚åªè·Ÿfilteræœ‰å…³ï¼Œè·Ÿå›¾ç‰‡çš„å°ºå¯¸æ— å…³ã€‚<ul>
<li>416 &#x3D; 16channel * (5*5filter + 1bias)ï¼Œæ¯ä¸ªfilteræœ‰ä¸€ä¸ªåç½®ã€‚</li>
</ul>
</li>
<li>å¤§å¤šæ•°å‚æ•°å­˜åœ¨äºå…¨è¿æ¥å±‚ã€‚<ul>
<li>48001 &#x3D; 120 * 400 + 1biasï¼Œæ¯å±‚ä¸€ä¸ªåç½®ï¼Œå¯ä»¥ç±»æ¯”æ™®é€šçš„ç¥ç»ç½‘ç»œã€‚</li>
</ul>
</li>
</ul>
</li>
<li>æ¿€æ´»å€¼<ul>
<li>éšç€ç¥ç»ç½‘ç»œåŠ æ·±ï¼Œæ¿€æ´»å€¼ä¼šé€æ¸å˜å°ã€‚å¦‚æœæ¿€æ´»å€¼ä¸‹é™å¤ªå¿«ï¼Œä¹Ÿä¼šå½±å“ç¥ç»ç½‘ç»œçš„è¡¨ç°ã€‚</li>
</ul>
</li>
</ul>
<p>å·ç§¯ç¥ç»ç½‘ç»œçš„é‡ç‚¹æ˜¯å¦‚ä½•æ›´å¥½åœ°ç»„ç»‡å·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚ã€‚è¿™è¦æ±‚æˆ‘ä»¬å¤šé˜…è¯»è®ºæ–‡ï¼Œäº†è§£åˆ«äººçš„æ¨¡å‹ï¼Œå¾—åˆ°è‡ªå·±çš„insight&#x2F;intuationã€‚ä¸‹å‘¨å°†ä»‹ç»ä¸€äº›è¡¨ç°è‰¯å¥½çš„æ¨¡å‹ã€‚</p>
<h4 id="1-11-ä¸ºä»€ä¹ˆä½¿ç”¨å·ç§¯ï¼Ÿï¼ˆWhy-convolutions-ï¼‰"><a href="#1-11-ä¸ºä»€ä¹ˆä½¿ç”¨å·ç§¯ï¼Ÿï¼ˆWhy-convolutions-ï¼‰" class="headerlink" title="1.11 ä¸ºä»€ä¹ˆä½¿ç”¨å·ç§¯ï¼Ÿï¼ˆWhy convolutions?ï¼‰"></a>1.11 ä¸ºä»€ä¹ˆä½¿ç”¨å·ç§¯ï¼Ÿï¼ˆWhy convolutions?ï¼‰</h4><p>å·ç§¯ç¥ç»ç½‘ç»œä¸ºä½•æœ‰æ•ˆï¼Ÿå¦‚ä½•æ•´åˆè¿™äº›å·ç§¯ï¼Ÿå¦‚ä½•é€šè¿‡æ ‡æ³¨è¿‡çš„è®­ç»ƒé›†è¿›è¡Œå·ç§¯ç¥ç»ç½‘ç»œçš„è®­ç»ƒï¼Ÿ</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/129.png' width="80%" height="80%"/ loading="lazy">

<p>å·ç§¯ç¥ç»ç½‘ç»œç›¸æ¯”åªæœ‰å…¨è¿æ¥çš„æ™®é€šç¥ç»ç½‘ç»œçš„ä¼˜åŠ¿ï¼šå‚æ•°å…±äº«å’Œç¨€ç–è¿æ¥ã€‚</p>
<ul>
<li><p>å‚æ•°å…±äº«ï¼šfilterçš„å‚æ•°å¯ä»¥ç”¨äºå›¾ç‰‡çš„ä»»ä½•åŒºåŸŸï¼Œæ¥æå–ç‰¹å¾ã€‚</p>
</li>
<li><p>ç¨€ç–é“¾æ¥ï¼šè¾“å‡ºå›¾åƒçš„æ¯ä¸ªåƒç´ ä»…ä¸å‡ ä¸ªæºå›¾åƒçš„åƒç´ æœ‰å…³ï¼ˆä¸æ˜¯å…¨è¿æ¥ï¼‰ã€‚</p>
</li>
</ul>
<p>è¿™ä¸¤ç‚¹ä¿è¯äº†<strong>å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥ç”¨æ¯”è¾ƒå°çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”ä¸å®¹æ˜“è¿‡æ‹Ÿåˆ</strong>ã€‚</p>
<p>å·ç§¯ç¥ç»ç½‘ç»œå–„äºæ•æ‰å¹³ç§»ä¸å˜ï¼ˆtranslation invarianceï¼‰ï¼Œå› ä¸ºç¥ç»ç½‘ç»œçš„å·ç§¯ç»“æ„ä¿è¯äº†ï¼Œå³ä½¿ç§»åŠ¨å‡ ä¸ªåƒç´ ï¼Œå›¾ç‰‡ä¾ç„¶å…·æœ‰éå¸¸ç›¸ä¼¼çš„ç‰¹å¾ã€‚</p>
<p>è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œçš„è¿‡ç¨‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/130.png' width="80%" height="80%"/ loading="lazy">

<p>é€šè¿‡æ¢¯åº¦ä¸‹é™æˆ–å…¶ä»–ä¼˜åŒ–ç®—æ³•ï¼Œä¼˜åŒ–å‚æ•°ï¼Œè®©æŸå¤±å‡½æ•° $J$ é™åˆ°æœ€ä½ã€‚</p>
<h3 id="ç¬¬äºŒå‘¨-æ·±åº¦å·ç§¯ç½‘ç»œï¼šå®ä¾‹æ¢ç©¶-Deep-convolutional-models-case-studies"><a href="#ç¬¬äºŒå‘¨-æ·±åº¦å·ç§¯ç½‘ç»œï¼šå®ä¾‹æ¢ç©¶-Deep-convolutional-models-case-studies" class="headerlink" title="ç¬¬äºŒå‘¨ æ·±åº¦å·ç§¯ç½‘ç»œï¼šå®ä¾‹æ¢ç©¶(Deep convolutional models: case studies)"></a>ç¬¬äºŒå‘¨ æ·±åº¦å·ç§¯ç½‘ç»œï¼šå®ä¾‹æ¢ç©¶(Deep convolutional models: case studies)</h3><p>ä¸€äº›å·ç§¯ç¥ç»ç½‘ç»œçš„å®ä¾‹åˆ†æï¼šClassic networksï¼ˆLeNet-5ï¼ŒAlexNetï¼ŒVGGï¼‰ï¼ŒResNetï¼ŒInceptionï¼ˆ1Ã—1å·ç§¯ï¼‰ï¼›è®¡ç®—æœºè§†è§‰é—®é¢˜å»ºç«‹åœ¨å°æ•°æ®ç³»ç»Ÿä¸Šï¼Œéœ€è¦è¿›è¡Œï¼šæ•°æ®å¢å¼ºï¼Œè¿ç§»è®­ç»ƒï¼Œä½¿ç”¨å¼€æºã€‚</p>
<h4 id="2-1-ä¸ºä»€ä¹ˆè¦è¿›è¡Œå®ä¾‹æ¢ç©¶ï¼Ÿ"><a href="#2-1-ä¸ºä»€ä¹ˆè¦è¿›è¡Œå®ä¾‹æ¢ç©¶ï¼Ÿ" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆè¦è¿›è¡Œå®ä¾‹æ¢ç©¶ï¼Ÿ"></a>2.1 ä¸ºä»€ä¹ˆè¦è¿›è¡Œå®ä¾‹æ¢ç©¶ï¼Ÿ</h4><p>å¥½çš„ç½‘ç»œæ¶æ„å¯èƒ½åœ¨å…¶ä»–ä»»åŠ¡ä¸­ä¹Ÿå¥½ç”¨ã€‚</p>
<h4 id="2-2-ç»å…¸ç½‘ç»œ"><a href="#2-2-ç»å…¸ç½‘ç»œ" class="headerlink" title="2.2 ç»å…¸ç½‘ç»œ"></a>2.2 ç»å…¸ç½‘ç»œ</h4><p>çº¢ç¬”å†™çš„æ˜¯ç°åœ¨åŸºæœ¬ä¸ç”¨çš„æŠ€æœ¯ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/131.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨LeNetæå‡ºæ—¶ï¼Œä½¿ç”¨çš„è¿™äº›æŠ€æœ¯ç°åœ¨å·²ç»åŸºæœ¬è¢«å–ä»£äº†ï¼šsigmoidå’Œtanhæ¿€æ´»å‡½æ•°ï¼›å¹³å‡æ± åŒ–ï¼›valid å·ç§¯ï¼›å—é™äºè®¡ç®—èƒ½åŠ›ï¼Œå·ç§¯çš„è®¡ç®—æ–¹æ³•ä¹Ÿå¾ˆå¤æ‚ã€‚ç°åœ¨ç”¨çš„æ˜¯ï¼šReLUï¼›æœ€å¤§æ± åŒ–ï¼›sameå·ç§¯ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/132.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨AlexNetä¸­ï¼Œä½¿ç”¨äº†ReLUã€sameå·ç§¯ã€max-poolã€è®¾ç½®strideã€softmaxç­‰æ–°æŠ€æœ¯ã€‚</p>
<p>LeNet-5å¤§çº¦æœ‰60,000ä¸ªå‚æ•°ï¼›AlexNetæœ‰å¤§çº¦60,000,000ä¸ªå‚æ•°ã€‚</p>
<p>åœ¨AlexNetæå‡ºæ—¶ï¼ŒGPUçš„å¤„ç†é€Ÿåº¦è¿˜æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥AlexNeté‡‡ç”¨äº†å¾ˆå¤æ‚çš„æ–¹æ³•åœ¨ä¸¤ä¸ªGPUä¸Šè®­ç»ƒã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/133.png' width="80%" height="80%"/ loading="lazy">

<p>VGG-16ç½‘ç»œæ²¡æœ‰å¾ˆå¤šè¶…å‚æ•°ï¼Œä¸“æ³¨äºæ„å»ºå·ç§¯å±‚ã€‚16çš„æ„æ€æ˜¯ç½‘ç»œä¸­æœ‰16å±‚æœ‰æƒå€¼çš„åœ°æ–¹ï¼ˆ2+2+3+3+3&#x3D;13å·ç§¯å±‚ï¼Œ3å…¨è¿æ¥å±‚ï¼‰ã€‚</p>
<ul>
<li>CONV &#x3D; 3Ã—3 filter, s&#x3D;1, same</li>
<li>MAX-POOL &#x3D; 2Ã—2, s&#x3D;2</li>
</ul>
<p>VGG-16 æœ‰çº¦ 138,000,000 ä¸ªå‚æ•°ï¼Œä½†ç»“æ„å¾ˆè§„æ•´ï¼Œå›¾åƒç¼©å°çš„æ¯”ä¾‹å’Œchannelå¢åŠ çš„æ¯”ä¾‹æ˜¯æœ‰è§„å¾‹çš„ã€‚åé¢çš„VGG-19æ¯”è¿™ä¸ªæ¨¡å‹æ›´å¤§ï¼Œä½†è¿™ä¸¤ä¸ªæ¨¡å‹è¡¨ç°å·®ä¸å¤šã€‚</p>
<h4 id="2-3-æ®‹å·®ç½‘ç»œï¼ˆResidual-Networks-ResNets-ï¼‰"><a href="#2-3-æ®‹å·®ç½‘ç»œï¼ˆResidual-Networks-ResNets-ï¼‰" class="headerlink" title="2.3 æ®‹å·®ç½‘ç»œï¼ˆResidual Networks (ResNets)ï¼‰"></a>2.3 æ®‹å·®ç½‘ç»œï¼ˆResidual Networks (ResNets)ï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/134.png' width="80%" height="80%"/ loading="lazy">

<p>å¾ˆæ·±çš„ç¥ç»ç½‘ç»œéš¾ä»¥è®­ç»ƒï¼Œå› ä¸ºå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚ä½¿ç”¨ResNetï¼Œå¯ä»¥è®­ç»ƒåŒ—äº¬æ·±å±‚çš„ç¥ç»ç½‘ç»œã€‚</p>
<p>æ¯ä¸¤å±‚ç»„æˆä¸€ä¸ªæ®‹å·®å—ï¼šæµ…å±‚çš„æ¿€æ´»å€¼é€šè¿‡short cutï¼Œç›´æ¥è¾“å…¥åˆ°æ·±å±‚çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ä¸­ã€‚</p>
<p>$$a^{[l+2]} &#x3D; g(z^{[l+2]}+a^{[l]})$$ </p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/135.png' width="80%" height="80%"/ loading="lazy">

<p>è®ºä¸­å°†æ²¡æœ‰ä½¿ç”¨æ®‹å·®å—çš„ç¥ç»ç½‘ç»œå«åšPlainç½‘ç»œï¼Œåœ¨ç†è®ºä¸Šå±‚æ•°è¶Šå¤šï¼ŒæŸå¤±è¶Šå°ï¼›ä½†å®é™…æƒ…å†µæ˜¯ï¼Œç½‘ç»œè¶Šæ·±ï¼Œåœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®ä¼šåå¼¹ã€‚ResNetå°±ä¼šè§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<h4 id="2-4-æ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ"><a href="#2-4-æ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ" class="headerlink" title="2.4 æ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ"></a>2.4 æ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/136.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœè®© $w,b$ éƒ½ä¸º0ï¼Œé‚£ä¹ˆ $a^{[l+1]} &#x3D; a{^{[l]}}$ ï¼Œå­¦ä¹ æ’ç­‰å‡½æ•°å¯¹æ®‹å·®å—æ¥è¯´å¾ˆç®€å•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶åŠ ä¸Šä¸€ä¸ªæ®‹å·®å—ï¼ˆä¸¤å±‚ç¥ç»ç½‘ç»œï¼‰ï¼Œæ•ˆç‡ä¹Ÿä¸é€Šè‰²äºæ›´ç®€å•çš„ç¥ç»ç½‘ç»œã€‚å¹¶ä¸”æ®‹å·®å—æ·»åŠ çš„ä½ç½®ä¹Ÿä¸å½±å“ç½‘ç»œçš„è¡¨ç°ã€‚</p>
<p>åœ¨ä¸ä¼¤å®³æ€§èƒ½çš„åŸºç¡€ä¸Šï¼Œå¦‚æœæ®‹å·®å—çš„éšè—å•å…ƒå­¦ä¹ åˆ°ä¸€äº›æœ‰ç”¨ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±èƒ½æ¯”æ’ç­‰å‡½æ•°è¡¨ç°å¾—æ›´å¥½ã€‚</p>
<p>è€Œå¯¹äºplainç¥ç»ç½‘ç»œæ¥è¯´ï¼Œå°±ç®—æ˜¯å­¦ä¹ æ’ç­‰å‡½æ•°çš„å‚æ•°éƒ½å¾ˆå›°éš¾ï¼Œå› æ­¤å¾ˆå¤šå±‚æœ€åçš„è¡¨ç°å˜å·®äº†ã€‚</p>
<p>å¦å¤–ï¼ŒResNetä½¿ç”¨sameå·ç§¯ï¼Œä¿è¯ $z^{[l+2]}$ å’Œ $a^{[l]}$ æœ‰ç›¸åŒçš„ç»´åº¦ï¼Œå¯ä»¥ç›¸åŠ ã€‚å¦‚æœè¾“å…¥å’Œè¾“å‡ºç»´åº¦ä¸ä¸€æ ·ï¼Œå°±å†å¢åŠ ä¸€ä¸ªçŸ©é˜µ $w_s$ ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/137.png' width="80%" height="80%"/ loading="lazy">

<p>å‡ ä¸ªä¹‹å‰æåˆ°çš„ç»†èŠ‚ï¼š</p>
<ul>
<li>ä½¿ç”¨3Ã—3 sameå·ç§¯ï¼Œä¿è¯ $z^{[l+2]}$ å’Œ $a^{[l]}$ æœ‰ç›¸åŒçš„ç»´åº¦ï¼Œå¯ä»¥ç›¸åŠ ã€‚</li>
<li>pool-like å±‚ï¼Œè¿›è¡Œ &#x2F;2 é™ç»´æ“ä½œã€‚</li>
<li>CONV-CONV-CONV-POOL äº¤æ›¿è¿›è¡Œçš„ç»“æ„ã€‚</li>
</ul>
<h4 id="2-5-ç½‘ç»œä¸­çš„ç½‘ç»œ-x2F-1Ã—1å·ç§¯"><a href="#2-5-ç½‘ç»œä¸­çš„ç½‘ç»œ-x2F-1Ã—1å·ç§¯" class="headerlink" title="2.5 ç½‘ç»œä¸­çš„ç½‘ç»œ &#x2F; 1Ã—1å·ç§¯"></a>2.5 ç½‘ç»œä¸­çš„ç½‘ç»œ &#x2F; 1Ã—1å·ç§¯</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/138.png' width="80%" height="80%"/ loading="lazy">

<p>1Ã—1å·ç§¯æ·»åŠ äº†éçº¿æ€§å‡½æ•°ï¼Œå¯ä»¥è®©ç½‘ç»œå­¦ä¹ æ›´å¤æ‚çš„å‡½æ•°ã€‚</p>
<p>1Ã—1å·ç§¯å¯¹å•é€šé“ä½œç”¨ä¸å¤§ï¼Œä½†å¯¹äºå¤šé€šé“ï¼Œå¯ä»¥æŠŠæ‰€æœ‰é€šé“ç›¸åŒä½ç½®çš„æ•°è¾“å‡ºæˆä¸€ä¸ªæ•°ï¼ˆå¯¹åº”ä½ç½®ç›¸ä¹˜ -&gt; ç›¸åŠ  -&gt; ReLUï¼‰ã€‚å¦‚æœfilteræ•°é‡ä¸æ­¢ä¸€ä¸ªï¼Œå¯ä»¥è¾“å‡ºå¤šä¸ªé€šé“ã€‚</p>
<p>è®ºæ–‡åå­—å« network in network ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥ç§°ä¸º1Ã—1å·ç§¯ã€‚è®ºæ–‡ä¸­çš„æ¶æ„æ²¡æœ‰å¾—åˆ°å¹¿æ³›ä½¿ç”¨ï¼Œä½†è¿™ç§æ–¹æ³•åˆ©ç”¨åˆ°äº†ä¹‹åçš„Inceptionç­‰æ¨¡å‹ä¸Šã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/139.png' width="80%" height="80%"/ loading="lazy">

<p>ä½œç”¨å¦‚ä¸Šå›¾ã€‚POOLçš„ä½œç”¨æ˜¯å‹ç¼© $n_H,n_W$ï¼Œè€Œ 1Ã—1 å·ç§¯å¯ä»¥å‹ç¼© $n_C$ï¼Œå‡å°‘ä¿¡é“æ•°é‡æ¥ç®€åŒ–è®¡ç®—ã€‚å½“ç„¶è®©ä¿¡é“æ•°é‡ä¿æŒä¸å˜æˆ–è€…å¢åŠ ä¹Ÿå¯ä»¥ã€‚</p>
<h4 id="2-6-Inception-æ¨¡å—ç®€ä»‹ã€"><a href="#2-6-Inception-æ¨¡å—ç®€ä»‹ã€" class="headerlink" title="2.6 Inception æ¨¡å—ç®€ä»‹ã€"></a>2.6 Inception æ¨¡å—ç®€ä»‹ã€</h4><p>Inceptionæ¨¡å—ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/140.png' width="80%" height="80%"/ loading="lazy">

<p>Inceptionï¼šä¸éœ€è¦äººæ¥å†³å®šä½¿ç”¨ä»€ä¹ˆè§„æ ¼çš„filterã€æ˜¯å¦ä½¿ç”¨POOLã€‚ç½‘ç»œç»“æ„æ›´å¤æ‚ä½†è¡¨ç°æ›´å¥½ã€‚</p>
<p>å¦‚å›¾ï¼ŒInceptionæ¨¡å—è¾“å…¥æŸä¸ªé‡ï¼Œç»è¿‡ä¸åŒçš„å¤„ç†ï¼Œè¾“å‡ºå°†è¿™äº›ç»“æœå åŠ èµ·æ¥ã€‚</p>
<p>Inceptionç½‘ç»œä¸éœ€è¦äººä¸ºå†³å®šä½¿ç”¨å“ªä¸ªfitlerï¼Œæˆ–æ˜¯å¦éœ€è¦æ± åŒ–ï¼Œè€Œæ˜¯ç”±ç½‘ç»œè‡ªè¡Œå†³å®šè¿™äº›å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç»™ç½‘ç»œæ·»åŠ è¿™äº›å‚æ•°çš„æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œç„¶åæŠŠè¿™äº›è¾“å‡ºè¿æ¥èµ·æ¥ï¼Œè®©ç½‘ç»œå­¦ä¹ ä»–éœ€è¦ä»€ä¹ˆæ ·çš„å‚æ•°ã€‚</p>
<p>ä¸ºäº†ç»´æŒæ‰€æœ‰çš„ç»´åº¦ç›¸åŒï¼Œå¯¹å·ç§¯è¦ä½¿ç”¨filterå·ç§¯ï¼Œå¯¹æ± åŒ–è¦ä½¿ç”¨paddingï¼ˆæ¯”è¾ƒç‰¹æ®Šçš„POOLï¼‰ã€‚</p>
<p>å·¨å¤§çš„è¿ç®—é‡ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/141.png' width="80%" height="80%"/ loading="lazy">

<p>Inceptionæ¨¡å—çš„é—®é¢˜æ˜¯å‚æ•°å¤šï¼Œè®¡ç®—æˆæœ¬é«˜ã€‚ä»¥ 5Ã—5å·ç§¯çš„ä¸€éƒ¨åˆ†ä¸ºä¾‹ï¼šéœ€è¦ 5Ã—5Ã—192 filterï¼Œå¯¹äºè¾“å‡ºçš„æ¯ä¸ªæ•°éƒ½è¦åš filter è§„æ ¼æ¬¡æ•°çš„ä¹˜æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸€å…±è¦åš $(28Ã—28Ã—32) * (5Ã—5Ã—192) â‰ˆ 120 M$ æ¬¡ä¹˜æ³•ã€‚</p>
<p>æ”¹è¿›æ–¹æ³•ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/142.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨ 1Ã—1 å·ç§¯å¾—åˆ°ç›¸åŒè§„æ ¼çš„è¾“å‡ºï¼Œé€šè¿‡å‹ç¼©æˆè¾ƒå°çš„ä¸­é—´å½¢æ€ï¼ˆç“¶é¢ˆå±‚bottleneck layerï¼‰ã€‚</p>
<p>ä¸€å…±è¦åš $(28Ã—28Ã—16) * (1Ã—1Ã—192)  + (28Ã—28Ã—32) * (5Ã—5Ã—16) â‰ˆ 2.4 M + 10 M &#x3D; 12.4 M$ æ¬¡è¿ç®—ï¼Œä¹˜æ³•è®¡ç®—çš„æˆæœ¬å¤§çº¦å˜ä¸ºåŸæ¥çš„ååˆ†ä¹‹ä¸€ã€‚</p>
<p>é€šè¿‡åˆç†æ„å»ºç“¶é¢ˆå±‚ï¼Œæ—¢å¯ä»¥æ˜¾è‘—ç¼©å°è¡¨ç¤ºå±‚çš„è§„æ¨¡ï¼Œåˆä¸ä¼šé™ä½ç½‘ç»œæ€§èƒ½ï¼Œä»è€Œå¤§é‡èŠ‚çœè®¡ç®—æˆæœ¬ã€‚</p>
<h4 id="2-7-Inception-ç½‘ç»œ-x2F-GoogLeNetï¼ˆInception-networkï¼‰"><a href="#2-7-Inception-ç½‘ç»œ-x2F-GoogLeNetï¼ˆInception-networkï¼‰" class="headerlink" title="2.7 Inception ç½‘ç»œ &#x2F; GoogLeNetï¼ˆInception networkï¼‰"></a>2.7 Inception ç½‘ç»œ &#x2F; GoogLeNetï¼ˆInception networkï¼‰</h4><p>Inceptionæ¨¡å—ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/143.png' width="80%" height="80%"/ loading="lazy">



<p>Inceptionç½‘ç»œï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/144.png' width="80%" height="80%"/ loading="lazy">

<p>çº¢åœˆï¼šç”±Inceptionæ¨¡å—é‡å¤å †å è€Œæ¥ï¼Œæœ‰äº›max-poolingå±‚ï¼Œæ¥æ”¹å˜é•¿å’Œå®½ã€‚</p>
<p>ç»¿åœˆï¼šä¸€äº›åˆ†æ”¯ï¼Œé€šè¿‡ä¸€äº›éšè—å±‚ï¼Œåšä¸€ä¸ªsoftmaxåˆ†ç±»ã€‚å®ƒç¡®ä¿äº†å³ä½¿æ˜¯éšè—å•å…ƒå’Œä¸­é—´å±‚ï¼Œä¹Ÿå‚ä¸äº†ç‰¹å¾è¿ç®—ï¼Œä¹Ÿèƒ½è¿›è¡Œé¢„æµ‹å›¾ç‰‡çš„åˆ†ç±»ã€‚å¹¶ä¸”é˜²æ­¢ç½‘ç»œè¿‡æ‹Ÿåˆã€‚</p>
<p>å…¶ä»–ï¼šä¹Ÿæœ‰å˜ä½“æŠŠ Inception å’Œ ResNet ç»“åˆèµ·æ¥ã€‚å¯ä»¥çœ‹Inceptionçš„åç»­è®ºæ–‡ã€‚</p>
<h4 id="2-8-ä½¿ç”¨å¼€æºçš„å®ç°æ–¹æ¡ˆ"><a href="#2-8-ä½¿ç”¨å¼€æºçš„å®ç°æ–¹æ¡ˆ" class="headerlink" title="2.8 ä½¿ç”¨å¼€æºçš„å®ç°æ–¹æ¡ˆ"></a>2.8 ä½¿ç”¨å¼€æºçš„å®ç°æ–¹æ¡ˆ</h4><p>å¾ˆå¤šç¥ç»ç½‘ç»œéš¾ä»¥å¤ç°ï¼Œå› ä¸ºä¸€äº›è¶…å‚æ•°çš„ç»†èŠ‚è°ƒæ•´ä¼šå½±å“æ€§èƒ½ã€‚</p>
<p>å…ˆä»ä½¿ç”¨å¼€æºçš„å®ç°å¼€å§‹ã€‚</p>
<h4 id="2-9-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰"><a href="#2-9-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰" class="headerlink" title="2.9 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰"></a>2.9 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰</h4><p>ç”¨è¿ç§»å­¦ä¹ æŠŠå…¬å…±æ•°æ®é›†çš„çŸ¥è¯†è¿ç§»åˆ°æˆ‘ä»¬è‡ªå·±çš„é—®é¢˜ä¸Šã€‚</p>
<p>åœ¨åšä¸€ä¸ªè®¡ç®—æœºè§†è§‰çš„åº”ç”¨æ—¶ï¼Œç›¸æ¯”äºä»å¤´è®­ç»ƒæƒé‡ã€éšæœºåˆå§‹åŒ–ï¼Œå¯ä»¥<strong>ä¸‹è½½å¼€æºçš„ã€åˆ«äººå·²ç»è®­ç»ƒå¥½çš„ç½‘ç»œç»“æ„çš„æƒé‡ï¼Œä½œä¸ºæˆ‘ä»¬æ¨¡å‹çš„åˆå§‹åŒ–</strong>ã€‚</p>
<p>ä»¥çŒ«å’ªåˆ†ç±»é—®é¢˜ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢„è®­ç»ƒçš„ ImageNet æ¨¡å‹ï¼Œå°†æœ€ååˆ†ç±»æ”¹ä¸º softmax åˆ†ç±»è¿™æ˜¯çŒ«æ˜¯Tiggerï¼Œè¿˜æ˜¯Mistyï¼Œè¿˜æ˜¯éƒ½ä¸æ˜¯ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/145.png' width="80%" height="80%"/ loading="lazy">

<p><strong>å›¾ä¸Š</strong>ï¼šæŠŠå‰é¢é¢„è®­ç»ƒçš„æ¨¡å‹å½“ä½œå†»ç»“çš„ï¼Œ<strong>åªè®­ç»ƒè·Ÿæˆ‘ä»¬çš„ softmax å±‚æœ‰å…³çš„å‚æ•°</strong>ã€‚</p>
<ul>
<li><p>æˆ–è®¸å¯ä»¥è®¾ç½®<code>trainableParameter = 0â€‹</code>æˆ–<code>freeze=1</code>è¿™æ ·çš„å‚æ•°ï¼ŒæŒ‡å®šä¸è®­ç»ƒç‰¹å®šå±‚çš„æƒé‡ã€‚</p>
</li>
<li><p>å¯ä»¥æŠŠå‰é¢å†»ç»“çš„æ¨¡å‹çœ‹ä½œä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œè¾“å‡ºä¸€ä¸ªç‰¹å¾å‘é‡ã€‚åªè®­ç»ƒåé¢çš„softmaxå±‚ï¼Œç”¨è¿™ä¸ªç‰¹å¾å‘é‡æ¥åšé¢„æµ‹ã€‚å› æ­¤å¯ä»¥<strong>æå‰è®¡ç®—è®­ç»ƒé›†ä¸­æ‰€æœ‰æ ·æœ¬çš„è¿™ä¸€å±‚çš„æ¿€æ´»å€¼</strong>ï¼Œç„¶åå­˜åˆ°ç¡¬ç›˜é‡Œï¼Œåœ¨æ­¤ä¹‹ä¸Šè®­ç»ƒsoftmaxå±‚ã€‚è¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éå†æ•°æ®é›†é‡æ–°è®¡ç®—è¿™ä¸€å±‚çš„æ¿€æ´»å€¼äº†ã€‚</p>
</li>
</ul>
<p><strong>å›¾ä¸­</strong>ï¼šå¦‚æœæ¨¡å‹ç‰¹åˆ«å¤§ï¼Œå¯ä»¥freezeä¸€éƒ¨åˆ†æ¨¡å‹ï¼Œç„¶å<strong>è®­ç»ƒåé¢çš„æ¨¡å‹</strong>ã€‚ä¹Ÿå¯ä»¥freezeä¸€éƒ¨åˆ†æ¨¡å‹ï¼ŒæŠŠåé¢çš„æ¨¡å‹è¿›è¡Œä¿®æ”¹ã€‚</p>
<ul>
<li>è§„å¾‹ï¼š<strong>æ•°æ®é›†è¶Šå¤§ï¼Œéœ€è¦å†»ç»“çš„å±‚æ•°è¶Šå°‘ï¼Œéœ€è¦è¿›è¡Œè®­ç»ƒçš„å±‚æ•°è¶Šå¤š</strong>ã€‚</li>
</ul>
<p><strong>å›¾ä¸‹</strong>ï¼šå¦‚æœæœ‰ç‰¹åˆ«å¤šçš„æ•°æ®ï¼Œå°±ç”¨å¼€æºçš„ç½‘ç»œå’Œå®ƒçš„æƒé‡å½“ä½œå‚æ•°çš„åˆå§‹åŒ–ï¼Œç„¶å<strong>è®­ç»ƒæ•´ä¸ªç½‘ç»œ</strong>ã€‚</p>
<p>å…¶ä»–ï¼šè®¡ç®—æœºè§†è§‰é—®é¢˜ä¸­ï¼Œè¿ç§»å­¦ä¹ ç‰¹åˆ«å¸¸ç”¨ã€‚é™¤éæœ‰ä¸€ä¸ªæå…¶å¤§çš„æ•°æ®é›†ï¼Œæ‰ä»å¤´å¼€å§‹è®­ç»ƒæ‰€æœ‰ä¸œè¥¿ã€‚</p>
<h4 id="2-10-æ•°æ®å¢å¼ºï¼ˆData-augmentationï¼‰"><a href="#2-10-æ•°æ®å¢å¼ºï¼ˆData-augmentationï¼‰" class="headerlink" title="2.10 æ•°æ®å¢å¼ºï¼ˆData augmentationï¼‰"></a>2.10 æ•°æ®å¢å¼ºï¼ˆData augmentationï¼‰</h4><p>è®¡ç®—æœºè§†è§‰æ–¹é¢çš„ä¸»è¦é—®é¢˜æ˜¯æ²¡æœ‰åŠæ³•å¾—åˆ°å……è¶³çš„æ•°æ®ã€‚å½“è®­ç»ƒæ¨¡å‹æ—¶ï¼Œä¸ç®¡æ˜¯ä»åˆ«äººé¢„è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œè¿ç§»å­¦ä¹ ï¼Œè¿˜æ˜¯ä»æºä»£ç å¼€å§‹è®­ç»ƒæ¨¡å‹ï¼Œæ•°æ®å¢å¼ºä¼šç»å¸¸æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>æ•°æ®å¢å¼ºçš„æ–¹æ³•ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/146.png' width="80%" height="80%"/ loading="lazy">

<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/147.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li>é•œåƒç¿»è½¬ã€éšå³è£å‰ªï¼ˆä¿ç•™ä¸»ä½“ï¼‰ã€æ—‹è½¬ã€å‰ªåˆ‡ã€å±€éƒ¨å¼¯æ›² ç­‰ã€‚ä¹Ÿå¯ä»¥ç»„åˆèµ·æ¥ç”¨ï¼Œä½†å› ä¸ºå¤ªå¤æ‚ï¼Œå®é™…ä¸Šç”¨çš„å¾ˆå°‘ã€‚</li>
<li>è‰²å½©è½¬æ¢ï¼Œè¿›è¡ŒRGBçš„è°ƒæ•´ï¼Œä¸€èˆ¬æ˜¯æ ¹æ®æŸç§æ¦‚ç‡åˆ†å¸ƒæ¥å†³å®šæ”¹å˜çš„å€¼ã€‚<ul>
<li>*å¯¹RGBä¸åŒçš„é‡‡æ ·æ–¹å¼ï¼šä½¿ç”¨PCAï¼ˆè§æœºå™¨å­¦ä¹ ç½‘è¯¾ç¬”è®°ï¼‰ã€‚åœ¨AlexNetçš„è®ºæ–‡ä¸­ï¼Œæˆä¸ºâ€œPCA color augmentationâ€ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„å›¾ç‰‡å‘ˆç´«è‰²ï¼ˆçº¢è“å¤šï¼Œç»¿å°‘ï¼‰ï¼Œé‚£ä¹ˆPCAé¢œè‰²å¢å¼ºç®—æ³•ä¼šå¯¹çº¢è“æœ‰å¤§çš„å¢å‡å¹…åº¦ï¼Œå¯¹ç»¿çš„å˜åŒ–ç›¸å¯¹å°‘ï¼Œä»¥æ­¤ä½¿æ€»ä½“çš„é¢œè‰²ä¿æŒä¸€è‡´ã€‚</li>
</ul>
</li>
</ul>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/148.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœæ•°æ®é›†æ¯”è¾ƒå¤§ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯è®¾ç½®å•ä¸ªthreadï¼Œä¸²è¡Œè¯»å–æ•°æ®ã€è¿›è¡Œæ•°æ®å¢å¼ºã€‚</p>
<ul>
<li><p>thread Aï¼š<strong>ä»ç¡¬ç›˜è¯»æ•°æ®å¹¶æ•°æ®å¢å¼º</strong>ã€‚CPUæœ‰ä¸€ä¸ªthreadä¸åœåœ°ä»ç¡¬ç›˜ä¸­è¯»å–æ•°æ®ï¼ŒåŒæ—¶è¿›è¡Œå˜å½¢æˆ–é¢œè‰²è½¬æ¢å½¢æˆæ–°çš„å›¾åƒï¼Œä»è€Œæ„æˆä¸€ä¸ªbatchæˆ–è€…mini-batchçš„æ•°æ®ï¼›</p>
</li>
<li><p>thread Bï¼š<strong>è®­ç»ƒ</strong>ã€‚è¿™äº›æ•°æ®è¢«ä¼ é€’ç»™å…¶ä»–threadï¼ˆå¯èƒ½æ˜¯CPUæˆ–GPUï¼‰ï¼Œè¿›è¡Œæ¨¡å‹çš„è®­ç»ƒã€‚</p>
</li>
</ul>
<p><strong>ä»¥ä¸Šä¸¤ä¸ªthreadå¯ä»¥å¹¶è¡Œå®ç°ã€‚</strong></p>
<p>å…¶ä»–ï¼šæ•°æ®å¢å¼ºä¹Ÿæœ‰ä¸€äº›è¶…å‚æ•°ï¼Œæ¯”å¦‚å¦‚ä½•è¿›è¡Œé¢œè‰²å˜åŒ–ç­‰ã€‚æ–¹æ³•ä¾ç„¶æ˜¯å­¦ä¹ å¼€æºçš„å®ç°ã€‚</p>
<h4 id="2-11-è®¡ç®—æœºè§†è§‰ç°çŠ¶"><a href="#2-11-è®¡ç®—æœºè§†è§‰ç°çŠ¶" class="headerlink" title="2.11 è®¡ç®—æœºè§†è§‰ç°çŠ¶"></a>2.11 è®¡ç®—æœºè§†è§‰ç°çŠ¶</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/149.png' width="80%" height="80%"/ loading="lazy">

<p>ä»æ•°æ®å°‘åˆ°æ•°æ®å¤šçš„åº”ç”¨åœºæ™¯ï¼šç›®æ ‡æ£€æµ‹ï¼Œå›¾åƒè¯†åˆ«ï¼Œè¯­éŸ³è¯†åˆ«</p>
<p>æ•°æ®å¾ˆå¤šæ—¶ï¼šä¸éœ€è¦ç²¾å¿ƒè®¾è®¡æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„ç®—æ³•ã€è¾ƒå°‘çš„äººå·¥ã€‚</p>
<p>æ•°æ®å¾ˆå°‘ï¼šè¿›è¡Œæ›´å¤šæ‰‹å·¥å·¥ç¨‹ï¼Œè¿›è¡Œè¿ç§»å­¦ä¹ ã€‚</p>
<p>çŸ¥è¯†çš„ä¸¤ç§æ¥æºï¼šæ ‡ç­¾ï¼›æ‰‹å·¥å·¥ç¨‹ã€‚å¦‚æœæ²¡æœ‰å¾ˆå¤šæ ‡ç­¾ï¼Œå°±ç”¨æ›´å¤šçš„æ‰‹å·¥ã€‚</p>
<p><strong>è®¡ç®—æœºè§†è§‰é—®é¢˜é€šå¸¸æ•°æ®ç›¸å¯¹è¾ƒå°‘ï¼Œæ›´å¤šä¾èµ–äºæ‰‹å·¥å·¥ç¨‹ï¼Œå¹¶ä¸”è®¾è®¡æ¯”è¾ƒå¤æ‚çš„ç½‘ç»œæ¶æ„ï¼Œæœ‰æ¯”è¾ƒå¤æ‚çš„è¶…å‚æ•°é€‰æ‹©é—®é¢˜</strong>ã€‚å¯ä»¥è¯´ï¼š<strong>è®¡ç®—æœºè§†è§‰é—®é¢˜å»ºç«‹åœ¨å°æ•°æ®ç³»ç»Ÿ</strong>ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/150.png' width="80%" height="80%"/ loading="lazy">

<p>åœ¨benchmarksï¼ˆåŸºå‡†æµ‹è¯•ï¼‰&#x2F;ç«èµ›ä¸Šå–å¾—å¥½çš„è¡¨ç°çš„æ–¹æ³•ï¼š</p>
<ul>
<li>é›†æˆ<ul>
<li>å½“æ„æ€å¥½ç¥ç»ç½‘ç»œä¹‹åï¼Œç‹¬ç«‹è®­ç»ƒå‡ ä¸ªç½‘ç»œï¼Œå¹¶å¯¹å®ƒä»¬çš„è¾“å‡ºæ±‚å¹³å‡ã€‚</li>
<li>é›†æˆéœ€è¦ä¿ç•™å¤šä¸ªç½‘ç»œï¼Œå¯¹å†…å­˜æœ‰æ¯”è¾ƒå¤§çš„å ç”¨ã€‚</li>
</ul>
</li>
<li>multi-crop<ul>
<li>è¿™æ˜¯ä¸€ç§å°†æ•°æ®å¢å¼ºæ‰©å±•åˆ°æµ‹è¯•é›†çš„æ–¹æ³•ã€‚ä»¥10-cropä¸ºä¾‹ï¼ŒæŠŠæµ‹è¯•é›†çš„å›¾ç‰‡åˆ†ä¸ºï¼ˆä¸­å¿ƒè£å‰ªã€å››è§’è£å‰ªã€é•œåƒä¸­å¿ƒè£å‰ªã€é•œåƒå››è§’è£å‰ªï¼‰åå¼ å›¾ç‰‡ï¼Œåˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ï¼Œå¹¶å¯¹è¾“å‡ºæ±‚å¹³å‡ã€‚</li>
<li>multi-cropåªéœ€è¦ä¿ç•™ä¸€ä¸ªç½‘ç»œï¼Œä¸ä¼šå ç”¨å¤ªå¤šå†…å­˜ï¼Œä½†ä¼šè®©è¿è¡Œæ—¶é—´å˜æ…¢ã€‚</li>
</ul>
</li>
</ul>
<p>éœ€è¦æ³¨æ„ï¼Œ<strong>è¿™æ˜¯åœ¨åŸºå‡†æµ‹è¯•å’Œç«èµ›ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œä¸è¦åœ¨çœŸå®ç”Ÿäº§åœºæ™¯ä¸‹ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œå› ä¸ºä¼šè®©è¿è¡Œæ—¶é—´å˜æ…¢ã€‚</strong></p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/151.png' width="80%" height="80%"/ loading="lazy">

<p>ç”±äºè®¡ç®—æœºè§†è§‰é—®é¢˜å»ºç«‹åœ¨å°æ•°æ®ç³»ç»Ÿï¼Œå…¶ä»–äººå·²ç»å®Œæˆäº†å¤§é‡çš„ç½‘ç»œæ¶æ„çš„æ‰‹å·¥å·¥ç¨‹ï¼›å¹¶ä¸”ä¸€ä¸ªç¥ç»ç½‘ç»œåœ¨ä¸€ä¸ªè§†è§‰é—®é¢˜ä¸Šå¾ˆæœ‰æ•ˆï¼Œé€šå¸¸ä¹Ÿä¼šè§£å†³å…¶ä»–è§†è§‰é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥æƒ³å»ºç«‹ä¸€ä¸ªä½¿ç”¨çš„ç³»ç»Ÿï¼Œæœ€å¥½å…ˆä»å…¶ä»–äººçš„ç¥ç»ç½‘ç»œæ¶æ„å…¥æ‰‹ã€‚å°¤å…¶æ˜¯å¼€æºç³»ç»Ÿï¼Œä¼šåŒ…å«è¶…å‚æ•°è®¾ç½®ç­‰ç»†èŠ‚é—®é¢˜ã€‚<strong>æœ€å¥½ä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œåœ¨æˆ‘ä»¬è‡ªå·±çš„æ•°æ®é›†ä¸Šè¿›è¡Œè°ƒä¼˜</strong>ã€‚</p>
<h3 id="ç¬¬ä¸‰å‘¨-ç›®æ ‡æ£€æµ‹ï¼ˆObject-detectionï¼‰"><a href="#ç¬¬ä¸‰å‘¨-ç›®æ ‡æ£€æµ‹ï¼ˆObject-detectionï¼‰" class="headerlink" title="ç¬¬ä¸‰å‘¨ ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰"></a>ç¬¬ä¸‰å‘¨ ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰</h3><p>(1) èƒ½å®Œæˆ classification çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ° location</p>
<p>(2) ç»“åˆæ»‘åŠ¨çª—å£è¿›è¡Œ detectionï¼ˆæ»‘åŠ¨çª—å£+CNNï¼‰ï¼Œå¯ä»¥æ‰¾åˆ° location äº†ã€‚ä½†è®¡ç®—é‡å¤§</p>
<p>(3) æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆoverfeatï¼‰ï¼Œè®¡ç®—ç®€å•äº†ã€‚ä½†æ»‘åŠ¨çª—å£ç²¾åº¦ä¸é«˜</p>
<p>(4) YOLOç®—æ³•ï¼Œåˆ’åˆ†å•å…ƒæ ¼ï¼Œæ¯ä¸ªæ ¼å­é¢„æµ‹ä¸­ç‚¹åœ¨æ ¼å­å†…çš„ç‰©ä½“å’Œç‰©ä½“çš„è¾¹æ¡†ã€‚å¯ä»¥é¢„æµ‹ç‰©ä½“çš„ç²¾ç¡®è¾¹æ¡†äº†ã€‚ä½†å•ä¸ªç‰©ä½“æœ‰å¤šä¸ªè¾¹æ¡†</p>
<p>(5) mon-max supressionï¼Œå•ä¸ªç‰©ä½“åªæœ‰ä¸€ä¸ªè¾¹æ¡†äº†ã€‚ä½†ä¸€ä¸ªæ ¼å­åªèƒ½æ£€æµ‹ä¸€ä¸ªå¯¹è±¡</p>
<p>(6) anchor boxesï¼Œä¸€ä¸ªæ ¼å­å¯ä»¥æ£€æµ‹å¤šä¸ªå¯¹è±¡äº†ã€‚</p>
<h4 id="3-1-ç›®æ ‡å®šä½ï¼ˆObject-localizationï¼‰"><a href="#3-1-ç›®æ ‡å®šä½ï¼ˆObject-localizationï¼‰" class="headerlink" title="3.1 ç›®æ ‡å®šä½ï¼ˆObject localizationï¼‰"></a>3.1 ç›®æ ‡å®šä½ï¼ˆObject localizationï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/152.png' width="80%" height="80%"/ loading="lazy">

<p>detectioné—®é¢˜ä¸­ï¼Œå›¾ç‰‡å¯ä»¥åŒ…å«å¤šä¸ªå¯¹è±¡ï¼Œç”šè‡³æ˜¯å¤šä¸ªä¸åŒåˆ†ç±»çš„å¯¹è±¡ã€‚</p>
<p>classification çš„æ€è·¯å¯ä»¥å¸®åŠ©å­¦ä¹  classification with localization é—®é¢˜ï¼›classification with localization çš„æ€è·¯åˆæœ‰åŠ©äºå­¦ä¹  detection é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬ä» classification with localization é—®é¢˜å¼€å§‹ã€‚</p>
<p>classification with localization pipelineï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/153.png' width="80%" height="80%"/ loading="lazy">

<p>å›¾ç‰‡è¾“å…¥ConvNetï¼Œè¾“å‡ºä¸€ä¸ª4åˆ†ç±»çš„softmax + ä¸€ä¸ªå®šä½åæ ‡ã€‚</p>
<p>æ ‡ç­¾ y å®šä¹‰å¦‚ä¸‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/154.png' width="80%" height="80%"/ loading="lazy">

<p>å‡å®šå›¾ç‰‡ä¸­æœ€å¤šå‡ºç°ä¸€ä¸ªå¯¹è±¡ã€‚è¾“å‡º y ï¼š</p>
<ul>
<li>P_cï¼šæ˜¯å¦æœ‰ç‰©ä½“ï¼ˆæ²¡æœ‰å°±æ˜¯ç¬¬å››ç±»backgroundï¼‰</li>
<li>bx, by, bh, bwï¼šç‰©ä½“æ¡†</li>
<li>c_1, c_2, c_3ï¼šæ˜¯å“ªä¸€ç±»ç‰©ä½“</li>
</ul>
<p>å›¾å³ä¾§æœ‰ä¸¤ä¸ªä¾‹å­ï¼Œâ€?â€ æ˜¯ä¸éœ€è¦å…³å¿ƒçš„æ•°ã€‚</p>
<p>æŸå¤±å‡½æ•°å®šä¹‰è§å›¾å·¦ã€‚å½“ $y_1&#x3D;1$ï¼Œä½¿ç”¨ squared erorrï¼›å½“ $y_1&#x3D;0$ï¼Œä¸è®¸è€ƒè™‘å…¶ä»–å…ƒç´ ï¼Œåªçœ‹ P_c çš„å‡†ç¡®åº¦ã€‚</p>
<p>ä¹Ÿå¯ä»¥å¯¹ä¸åŒéƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„æŸå¤±å‡½æ•°ï¼Œæ¯”å¦‚å¯¹åˆ†ç±»éƒ¨åˆ† c_1, c_2, c_3 ä½¿ç”¨å¯¹æ•°ï¼Œå¯¹ bx, by, bh, bw ä½¿ç”¨å¹³æ–¹è¯¯å·®ï¼Œå¯¹ P_c ä½¿ç”¨é€»è¾‘å›å½’æŸå¤±å‡½æ•°ã€‚å…¨ç”¨ squared error ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<h4 id="3-2-ç‰¹å¾ç‚¹æ£€æµ‹ï¼ˆLandmark-detectionï¼‰"><a href="#3-2-ç‰¹å¾ç‚¹æ£€æµ‹ï¼ˆLandmark-detectionï¼‰" class="headerlink" title="3.2 ç‰¹å¾ç‚¹æ£€æµ‹ï¼ˆLandmark detectionï¼‰"></a>3.2 ç‰¹å¾ç‚¹æ£€æµ‹ï¼ˆLandmark detectionï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/155.png' width="80%" height="80%"/ loading="lazy">

<p>ä»¥é¢éƒ¨è¯†åˆ«ä¸ºä¾‹ï¼Œé€‰å®šè„¸éƒ¨ç‰¹å¾ç‚¹çš„ä¸ªæ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«è¿™äº›ç‰¹å¾ç‚¹çš„æ ‡ç­¾è®­ç»ƒé›†ï¼Œå°±å¯ä»¥åˆ©ç”¨ç¥ç»ç½‘ç»œè¾“å‡ºè„¸éƒ¨ç‰¹å¾ç‚¹çš„ä½ç½®ã€‚</p>
<p>æ£€æµ‹å…³é”®ç‚¹ä¹Ÿæ˜¯æ•°æ®é›†å›¾å½¢æ•ˆæœçš„ä¸€ä¸ªå…³é”®æ„é€ æ¨¡å—ï¼Œæœ‰äº†å…³é”®ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå„ç§å¤„ç†ï¼Œæ¯”å¦‚æ‰­æ›²ã€å¤´æˆ´çš‡å† çš„ARç­‰ç­‰ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™æ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¸¦æœ‰å…³é”®ç‚¹çš„æ•°æ®é›†ï¼Œè¿™ä¸ªæ•°æ®é›†æ˜¯äººå·¥æ ‡æ³¨çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœæœ‰64ä¸ªå…³é”®ç‚¹ï¼Œå¹¶ä¸”é‡‡ç”¨å›¾ä¸­ä¸Šæ–¹çš„æ ‡ç­¾ç»“æ„ï¼Œå°±éœ€è¦ä¸€ä¸ª129ç»´çš„æ ‡ç­¾yã€‚</p>
<p>å¯¹äººçš„å§¿æ€æ£€æµ‹é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å»ºç«‹å…³é”®ç‚¹ã€‚</p>
<h4 id="3-3-ç›®æ ‡æ£€æµ‹ï¼ˆObject-detectionï¼‰"><a href="#3-3-ç›®æ ‡æ£€æµ‹ï¼ˆObject-detectionï¼‰" class="headerlink" title="3.3 ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰"></a>3.3 ç›®æ ‡æ£€æµ‹ï¼ˆObject detectionï¼‰</h4><p>æœ‰äº†ä¸Šä¸¤èŠ‚çš„ç›®æ ‡å®šä½å’Œç‰¹å¾ç‚¹æ£€æµ‹ï¼Œå¯ä»¥é€šè¿‡æ»‘åŠ¨çª—å£æ„å»ºç›®æ ‡æ£€æµ‹ç³»ç»Ÿäº†ã€‚</p>
<p>step 1ï¼šè®­ç»ƒä¸€ä¸ªConvNetï¼Œè¾“å…¥åˆ‡å‰²å¥½çš„å›¾ç‰‡ï¼Œè¾“å‡ºæ˜¯å¦æ˜¯ä¸€è¾†æ±½è½¦ï¼Œy&#x3D;0æˆ–1.</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/156.png' width="80%" height="80%"/ loading="lazy">

<p>step 2ï¼šé€‰å®šä¸€ä¸ªç‰¹å®šå¤§å°çš„çª—å£ï¼Œå°†çª—å£åœ¨å›¾ç‰‡ä¸­æ»‘åŠ¨ï¼ŒæŠŠæ¯ä¸ªåˆ‡ç‰‡è¾“å…¥ConvNetè¿›è¡Œè¯†åˆ«ã€‚ä¸€æ¬¡æ»‘åŠ¨ç»“æŸåï¼Œä½¿ç”¨æ›´å¤§çš„çª—å£é‡å¤ä¸Šè¿°æ“ä½œã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/157.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸ç®¡æ±½è½¦åœ¨å›¾ç‰‡ä¸­çš„å“ªé‡Œï¼Œæ€»æœ‰ä¸€ä¸ªçª—å£èƒ½è®©æ±½è½¦è¢«è¯†åˆ«å‡ºæ¥ã€‚</p>
<p>æ»‘åŠ¨çª—å£çš„ä¸€ä¸ªå¤§é—®é¢˜æ˜¯è®¡ç®—å¼€é”€ã€‚å¦‚æœæ­¥å¹…å¾ˆå¤§ï¼Œä¼šè®©è¾“å…¥ConvNetçš„çª—å£åˆ‡ç‰‡å‡å°‘ï¼Œä½†ç²—ç²’åº¦å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚å¦‚æœé‡‡ç”¨å°ç²’åº¦æˆ–å°æ­¥å¹…ï¼Œä¼ é€’ç»™ConvNetçš„çª—å£åˆ‡ç‰‡ä¼šç‰¹åˆ«å¤šï¼Œè®¡ç®—æˆæœ¬å¾ˆé«˜ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜å·²ç»æœ‰äº†æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ³•ï¼Œåœ¨ä¸‹èŠ‚è®²ã€‚</p>
<h4 id="3-4-æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆConvolutional-implementation-of-sliding-windowsï¼‰"><a href="#3-4-æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆConvolutional-implementation-of-sliding-windowsï¼‰" class="headerlink" title="3.4 æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆConvolutional implementation of sliding windowsï¼‰"></a>3.4 æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼ˆConvolutional implementation of sliding windowsï¼‰</h4><p>é¦–å…ˆçŸ¥é“æ€æ ·æŠŠå…¨è¿æ¥å±‚è½¬æ¢æˆå·ç§¯å±‚ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/158.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>ä¸ºäº†ä»£æ›¿å°† 5Ã—5Ã—16 å±•å¼€æˆ 400 ç»´çš„å…¨è¿æ¥å±‚ï¼šè¿›è¡Œ 400 ä¸ª 5Ã—5Ã—16 å·ç§¯æ ¸çš„å·ç§¯ï¼Œå¾—åˆ° 1Ã—1Ã—400 çš„è¾“å‡ºå±‚ã€‚ 1Ã—1Ã—400 çš„è¾“å‡ºæ˜¯ä¸Šä¸€å±‚  5Ã—5Ã—16 æ¿€æ´»å€¼ç»è¿‡æŸä¸ªçº¿æ€§å‡½æ•°çš„è¾“å‡ºç»“æœã€‚</p>
</li>
<li><p>ä¸ºäº†ä»£æ›¿ 400 åˆ° 400 çš„å…¨è¿æ¥å±‚ï¼šè¿›è¡Œ 400 ä¸ª 1Ã—1 å·ç§¯æ ¸çš„å·ç§¯ã€‚</p>
</li>
<li><p>ä¸ºäº†ä»£æ›¿ 400 åˆ° softmaxåˆ†ç±»çš„å…¨è¿æ¥å±‚ï¼šè¿›è¡Œ 4 ä¸ª 1Ã—1 å·ç§¯æ ¸çš„å·ç§¯æ¥ä¸€ä¸ªsoftmaxå‡½æ•°ï¼Œæœ€ç»ˆå¾—åˆ° 1Ã—1Ã—4 çš„è¾“å‡ºå±‚ã€‚</p>
</li>
</ul>
<p>æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/159.png' width="80%" height="80%"/ loading="lazy">

<p>æˆ‘ä»¬æœ‰ä¸€ä¸ª 14Ã—14Ã—3 ä½œä¸ºè¾“å…¥çš„ConvNetã€‚å¦‚æœåœ¨ 16Ã—16Ã—3 çš„å¤§å›¾åƒåšæ»‘åŠ¨çª—å£ï¼Œä¼šåˆ’åˆ†ä¸ºå››éƒ¨åˆ†ã€è¿›è¡Œå››æ¬¡å·ç§¯ã€‚ç»“æœå‘ç°ï¼Œè¿™å››æ¬¡å·ç§¯æ“ä½œä¸­çš„å¾ˆå¤šè®¡ç®—éƒ½æ˜¯é‡å¤çš„ã€‚</p>
<p>ç›´æ¥å¯¹å¤§å›¾è¿›è¡Œç›¸åŒçš„å·ç§¯æ“ä½œã€‚ç°åœ¨è¾“å‡ºå±‚ä¸º 2Ã—2Ã—400 è€Œä¸æ˜¯ 1Ã—1Ã—400ã€‚è¿™å››æ¬¡å·ç§¯åˆ†åˆ«å¯¹åº”è¾“å‡ºå±‚ 2Ã—2 çš„å››ä¸ªè§’ã€‚ï¼ˆç»¿è‰²åŒºåŸŸçš„å·ç§¯æ˜¯å…¶ä¸­ä¸€ä¸ªä¾‹å­ï¼‰</p>
<p>é€šè¿‡æŠŠæ»‘åŠ¨çª—å£çš„å¾ˆå¤šæ¬¡å·ç§¯ä½œä¸ºä¸€å¼ å›¾ç‰‡è¾“å…¥ç»™ConvNetè¿›è¡Œè®¡ç®—ï¼Œå…¶ä¸­çš„å…¬æœ‰åŒºåŸŸå¯ä»¥å…±äº«å¾ˆå¤šè®¡ç®—ã€‚</p>
<p>åŒç†ï¼Œå¯¹ 28Ã—28Ã—3 çš„å›¾ç‰‡ç›´æ¥è¿›è¡Œå·ç§¯ï¼Œç›¸å½“äºåš 8Ã—8 æ¬¡æ­¥é•¿ä¸º 2 ï¼ˆå› ä¸ºMAX POOLæ˜¯2Ã—2ï¼‰çš„å·ç§¯ï¼Œå¹¶ä¸”æŠŠç»“æœæŒ‰æ»‘åŠ¨çª—å£çš„é¡ºåºæ’åˆ—èµ·æ¥ã€‚</p>
<p>æ€»ç»“ï¼šå¯¹å¤§å›¾ç›´æ¥è¿›è¡Œå·ç§¯ï¼Œä¸€æ¬¡å¾—åˆ°æ‰€æœ‰é¢„æµ‹å€¼ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/160.png' width="80%" height="80%"/ loading="lazy">

<p>è¿™ä¸ªç®—æ³•æ•ˆç‡é«˜ï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€ä¸ªç¼ºç‚¹ï¼šè¾¹ç•Œæ¡†çš„ä½ç½®å¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼Œç”±äºæ­¥é•¿çš„å­˜åœ¨ï¼Œæ»‘åŠ¨çª—å£å¯èƒ½ä¸èƒ½å¾ˆå¥½çš„æ¡†é€‰ä½ç‰©ä½“ã€‚åœ¨ä¸‹èŠ‚è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å…¶ä»–ï¼šè¿™ä¸ªæ€è·¯ä¹Ÿè¢«R-CNNå€Ÿé‰´ï¼Œä»è€Œè¯ç”Ÿäº†Fast R-cNNç®—æ³•ã€‚</p>
<h4 id="3-5-Bounding-Box-é¢„æµ‹-YOLO-ç®—æ³•"><a href="#3-5-Bounding-Box-é¢„æµ‹-YOLO-ç®—æ³•" class="headerlink" title="3.5 Bounding Box é¢„æµ‹ - YOLO ç®—æ³•"></a>3.5 Bounding Box é¢„æµ‹ - YOLO ç®—æ³•</h4><p>æ›´ç²¾å‡†çš„è¾¹ç•Œæ¡†é¢„æµ‹ç®—æ³•ï¼šYOLOç®—æ³•ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/161.png' width="80%" height="80%"/ loading="lazy">

<p>æŠŠå›¾ç‰‡åˆ†æˆè‹¥å¹²æ ¼ï¼Œå¯¹æ¯ä¸€æ ¼åº”ç”¨ä¹‹å‰è®²è¿‡çš„ classification with localization ç®—æ³•ã€‚å¯¹äºé‡Œé¢æœ‰è½¦çš„æ ¼å­ï¼Œé¢„æµ‹å‡ºç»¿è‰²ã€é»„è‰²çš„æ ‡ç­¾ï¼›å¯¹äºå…¶ä»–æ ¼å­ï¼Œé¢„æµ‹å‡ºæ¥ç´«è‰²çš„æ ‡ç­¾ã€‚<strong>æ¯ä¸ªå•å…ƒæ ¼è´Ÿè´£é¢„æµ‹ä¸­ç‚¹ä½äºè¯¥æ ¼å­å†…çš„ç‰©ä½“å’Œç‰©ä½“çš„è¾¹ç•Œæ¡†ã€‚</strong></p>
<p>ä»¥å›¾ä¸­ 3Ã—3 æ ¼å­ï¼Œé•¿åº¦ä¸º 8 çš„å‘é‡ï¼Œæ€»çš„è¾“å‡ºå°ºå¯¸æ˜¯ 3Ã—3Ã—8ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è®­ç»ƒè¿™æ ·ä¸€ä¸ªç¥ç»ç½‘ç»œï¼šè¾“å…¥ä¸º 100Ã—100Ã—3 çš„å›¾ç‰‡ï¼Œç»è¿‡ä¸€ä¸ªConvNetï¼Œæœ€ç»ˆæ˜ å°„åˆ° 3Ã—3Ã—8çš„è¾“å‡ºã€‚é€šè¿‡åå‘ä¼ æ’­è®­ç»ƒè¿™ä¸ªç½‘ç»œï¼Œä½¿å…¶èƒ½å°†ä»»æ„è¾“å…¥xæ˜ å°„åˆ°è¿™ç±»è¾“å‡ºå‘é‡yã€‚è¿™ä¸ªç¥ç»ç½‘ç»œå¯ä»¥è¾“å‡ºç²¾ç¡®çš„è¾¹ç•Œæ¡†ã€‚</p>
<p>ç»†èŠ‚è¡¥å……ï¼š</p>
<ul>
<li><p>æ ¹æ®ç‰©ä½“çš„ä¸­å¿ƒç‚¹åˆ’åˆ†å®ƒæ‰€åœ¨çš„æ ¼å­ï¼Œå³ä½¿å¯¹è±¡å¯ä»¥è·¨è¶Šå¤šä¸ªæ ¼å­ï¼Œä¹Ÿåªä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªæ ¼å­ã€‚</p>
</li>
<li><p>åœ¨å®è·µä¸­å¯ä»¥ä½¿ç”¨æ›´ç²¾ç»†çš„æ ¼å­åˆ’åˆ†ï¼Œæ¯”å¦‚ 19Ã—19ï¼Œé™ä½ä¸åŒç‰©ä½“ä¸­å¿ƒä½äºåŒä¸€ä¸ªæ ¼å­çš„æ¦‚ç‡ã€‚</p>
</li>
<li><p>åœ¨YOLOä¸­ä¹Ÿä½¿ç”¨æ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ï¼Œä¸ä¼šåˆ†åˆ«è®¡ç®—æ¯ä¸ªæ ¼å­ç»è¿‡ConvNetçš„è¾“å‡ºã€‚è¿™åŠ é€Ÿäº†YOLOç®—æ³•çš„è¿è¡Œï¼Œå®é™…ä¸Šå®ƒçš„è¿è¡Œé€Ÿåº¦å¾ˆå¿«ï¼Œå¯ä»¥è¾¾åˆ°å®æ—¶è¯†åˆ«ã€‚</p>
</li>
</ul>
<p>è¡¨ç¤º bounding box çš„çº¦å®šï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/162.png' width="80%" height="80%"/ loading="lazy">

<p>bx, by, bh, bw å•ä½æ˜¯ç›¸å¯¹æ ¼å­å°ºåº¦çš„æ¯”ä¾‹ã€‚</p>
<ul>
<li>bxï¼Œby å¿…é¡»åœ¨ 0 åˆ° 1 ä¹‹é—´ã€‚</li>
<li>bwï¼Œbh å¯ä»¥å¤§äº1ï¼Œå› ä¸ºè½¦çš„å°ºå¯¸å¯èƒ½æ¯”ä¸€ä¸ªæ ¼å­å¤§ã€‚</li>
</ul>
<p>å…¶ä»–ï¼šYOLOè®ºæ–‡æ¯”è¾ƒéš¾æ‡‚ï¼Œä¸€äº›ç»†èŠ‚å¾ˆéš¾ç†è§£ã€‚</p>
<h4 id="3-6-äº¤å¹¶æ¯”ï¼ˆIntersection-over-unionï¼‰"><a href="#3-6-äº¤å¹¶æ¯”ï¼ˆIntersection-over-unionï¼‰" class="headerlink" title="3.6 äº¤å¹¶æ¯”ï¼ˆIntersection over unionï¼‰"></a>3.6 äº¤å¹¶æ¯”ï¼ˆIntersection over unionï¼‰</h4><p>å¦‚ä½•åˆ¤æ–­ object detection ç®—æ³•è¿ä½œè‰¯å¥½ï¼Ÿå®šä¹‰IoUçš„æ¦‚å¿µã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/163.png' width="80%" height="80%"/ loading="lazy">

<p>å®é™…çš„ bounding box æ˜¯çº¢è‰²ï¼Œæˆ‘ä»¬é¢„æµ‹çš„æ˜¯ç´«è‰²ã€‚IoU è®¡ç®—å®ƒä»¬äº¤é›†ï¼ˆintersectionï¼‰å’Œå¹¶é›†ï¼ˆunionï¼‰çš„æ¯”å€¼ï¼Œå¹¶è·Ÿä¸€ä¸ªé˜ˆå€¼è¿›è¡Œå¯¹æ¯”ã€‚</p>
<h4 id="3-7-éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNon-max-suppressionï¼‰"><a href="#3-7-éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNon-max-suppressionï¼‰" class="headerlink" title="3.7 éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNon-max suppressionï¼‰"></a>3.7 éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNon-max suppressionï¼‰</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/164.png' width="80%" height="80%"/ loading="lazy">

<p>åˆ†æ ¼å­è¿›è¡Œæ£€æµ‹åï¼Œä¸ä»…ä¸­å¿ƒç‚¹çš„æ ¼å­ä¼šè®¤ä¸ºè‡ªå·±å«æœ‰æŸä¸ªç‰©ä½“ï¼Œå‘¨å›´çš„æ ¼å­ä¹Ÿä¼šè®¤ä¸ºè‡ªå·±æ£€æµ‹å‡ºäº†è¿™ä¸ªç‰©ä½“ã€‚å¯¼è‡´å¾ˆå¤šæ ¼å­çš„ P_c å€¼ä¼šæ¯”è¾ƒé«˜ï¼ˆå›¾ä¸­çš„æ•°å­—ï¼‰ã€‚å¯¼è‡´å¯¹åŒä¸€ä¸ªå¯¹è±¡åšå‡ºå¤šæ¬¡æ£€æµ‹ã€‚</p>
<p><strong>éæå¤§å€¼æŠ‘åˆ¶</strong>ï¼šé¦–å…ˆçœ‹æ¦‚ç‡æœ€å¤§çš„ä¸€ä¸ªï¼Œæ ‡è®°è¿™é‡Œæ£€æµ‹å‡ºäº†è½¦ï¼ˆå›¾ä¸­é«˜äº®ï¼‰ï¼›ç„¶åé€ä¸€æ£€æŸ¥å‰©ä¸‹çš„çŸ©å½¢ï¼Œå¯¹æ‰€æœ‰ä¸è¿™ä¸ªbounding boxæœ‰å¾ˆé«˜äº¤å¹¶æ¯”ï¼ˆIoUï¼‰çš„å…¶ä»–bounding boxçš„è¾“å‡ºæŠ‘åˆ¶ã€‚</p>
<p>é€šè¿‡éæå¤§å€¼æŠ‘åˆ¶ï¼Œç¡®ä¿ç®—æ³•å¯¹æ¯ä¸ªå¯¹è±¡åªæ£€æµ‹ä¸€æ¬¡ã€‚</p>
<p>ç®—æ³•æ­¥éª¤ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/165.png' width="80%" height="80%"/ loading="lazy">



<h4 id="3-8-Anchor-Boxes"><a href="#3-8-Anchor-Boxes" class="headerlink" title="3.8 Anchor Boxes"></a>3.8 Anchor Boxes</h4><p>ç°åœ¨çš„é—®é¢˜ï¼šæ¯ä¸ªæ ¼å­åªèƒ½æ£€æµ‹å‡ºä¸€ä¸ªå¯¹è±¡ã€‚å¦‚ä½•èƒ½è®©ä¸€ä¸ªæ ¼å­æ£€æµ‹å¤šä¸ªï¼ˆä¸­ç‚¹ä½äºæ ¼å­å†…çš„ï¼‰å¯¹è±¡ï¼Ÿ</p>
<p>æ–¹æ³•ï¼šè®¾ç½®å‡ ä¸ªanchor boxã€‚ä»¥ä¸¤ä¸ªä¸ºä¾‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/166.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœæœ‰ä¸¤ä¸ªanchor boxï¼Œæ ‡ç­¾å˜ä¸º16ç»´ï¼Œè¾“å‡ºä» 3Ã—3Ã—8 å˜ä¸º 3Ã—3Ã—16ã€‚</p>
<p>æ–‡å­—æè¿°ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/167.png' width="80%" height="80%"/ loading="lazy">

<p>æ£€æµ‹åˆ°çš„ç‰©ä½“ï¼Œå¯»æ‰¾è·Ÿå“ªä¸ª anchor box çš„äº¤å¹¶æ¯”æ›´é«˜ï¼Œç„¶åå¡«å…¥ $y$ ç›¸åº”çš„ä½ç½®ã€‚</p>
<p>ä¸€ä¸ªå…·ä½“ä¾‹å­ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/168.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœæŒ‡å®š anchor box 1 å¤§çº¦æ˜¯è¡Œäººå½¢çŠ¶ï¼Œanchor box 2 å¤§çº¦æ˜¯æ±½è½¦å½¢çŠ¶ï¼ŒåŒæ—¶æœ‰äººå’Œè½¦ã€åªæœ‰è½¦çš„ $y$ å¦‚å›¾å³ä¾§æ‰€ç¤ºã€‚</p>
<p>å¼‚å¸¸æƒ…å†µï¼š</p>
<ul>
<li><p>å¦‚æœä¸€ä¸ªæ ¼å­ä¸­æœ‰ä¸‰ä¸ªå¯¹è±¡ï¼Œä½†åªè®¾ç½®äº†ä¸¤ä¸ª anchor box</p>
</li>
<li><p>åŒä¸€ä¸ªæ ¼å­çš„å‡ ä¸ª anchor box å½¢çŠ¶ç›¸ä¼¼</p>
</li>
</ul>
<p>è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œç®—æ³•æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ³•ï¼Œéœ€è¦å¼•å…¥ä¸€äº›æ‰“ç ´åƒµå±€çš„é»˜è®¤æ‰‹æ®µä¸“é—¨å¤„ç†è¿™äº›æƒ…å†µã€‚</p>
<p>å…¶ä»–ï¼š</p>
<ul>
<li>anchor box è¦å¤„ç†çš„æ ¼å­æœ‰å¤šä¸ªå¯¹è±¡çš„ä¸­ç‚¹é—®é¢˜å‡ºç°çš„å¾ˆå°‘ï¼ˆ361ä¸ªæ ¼å­å¾ˆéš¾é‡å¤ï¼‰ï¼Œä½†è®¾ç«‹ anchor box çš„å¥½å¤„åœ¨äºèƒ½è®©å­¦ä¹ ç®—æ³•æ›´å…·æœ‰å¯¹æ•°æ®é›†çš„é’ˆå¯¹æ€§ï¼Œå°¤å…¶æ˜¯æ•°æ®é›†ä¸­æœ‰ä¸€äº›å¾ˆç˜¦å¾ˆé«˜çš„å¯¹è±¡ï¼Œæ¯”å¦‚è¡Œäººï¼Œæˆ–è€…æ±½è½¦è¿™æ ·å¾ˆå®½çš„å¯¹è±¡ã€‚</li>
<li>å¦‚ä½•é€‰æ‹© anchor box çš„å½¢çŠ¶ï¼Ÿ<ul>
<li>ä¸€èˆ¬æ˜¯æ‰‹å·¥æŒ‡å®šã€‚é€‰æ‹© 5~10 ä¸ªï¼Œæ¶µç›–æƒ³è¦æ£€æµ‹çš„å¯¹è±¡çš„å„ç§å½¢çŠ¶ã€‚</li>
<li>å¦ä¸€ä¸ªæ›´é«˜çº§çš„æ–¹æ³•ï¼šä½¿ç”¨ k-means ï¼Œå°†ä¸¤ç±»å¯¹è±¡å½¢çŠ¶èšç±»ï¼Œæ¥é€‰æ‹©æœ€å…·ä»£è¡¨æ€§çš„ anchor boxã€‚</li>
</ul>
</li>
</ul>
<h4 id="3-9-æ•´åˆèµ·æ¥ï¼šYOLO-ç®—æ³•"><a href="#3-9-æ•´åˆèµ·æ¥ï¼šYOLO-ç®—æ³•" class="headerlink" title="3.9 æ•´åˆèµ·æ¥ï¼šYOLO ç®—æ³•"></a>3.9 æ•´åˆèµ·æ¥ï¼šYOLO ç®—æ³•</h4><p><strong>è®­ç»ƒæ¨¡å‹</strong>ï¼šè®­ç»ƒä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œè¾“å…¥å›¾ç‰‡ï¼Œè¾“å‡ºç›¸åº”çš„æ ‡ç­¾ $y$ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/169.png' width="80%" height="80%"/ loading="lazy">



<p><strong>è¿›è¡Œé¢„æµ‹</strong>ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/170.png' width="80%" height="80%"/ loading="lazy">



<p><strong>è¿›è¡Œéæœ€å¤§å€¼æŠ‘åˆ¶</strong>ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/171.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>å¯¹äºæ¯ä¸ªæ ¼å­ï¼Œéƒ½æœ‰ä¸¤ä¸ª anchor box é¢„æµ‹çš„ç»“æœã€‚æœ‰äº› bounding boxå¯ä»¥è¶…å‡ºæ‰€åœ¨æ ¼å­çš„å®½é«˜ã€‚  </p>
</li>
<li><p>ä¸¢æ‰æ¦‚ç‡å¾ˆå°ï¼ˆP_cï¼‰çš„é¢„æµ‹ã€‚</p>
</li>
<li><p>å¯¹æ¯ä¸ªç±»åˆ«ï¼Œå•ç‹¬è¿è¡Œéæœ€å¤§å€¼æŠ‘åˆ¶ã€‚åˆ†åˆ«æ‰¾åˆ°ç‹¬ç«‹çš„è¡Œäººã€æ±½è½¦ã€æ‘©æ‰˜ã€‚</p>
</li>
</ul>
<h4 id="3-10-å€™é€‰åŒºåŸŸï¼ˆRegion-proposals-ï¼‰"><a href="#3-10-å€™é€‰åŒºåŸŸï¼ˆRegion-proposals-ï¼‰" class="headerlink" title="3.10 *å€™é€‰åŒºåŸŸï¼ˆRegion proposals ï¼‰"></a>3.10 *å€™é€‰åŒºåŸŸï¼ˆRegion proposals ï¼‰</h4><p>åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸè®ºæ–‡ä¸­çš„å¸¸è§ç®—æ³•ï¼Œåœ¨å°‘æ•°çª—å£ä¸Šè¿è¡ŒCNNåˆ†ç±»å™¨ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/172.png' width="80%" height="80%"/ loading="lazy">

<p>æœ‰äº›æ»‘åŠ¨çª—å£å¹¶æ²¡æœ‰è¿›è¡Œè¯†åˆ«çš„ä»·å€¼ã€‚å› æ­¤ R-CNN ç®—æ³•å°è¯•é€‰å‡ºä¸€äº›åŒºåŸŸï¼Œåœ¨è¿™äº›åŒºåŸŸä¸Šè¿è¡ŒCNNåˆ†ç±»å™¨æ˜¯æœ‰æ„ä¹‰çš„ã€‚</p>
<p>è¿è¡Œå›¾åƒåˆ†å‰²ç®—æ³•ï¼Œæ‰¾åˆ°ä¸€äº›è‰²å—ï¼ˆå¦‚2000ä¸ªï¼‰ï¼Œåœ¨è‰²å—ä¸Šæ”¾ç½®è¾¹ç•Œæ¡†ï¼Œç„¶åè·‘CNNåˆ†ç±»å™¨æŸ¥çœ‹ç»“æœã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/173.png' width="80%" height="80%"/ loading="lazy">

<p>å¯ä»¥çœ‹å‡ºï¼ŒR-CNNè¿è¡Œæ¯”è¾ƒæ…¢ã€‚</p>
<p>basic R-CNNä½¿ç”¨æŸç§ç®—æ³•æ±‚å‡ºå€™é€‰åŒºåŸŸï¼Œç„¶åå¯¹æ¯ä¸ªå€™é€‰åŒºåŸŸè·‘ä¸€ä¸‹CNNåˆ†ç±»å™¨ï¼Œæ¯ä¸ªåŒºåŸŸè¾“å‡ºä¸€ä¸ªæ ‡ç­¾+è¾¹ç•Œæ¡†ã€‚ï¼ˆå¾—åˆ°çš„è¾¹ç•Œæ¡†æ›´ç²¾ç¡®ï¼Œè€Œä¸æ˜¯è‰²å—çš„è¾¹ç•Œæ¡†ï¼‰</p>
<p>Fast R-CNNï¼šæ»‘åŠ¨çª—å£çš„å·ç§¯å®ç°ã€‚åŠ é€Ÿäº†R-CNNã€‚</p>
<p>å¾—åˆ°é¢„é€‰åŒºåŸŸçš„èšç±»æ­¥éª¤ï¼ˆpropose regionsï¼‰ä»ç„¶æ¯”è¾ƒç¼“æ…¢ã€‚</p>
<p>Faster R-CNNï¼šä½¿ç”¨CNNè€Œä¸æ˜¯ä¼ ç»Ÿå›¾åƒåˆ†å‰²ç®—æ³•ï¼Œæ¥è·å¾—å€™é€‰åŒºåŸŸè‰²å—ã€‚</p>
<p>å…¶ä»–ï¼šå¤§å¤šæ•°æ›´å¿«çš„R-CNNç®—æ³•å®ç°è¿˜æ˜¯æ¯”YOLOæ…¢å¾ˆå¤šã€‚å› ä¸ºR-CNNéœ€è¦ä¸¤æ­¥ï¼Œå…ˆå¾—å‡ºé¢„é€‰åŒºåŸŸï¼Œç„¶åè¿›è¡Œè¯†åˆ«ï¼›è€ŒYOLOæ˜¯ you only look onceã€‚</p>
<h3 id="ç¬¬å››å‘¨-ç‰¹æ®Šåº”ç”¨ï¼šäººè„¸è¯†åˆ«å’Œé£æ ¼è¿ç§»"><a href="#ç¬¬å››å‘¨-ç‰¹æ®Šåº”ç”¨ï¼šäººè„¸è¯†åˆ«å’Œé£æ ¼è¿ç§»" class="headerlink" title="ç¬¬å››å‘¨ ç‰¹æ®Šåº”ç”¨ï¼šäººè„¸è¯†åˆ«å’Œé£æ ¼è¿ç§»"></a>ç¬¬å››å‘¨ ç‰¹æ®Šåº”ç”¨ï¼šäººè„¸è¯†åˆ«å’Œé£æ ¼è¿ç§»</h3><h4 id="4-1-ä»€ä¹ˆæ˜¯äººè„¸è¯†åˆ«ï¼Ÿ"><a href="#4-1-ä»€ä¹ˆæ˜¯äººè„¸è¯†åˆ«ï¼Ÿ" class="headerlink" title="4.1 ä»€ä¹ˆæ˜¯äººè„¸è¯†åˆ«ï¼Ÿ"></a>4.1 ä»€ä¹ˆæ˜¯äººè„¸è¯†åˆ«ï¼Ÿ</h4><p>è¯†åˆ«äººè„¸+æ´»ä½“æ£€æµ‹ã€‚</p>
<p>ä¸€äº›æœ¯è¯­ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/174.png' width="80%" height="80%"/ loading="lazy">

<ul>
<li><p>äººè„¸éªŒè¯ï¼ˆverificationï¼‰ï¼šè¾“å…¥å›¾ç‰‡å’Œèº«ä»½ï¼ŒéªŒè¯å›¾ç‰‡å’Œèº«ä»½æ˜¯å¦å¯¹åº”ã€‚ä¸€å¯¹ä¸€ã€‚</p>
</li>
<li><p>äººè„¸è¯†åˆ«ï¼ˆrecognitionï¼‰ï¼šè¾“å…¥å›¾ç‰‡ï¼Œè¯†åˆ«å‡ºèº«ä»½ã€‚ä¸€å¯¹å¤šã€‚</p>
</li>
</ul>
<p>å…ˆæ„å»ºverificationç³»ç»Ÿã€‚å¦‚æœè¡¨ç°å¤Ÿå¥½ï¼Œå°±å°†å…¶ç”¨åœ¨recognitionç³»ç»Ÿä¸Šã€‚</p>
<h4 id="4-2-One-Shotå­¦ä¹ ï¼ˆOne-shot-learningï¼‰"><a href="#4-2-One-Shotå­¦ä¹ ï¼ˆOne-shot-learningï¼‰" class="headerlink" title="4.2 One-Shotå­¦ä¹ ï¼ˆOne-shot learningï¼‰"></a>4.2 One-Shotå­¦ä¹ ï¼ˆOne-shot learningï¼‰</h4><p>éœ€è¦é€šè¿‡å•å¼ å›¾ç‰‡æˆ–å•ä¸ªäººè„¸æ ·ä¾‹ï¼Œå°±å¯ä»¥è¯†åˆ«è¿™ä¸ªäººçš„èº«ä»½ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/175.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœä½¿ç”¨å›¾ä¸­ç”»å‡ºçš„ç»“æ„ï¼Œè®­ç»ƒCNNè¿›è¡Œsoftmaxè¯†åˆ«ï¼Œé‚£ä¹ˆå¦‚æœæ–°åŠ å…¥ä¸€ä¸ªäººï¼Œå°±è¦ä¿®æ”¹è¾“å‡ºæ•°é‡å¹¶ä¸”é‡æ–°è®­ç»ƒCNNã€‚</p>
<p>éœ€è¦åšåˆ°one-shotï¼šåªé€šè¿‡ä¸€ä¸ªæ ·æœ¬è¿›è¡Œå­¦ä¹ ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/176.png' width="80%" height="80%"/ loading="lazy">

<p>ä¸è®­ç»ƒCNNï¼Œè€Œæ˜¯å­¦ä¹ similarityå‡½æ•° $d(img1,1mg2)$ ã€‚è¿™ä¸ªå‡½æ•°è¾“å…¥ä¸¤å¼ å›¾ç‰‡ï¼Œè¾“å‡º<strong>å·®å¼‚å€¼</strong>ã€‚</p>
<p>ç”¨è¾“å…¥å›¾ç‰‡è·Ÿæ•°æ®åº“ä¸­çš„å›¾ç‰‡è®¡ç®—å·®å¼‚å€¼ï¼Œè·Ÿé˜ˆå€¼æ¯”è¾ƒï¼Œè¿›è¡Œåˆ¤æ–­ã€‚</p>
<p>æ·»åŠ æ–°çš„å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p>
<h4 id="4-3-Siamese-ç½‘ç»œï¼ˆSiamese-networkï¼‰"><a href="#4-3-Siamese-ç½‘ç»œï¼ˆSiamese-networkï¼‰" class="headerlink" title="4.3 Siamese ç½‘ç»œï¼ˆSiamese networkï¼‰"></a>4.3 Siamese ç½‘ç»œï¼ˆSiamese networkï¼‰</h4><p>æƒ³è¦å­¦ä¹ similarityå‡½æ•° $d(img1,1mg2)$ ï¼Œè¾“å…¥ä¸¤å¼ å›¾ç‰‡ï¼Œè¾“å‡ºå®ƒä»¬çš„å·®å¼‚åº¦æˆ–ç›¸ä¼¼åº¦ã€‚</p>
<p>å®ç°çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯ç”¨ Siamese ç½‘ç»œï¼Œæ€è·¯æ˜¯ï¼š<strong>å¯¹äºä¸åŒçš„è¾“å…¥è¿è¡Œç›¸åŒçš„CNNï¼Œç„¶åæ¯”è¾ƒå®ƒä»¬çš„è¾“å‡º</strong>ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/177.png' width="80%" height="80%"/ loading="lazy">

<p>æœ‰ä¸€ä¸ªç½‘ç»œï¼Œè¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª128ç»´çš„å‘é‡ã€‚å¦‚æœæŠŠä¸¤å¼ å›¾ç‰‡ $x^{(1)},x^{(2)}$ è¾“å…¥åŒæ ·çš„ç½‘ç»œï¼Œå¯ä»¥å¾—åˆ°è¾“å‡ºå‘é‡ $f(x^{(1)}),f(x^{(2)})$ ã€‚</p>
<p>å°† $d(x^{(1)},x^{(2)})$ å®šä¹‰ä¸ºä¸¤å¼ å›¾ç‰‡ç¼–ç ä¹‹å·®çš„èŒƒæ•°ï¼š</p>
<p>$$d(x^{(1)},x^{(2)})&#x3D;||f(x^{(1)})-f(x^{(2)})||^2_2$$ </p>
<p>ä»è®­ç»ƒå±‚é¢ä¸Šï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/178.png' width="80%" height="80%"/ loading="lazy">

<p>è®­ç»ƒç¥ç»ç½‘ç»œå‚æ•°ï¼Œç›®æ ‡æ˜¯ï¼šç›¸åŒäººç‰©çš„å›¾ç‰‡ï¼Œè¾“å‡ºç›¸ä¼¼ï¼›ä¸åŒä»»åŠ¡çš„å›¾ç‰‡ï¼Œè¾“å‡ºç›¸å·®è¾ƒå¤§ã€‚</p>
<p>ä¸‹èŠ‚ï¼šæœ‰äº†è®­ç»ƒç›®æ ‡ï¼Œå…·ä½“å®šä¹‰æ€æ ·çš„æŸå¤±å‡½æ•°ï¼Ÿ</p>
<h4 id="4-4-Triplet-æŸå¤±"><a href="#4-4-Triplet-æŸå¤±" class="headerlink" title="4.4 Triplet æŸå¤±"></a>4.4 Triplet æŸå¤±</h4><p>æƒ³è®©ç¥ç»ç½‘ç»œå­¦ä¹ åˆ°æ¯”è¾ƒå¥½çš„å›¾ç‰‡ç¼–ç ï¼Œæ–¹æ³•ä¹‹ä¸€æ˜¯å®šä¹‰ä¸‰å…ƒç»„æŸå¤±å‡½æ•°ï¼ˆtriplet lossï¼‰ï¼Œç„¶ååº”ç”¨æ¢¯åº¦ä¸‹é™ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/179.png' width="80%" height="80%"/ loading="lazy">

<p>åŒæ—¶çœ‹ä¸‰å¼ å›¾ç‰‡ï¼šæ ·æœ¬å›¾ç‰‡Anchorã€åŒæ ·èº«ä»½çš„å›¾ç‰‡Positiveã€ä¸åŒèº«ä»½çš„å›¾ç‰‡Negativeã€‚</p>
<p>æˆ‘ä»¬æƒ³è¦ï¼š</p>
<p>$$||f(A)-f(P)||^2 - ||f(A)-f(N)||^2 â‰¤ 0   $$ </p>
<p>ä¸ºäº†ç¡®ä¿ä¸å­¦ä¹ åˆ°å…¨ä¸º0ï¼Œæ¥æ»¡è¶³æ–¹ç¨‹çš„ç¼–ç æ–¹å¼ï¼šè®¾ç½®è¶…å‚æ•° $\alpha$ ï¼Œä½œä¸ºmarginã€‚</p>
<p>$$||f(A)-f(P)||^2 - ||f(A)-f(N)||^2 + \alpha â‰¤ 0   $$ </p>
<p>ä¹Ÿå°±æ˜¯è¦æ±‚<strong>ä¸åŒèº«ä»½çš„ç¼–ç å·®å¼‚åº¦è¦æ¯”ç›¸åŒèº«ä»½çš„ç¼–ç å·®å¼‚åº¦å¤§å¾ˆå¤š</strong>ã€‚</p>
<p>triplet loss å®šä¹‰å¦‚ä¸‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/180.png' width="80%" height="80%"/ loading="lazy">

<p>$$L(A,P,N) &#x3D; max(||f(A)-f(P)||^2 - ||f(A)-f(N)||^2 + \alpha ,0   )$$ </p>
<p>$$J&#x3D;\sum^m_{i&#x3D;1}L(A^{(i)},P^{(i)},N^{(i)}) $$ </p>
<p>ä½¿ç”¨maxå‡½æ•°ï¼Œè¾¾åˆ°è®©ç¬¬ä¸€é¡¹å°äºç­‰äº0çš„æ•ˆæœï¼Œè€Œä¸”ä¸å…³å¿ƒæ¯”0å°å¤šå°‘ã€‚</p>
<p>æ³¨æ„ï¼šä¸ºäº†å®šä¹‰<strong>ä¸‰å…ƒç»„çš„æ•°æ®é›†</strong>ï¼Œéœ€è¦æˆå¯¹çš„Aã€Pï¼Œä¹Ÿå°±æ˜¯<strong>éœ€è¦åŒä¸€ä¸ªäººçš„å¤šå¼ ç…§ç‰‡</strong>ã€‚è¿™ä¹Ÿæ˜¯å›¾ä¸­ä¸¾ä¾‹çš„æ•°æ®é›†ï¼Œ1käººæœ‰10kå›¾ç‰‡çš„åŸå› ã€‚åœ¨è®­ç»ƒç»“æŸåï¼Œå°±è¾¾åˆ°äº†one-shotçš„ç›®çš„ï¼Œå¯ä»¥<strong>ç»™æŸä¸ªäººçš„ä¸€å¼ ç…§ç‰‡è¿›è¡Œè¯†åˆ«</strong>ã€‚</p>
<p>æ•°æ®é›†çš„é—®é¢˜ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/181.png' width="80%" height="80%"/ loading="lazy">

<p>å¦‚æœéšæœºé€‰æ‹©Aã€Pã€Nï¼Œé‚£ä¹ˆçº¦æŸæ¡ä»¶ $d(A,p)+\alpha â‰¤ d(A,N)$ å¾ˆå®¹æ˜“æ»¡è¶³ï¼Œå› ä¸ºéšæœºé€‰æ‹©çš„å›¾ç‰‡ Aå’ŒP çš„å·®å¼‚æ¯” Aå’ŒN çš„å·®å¼‚å°å¾ˆå¤šã€‚ç½‘ç»œå¹¶ä¸èƒ½ä»ä¸­å­¦ä¹ åˆ°ä»€ä¹ˆã€‚</p>
<p>æˆ‘ä»¬éœ€è¦<strong>å°½å¯èƒ½é€‰æ‹©â€œéš¾ä»¥è¯†åˆ«â€çš„ä¸‰å…ƒç»„ï¼Œç»„åˆæˆæ•°æ®é›†</strong>ã€‚</p>
<p>æ€»è§ˆï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/182.png' width="80%" height="80%"/ loading="lazy">

<p>åˆ¶ä½œä¸‰å…ƒç»„æ•°æ®é›†ï¼Œä½¿ç”¨ä¸‰å…ƒç»„lossï¼Œè®©æ¨¡å‹è¾“å‡ºä¸€ä¸ªå›¾ç‰‡çš„ç¼–ç ã€‚</p>
<p>å…¶ä»–ï¼šå¦‚ä»Šå·²ç»æœ‰å¾ˆå¤šå…¬å¸ä½¿ç”¨ç‰¹åˆ«å¤šçš„æ•°æ®ã€è®­ç»ƒäº†å¤§å‹çš„æ¨¡å‹ï¼Œå¹¶å¼€æºäº†æ¨¡å‹å‚æ•°ã€‚æ‰€ä»¥ç›¸æ¯”äºä»å¤´å¼€å§‹ï¼Œå¯ä»¥<strong>ä¸‹è½½åˆ«äººçš„é¢„è®­ç»ƒæ¨¡å‹</strong>ã€‚åŒæ—¶ä¹Ÿè¦äº†è§£è¿™äº›æ¨¡å‹çš„è®­ç»ƒæ–¹æ³•ã€‚åœ¨ä¸‹ä¸€èŠ‚è®²Siameseçš„å˜ä½“ï¼Œä»¥åŠå¦‚ä½•è®­ç»ƒè¿™äº›æ¨¡å‹ã€‚</p>
<h4 id="4-5-é¢éƒ¨éªŒè¯ä¸äºŒåˆ†ç±»ï¼ˆFace-verification-and-binary-classificationï¼‰"><a href="#4-5-é¢éƒ¨éªŒè¯ä¸äºŒåˆ†ç±»ï¼ˆFace-verification-and-binary-classificationï¼‰" class="headerlink" title="4.5 é¢éƒ¨éªŒè¯ä¸äºŒåˆ†ç±»ï¼ˆFace verification and binary classificationï¼‰"></a>4.5 é¢éƒ¨éªŒè¯ä¸äºŒåˆ†ç±»ï¼ˆFace verification and binary classificationï¼‰</h4><p>é™¤äº†triplet lossï¼Œä¹Ÿå¯ä»¥æŠŠverificationå½“ä½œä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/183.png' width="80%" height="80%"/ loading="lazy">

<p>ä½¿ç”¨siameseçš„æ¶æ„ï¼Œä¸¤å¼ å›¾ç‰‡åˆ†åˆ«è®¡ç®—ç¼–ç ï¼Œç„¶åè¾“å…¥ä¸€ä¸ªé€»è¾‘å›å½’å•å…ƒï¼Œè¿›è¡Œé¢„æµ‹ï¼Œç›¸åŒçš„èº«ä»½è¾“å‡º1ï¼Œä¸åŒçš„èº«ä»½è¾“å‡º0ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>siameseæ¶æ„ï¼Œä¸Šä¸‹ä¸¤ä¸ªç½‘ç»œæ˜¯ç›¸åŒçš„ã€‚</li>
<li>è¾“å…¥æ˜¯ä¸¤å¼ å›¾ç‰‡ï¼Œè¾“å‡ºä¸€ä¸ª0æˆ–1ã€‚</li>
<li>å‡è®¾ä¸Šé¢æ˜¯æ¯æ¬¡è¦è¯†åˆ«çš„æ–°å›¾ç‰‡ï¼Œä¸‹é¢æ˜¯æ•°æ®é›†çš„å›¾ç‰‡ï¼Œå¯ä»¥æŠŠæ•°æ®é›†å›¾ç‰‡çš„ç¼–ç éƒ½ä¿å­˜ä¸‹æ¥ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½ç»è¿‡ç½‘ç»œï¼Œä¹Ÿä¸éœ€è¦ä¿å­˜åŸå›¾ç‰‡ã€‚</li>
</ul>
<p>æ€»è§ˆï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/184.png' width="80%" height="80%"/ loading="lazy">

<p>åˆ›å»ºäºŒå…ƒç»„æ•°æ®é›†ã€‚</p>
<h4 id="4-6-ä»€ä¹ˆæ˜¯ç¥ç»é£æ ¼è¿ç§»ï¼Ÿï¼ˆneural-style-transferï¼‰"><a href="#4-6-ä»€ä¹ˆæ˜¯ç¥ç»é£æ ¼è¿ç§»ï¼Ÿï¼ˆneural-style-transferï¼‰" class="headerlink" title="4.6 ä»€ä¹ˆæ˜¯ç¥ç»é£æ ¼è¿ç§»ï¼Ÿï¼ˆneural style transferï¼‰"></a>4.6 ä»€ä¹ˆæ˜¯ç¥ç»é£æ ¼è¿ç§»ï¼Ÿï¼ˆneural style transferï¼‰</h4><p>æŠŠ Style è¿ç§»åˆ° Content ä¸Šã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/185.png' width="80%" height="80%"/ loading="lazy">

<p>è¦å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œéœ€è¦ç»„åˆä¸åŒæ·±åº¦ã€ä¸åŒå±‚çš„å·ç§¯ç¥ç»ç½‘ç»œçš„ä¸­é—´å€¼ã€‚</p>
<h4 id="4-7-æ·±åº¦å·ç§¯ç½‘ç»œåœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ"><a href="#4-7-æ·±åº¦å·ç§¯ç½‘ç»œåœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4.7 æ·±åº¦å·ç§¯ç½‘ç»œåœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ"></a>4.7 æ·±åº¦å·ç§¯ç½‘ç»œåœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ</h4><p>ç›´è§‚ç†è§£ï¼šå·ç§¯ç½‘ç»œä¸­æ·±åº¦è¾ƒå¤§çš„å±‚åœ¨åšä»€ä¹ˆã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/186.png' width="80%" height="80%"/ loading="lazy">

<p>å¯è§†åŒ– Layer 1 çš„9ä¸ªæœ€å¤§ç¨‹åº¦æ¿€æ´»çš„éšè—unitsã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªunitsåœ¨ç†è§£ä¸€äº›æ¯”è¾ƒç®€å•çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é¢œè‰²ã€è¾¹ç¼˜ã€‚</p>
<p>éšç€å±‚æ•°åŠ å¤§ï¼Œç½‘ç»œç†è§£ä¸€äº›é«˜ç»´ã€å®Œæ•´çš„ç‰¹å¾ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/187.png' width="80%" height="80%"/ loading="lazy">

<p>å¯ä»¥è”æƒ³â€œæ„Ÿå—é‡â€çš„æ¦‚å¿µã€‚</p>
<h4 id="4-8-ä»£ä»·å‡½æ•°"><a href="#4-8-ä»£ä»·å‡½æ•°" class="headerlink" title="4.8 ä»£ä»·å‡½æ•°"></a>4.8 ä»£ä»·å‡½æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/188.png' width="80%" height="80%"/ loading="lazy">

<p>$$J(G) &#x3D; \alpha J_{content}(C, G) + \beta J_{style}(S,G)  $$  </p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/189.png' width="80%" height="80%"/ loading="lazy">

<p>è·å¾—ç”Ÿæˆå›¾ç‰‡Gçš„æ­¥éª¤ï¼š</p>
<ul>
<li><p>éšæœºåˆå§‹åŒ–G</p>
</li>
<li><p>æ¢¯åº¦ä¸‹é™ï¼Œåœ¨æœ€å°åŒ–æŸå¤±å‡½æ•°çš„è¿‡ç¨‹ä¸­æ›´æ–°G</p>
</li>
</ul>
<h4 id="4-9-å†…å®¹ä»£ä»·å‡½æ•°"><a href="#4-9-å†…å®¹ä»£ä»·å‡½æ•°" class="headerlink" title="4.9 å†…å®¹ä»£ä»·å‡½æ•°"></a>4.9 å†…å®¹ä»£ä»·å‡½æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/190.png' width="80%" height="80%"/ loading="lazy">

<p>ç”¨é¢„è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œçš„éšè—å±‚ $l$ æ¥è®¡ç®—å†…å®¹æŸå¤±ï¼Œé€šå¸¸é€‰æ‹© $l$ åœ¨ç½‘ç»œçš„ä¸­é—´å±‚ï¼Œä¸å¤ªæµ…ä¹Ÿä¸å¤ªæ·±ã€‚</p>
<p>å°±åƒæœ¬ç« å‰é¢æ‰€è®²ï¼Œæˆ‘ä»¬ç”¨è¿™å¼ å›¾ç‰‡çš„ç¼–ç æ¥è®¡ç®—å†…å®¹æŸå¤±ã€‚</p>
<p>$$J_{content}(C,G) &#x3D; \frac{1}{2}||a^{(l)(C)}- a^{(l)(G)}||^2  $$</p>
<h4 id="4-10-é£æ ¼ä»£ä»·å‡½æ•°"><a href="#4-10-é£æ ¼ä»£ä»·å‡½æ•°" class="headerlink" title="4.10 é£æ ¼ä»£ä»·å‡½æ•°"></a>4.10 é£æ ¼ä»£ä»·å‡½æ•°</h4><img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/191.png' width="80%" height="80%"/ loading="lazy">

<p>æŠŠå›¾ç‰‡çš„é£æ ¼å®šä¹‰ä¸ºï¼š$l$ å±‚ä¸­å„ä¸ªé€šé“ä¹‹é—´æ¿€æ´»é¡¹çš„ç›¸å…³æ€§ç³»æ•°ã€‚</p>
<p>å¦‚ä½•è®¡ç®—è¿™ä¸ªç³»æ•°ï¼Ÿ</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/192.png' width="80%" height="80%"/ loading="lazy">

<p>æ¯”å¦‚æˆ‘ä»¬æœ‰çº¢è‰²ã€é»„è‰²ä¸¤ä¸ªchannelçš„æ¿€æ´»å€¼ï¼Œå¦‚ä¸Šå›¾å·¦ä¸‹æ–¹æ‰€ç¤ºï¼Œçº¢è‰²channelå­¦ä¹ å‚ç›´çº¹ç†ï¼Œé»„è‰²channelå­¦ä¹ æ©˜çº¢è‰²ï¼Œä»€ä¹ˆæ—¶å€™ä¸¤ä¸ªé€šé“æœ‰è¾ƒé«˜çš„ç›¸å…³æ€§å‘¢ï¼Ÿ</p>
<ul>
<li>å›¾ç‰‡ä¸­å‡ºç°å‚ç›´çº¹ç†çš„åœ°æ–¹ï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯æ©˜çº¢è‰²çš„ï¼Œå°±è¯´è¿™ä¸¤ä¸ªchannelæœ‰ç›¸å…³æ€§ã€‚</li>
<li>å›¾ç‰‡ä¸­æœ‰å‚ç›´çº¹ç†çš„åœ°æ–¹ï¼Œå¾ˆå°æ¦‚ç‡æ˜¯æ©˜çº¢è‰²çš„ï¼Œå°±è¯´è¿™ä¸¤ä¸ªchannelæ²¡æœ‰ç›¸å…³æ€§ã€‚</li>
</ul>
<p>ç›¸å…³ç³»æ•°åº¦é‡çš„å°±æ˜¯è¿™ä¸ªæ¦‚ç‡ã€‚</p>
<p>åœ¨ç”Ÿæˆå›¾åƒGä¸­ï¼Œæµ‹é‡channelä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼Œä¸Sçš„ç›¸å…³ç³»æ•°åšå¯¹æ¯”ã€‚è¿™æ ·å°±èƒ½æµ‹é‡ç”Ÿæˆå›¾åƒGçš„é£æ ¼å’Œè¾“å…¥å›¾åƒSçš„ç›¸ä¼¼ç¨‹åº¦äº†ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/193.png' width="80%" height="80%"/ loading="lazy">

<p>å¯¹äºGå’ŒSï¼Œåˆ†åˆ«è®¡ç®—ä¸€ä¸ªé£æ ¼çŸ©é˜µã€‚</p>
<ul>
<li>ç”¨ç¬¬ $l$ å±‚æ¥æµ‹é‡é£æ ¼ï¼Œ$a^{[l]}_{i,j,k} $ æ˜¯ $l$ å±‚ä¸­ $(i,j,k)$ ä½ç½®çš„æ¿€æ´»å€¼ã€‚$i,j,k$ åˆ†åˆ«æ˜¯é«˜åº¦ã€å®½åº¦ã€channelã€‚</li>
<li>$G^{(l)(S)}$ æ˜¯ç¬¬ $l$ å±‚çš„é£æ ¼çŸ©é˜µï¼Œè§„æ ¼æ˜¯ $n_c^{(l)} \times n_c^{(l)}$ã€‚<ul>
<li>$S$ çš„é£æ ¼çŸ©é˜µï¼š$G_{kkâ€™}^{(l)(S)}&#x3D;\sum^{n^{(l)}_H}_{i&#x3D;1}\sum^{n^{(l)}_W}_{j&#x3D;1}a_{ijk}^{(l)(S)}a_{ijkâ€™}^{(l)(S)}  $ </li>
<li>$G$ çš„é£æ ¼çŸ©é˜µï¼š$G_{kkâ€™}^{(l)(G)}&#x3D;\sum^{n^{(l)}_H}_{i&#x3D;1}\sum^{n^{(l)}_W}_{j&#x3D;1}a_{ijk}^{(l)(G)}a_{ijkâ€™}^{(l)(G)}  $ </li>
<li>ç”¨ $G$ è¿™ä¸ªå­—æ¯æ¥è¡¨ç¤ºæ˜¯å› ä¸ºåœ¨çº¿æ€§ä»£æ•°ä¸­è¿™ä¹Ÿå« â€œgram matrixâ€</li>
<li>åšçš„äº‹æƒ…ï¼šéå†å›¾ä¸­å„ä¸ªé«˜åº¦å’Œå®½åº¦ï¼Œå°† $k$ å’Œ $kâ€™$ é€šé“ä¸­å¯¹åº”ä½ç½®çš„æ¿€æ´»é¡¹ç›¸ä¹˜å¹¶æ±‚å’Œã€‚å¦‚æœä¸¤ä¸ªé€šé“å¯¹åº”çš„æ¿€æ´»å€¼ $a$ ç›¸å…³ï¼Œ$G$ å°±å¤§ã€‚</li>
</ul>
</li>
</ul>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/194.png' width="80%" height="80%"/ loading="lazy">

<p>æœ€ç»ˆçš„é£æ ¼æŸå¤±å‡½æ•°ï¼š</p>
<p>$$ J_{style}^{(l)}(S,G) &#x3D; ||G^{(l)(S)} - G^{(l)(G)}  ||^2_F    $$</p>
<p>ä¹Ÿå¯ä»¥å®šä¹‰ç¥ç»ç½‘ç»œæ‰€æœ‰å±‚çš„é£æ ¼æŸå¤±å‡½æ•°ï¼š</p>
<p>$$ J_{style}(S,G)&#x3D;\sum _l \lambda^{(l)} J_{style}^{(l)}(S,G)   $$</p>
<h4 id="4-11-å›¾åƒçš„ä¸€ç»´å’Œä¸‰ç»´æ‰©å±•"><a href="#4-11-å›¾åƒçš„ä¸€ç»´å’Œä¸‰ç»´æ‰©å±•" class="headerlink" title="4.11 å›¾åƒçš„ä¸€ç»´å’Œä¸‰ç»´æ‰©å±•"></a>4.11 å›¾åƒçš„ä¸€ç»´å’Œä¸‰ç»´æ‰©å±•</h4><p>ä»2Då›¾åƒåˆ°1Då¿ƒç”µå›¾ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/195.png' width="80%" height="80%"/ loading="lazy">

<p>ç”¨ä¸€ä¸ª 1Ã—5 filter å·ç§¯ 1Ã—14 åŸæ•°æ®ï¼Œå¾—åˆ° 1Ã—10 çš„è¾“å‡ºã€‚</p>
<p>å¤šé€šé“filtersåŒç†ã€‚ç”¨32ä¸ª 5Ã—16 filter å·ç§¯ 10Ã—16 åŸæ•°æ®ï¼Œå¾—åˆ° 6Ã—32 çš„è¾“å‡ºã€‚</p>
<p>å½“ç„¶ä¹Ÿæœ‰RNNç­‰ä¸“é—¨å¤„ç†åºåˆ—åŒ–æ•°æ®çš„ç½‘ç»œã€‚</p>
<p>3Dæ•°æ®ä¸¾ä¾‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/196.png' width="80%" height="80%"/ loading="lazy">

<p>CTæ‰«æï¼Œè‹¥å¹²çš„åˆ‡ç‰‡ã€‚</p>
<p>3Dæ•°æ®çš„å·ç§¯å¦‚ä¸‹ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/197.png' width="80%" height="80%"/ loading="lazy">





<h2 id="ç¬¬äº”è¯¾-åºåˆ—æ¨¡å‹-Sequence-Models"><a href="#ç¬¬äº”è¯¾-åºåˆ—æ¨¡å‹-Sequence-Models" class="headerlink" title="ç¬¬äº”è¯¾ åºåˆ—æ¨¡å‹(Sequence Models)"></a>ç¬¬äº”è¯¾ åºåˆ—æ¨¡å‹(Sequence Models)</h2><p>æš‚æ—¶ç©ºç¼º</p>
<h1 id="ç¬¬å››éƒ¨åˆ†ï¼šTensorflow-2-0-ç¬”è®°"><a href="#ç¬¬å››éƒ¨åˆ†ï¼šTensorflow-2-0-ç¬”è®°" class="headerlink" title="ç¬¬å››éƒ¨åˆ†ï¼šTensorflow 2.0 ç¬”è®°"></a>ç¬¬å››éƒ¨åˆ†ï¼šTensorflow 2.0 ç¬”è®°</h1><p>æ•´ç†è‡ªåŒ—å¤§æ›¹å»ºè€å¸ˆç½‘è¯¾ï¼Œè§<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1B7411L7Qt">æ­¤å¤„</a></p>
<h3 id="1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1  åŸºæœ¬æ¦‚å¿µ"></a>1  åŸºæœ¬æ¦‚å¿µ</h3><h4 id="1-1-å¼ é‡-Tensor"><a href="#1-1-å¼ é‡-Tensor" class="headerlink" title="1.1 å¼ é‡ Tensor"></a>1.1 å¼ é‡ Tensor</h4><p>Tensorï¼šå¤šç»´æ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰ã€‚é˜¶ï¼šå¼ é‡çš„ç»´æ•°ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf1.png'  width="80%" height="80%"/ loading="lazy">

<p>æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li>æ•´å‹ã€æµ®ç‚¹å‹ï¼š<code>tf.int32</code> <code>tf.float32</code> <code>tf.float64</code> </li>
<li>boolå‹ï¼š<code>tf.constant([True, False])</code> </li>
<li>stringå‹ï¼š<code>tf.constant(&quot;Hello, world.&quot;)</code></li>
</ul>
<p>åˆ›å»ºå¼ é‡ï¼š</p>
<ul>
<li><p>zç›´æ¥åˆ›å»ºï¼š<code>tf.constant(å¼ é‡å†…å®¹, dtype=æ•°æ®ç±»å‹)</code></p>
</li>
<li><p>å°†numpyè½¬æ¢ä¸ºTensorï¼š<code>tf.convert_to_tensor(åŸæ•°æ®å, dtype=æ•°æ®ç±»å‹)</code></p>
</li>
<li><p>ç‰¹æ®Šå¼ é‡ï¼š<code>tf.zeros(ç»´åº¦)</code> <code>tf.ones(ç»´åº¦)</code> <code>tf.fill(ç»´åº¦ï¼ŒæŒ‡å®šå€¼)</code>ï¼Œå¦‚<code>tf.fill([3, 2, 4], 10)</code></p>
</li>
</ul>
<blockquote>
<p>ç»´åº¦çš„è¡¨ç¤ºï¼šå‘é‡[ , , ]çš„é€—å·éš”å¼€æ¯ä¸ªç»´åº¦çš„å…ƒç´ ä¸ªæ•°ã€‚æœ‰å‡ ä¸ªé€—å·å°±ä»£è¡¨tensoræœ‰+1ç»´ã€‚</p>
</blockquote>
<ul>
<li>éšæœºå¼ é‡ï¼š<ul>
<li>æ­£æ€åˆ†å¸ƒï¼š<code>tf.random.normal(ç»´åº¦, mean=å‡å€¼, stddev=æ ‡å‡†å·®)</code></li>
<li>æˆªæ–­å¼æ­£æ€åˆ†å¸ƒï¼š<code>tf.random.truncated_normal(ç»´åº¦, mean=å‡å€¼, stddev=è¢«ä¾¦æµ‹)</code></li>
<li>å‡åŒ€åˆ†å¸ƒéšæœºæ•°ï¼š<code>tf.random.uniform(ç»´åº¦, minval=æœ€å°å€¼, maxval=æœ€å¤§å€¼)</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>åŒºé—´å·¦é—­å³å¼€</p>
</blockquote>
<h4 id="1-2-å¸¸ç”¨å‡½æ•°"><a href="#1-2-å¸¸ç”¨å‡½æ•°" class="headerlink" title="1.2 å¸¸ç”¨å‡½æ•°"></a>1.2 å¸¸ç”¨å‡½æ•°</h4><ul>
<li><p><code>tf.cast(åŸå¼ é‡å, dtype=æ•°æ®ç±»å‹)</code> ï¼Œå¼ºåˆ¶ç±»å‹è½¬æ¢</p>
</li>
<li><p><code>tf.reduce_min(å¼ é‡å)</code> <code>tf.reduce_max(å¼ é‡å)</code> ï¼Œè®¡ç®—å¼ é‡ç»´åº¦ä¸Šçš„æœ€å€¼</p>
</li>
<li><p>axisï¼šåœ¨ä¸€ä¸ªäºŒä½å¼ é‡æˆ–æ•°ç»„ä¸­ï¼Œå¯ä»¥é€šè¿‡axisæ§åˆ¶æ‰§è¡Œç»´åº¦ã€‚</p>
<ul>
<li>axis&#x3D;0 ä»£è¡¨è·¨ç¬¬ä¸€ä¸ªç»´åº¦ï¼ˆè·¨è¡Œï¼Œç»åº¦ï¼Œçºµå‘æ“ä½œï¼Œdownï¼‰</li>
<li>axis&#x3D;1 ä»£è¡¨è·¨ç¬¬äºŒä¸ªç»´åº¦ï¼ˆè·¨åˆ—ï¼Œçº¬åº¦ï¼Œæ¨ªå‘æ“ä½œï¼Œacrossï¼‰</li>
</ul>
</li>
</ul>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf2.png'  width="80%" height="80%"/ loading="lazy">

<ul>
<li><p><code>tf.Variable()</code> ï¼Œæ ‡è®°ä¸ºâ€œå¯è®­ç»ƒâ€ã€‚è¢«æ ‡è®°çš„å˜é‡ä¼šåœ¨åå‘ä¼ æ’­ä¸­è®°å½•æ¢¯åº¦ä¿¡æ¯ã€‚ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œå¸¸ç”¨è¯¥å‡½æ•°æ ‡è®°å¾…è®­ç»ƒçš„å‚æ•°ã€‚</p>
</li>
<li><p>å¦‚ï¼š<code>w = tf.Variable(tf.random.normal([2, 2], mean=0, stddev=1))</code></p>
</li>
<li><p>æ•°å­¦è¿ç®—ï¼š</p>
<ul>
<li>å››åˆ™è¿ç®—ï¼š<code>tf.add</code> ï¼Œ<code>tf.subtract</code> ï¼Œ<code>tf.multiply</code> ï¼Œ<code>tf.divide</code>ï¼Œå‚æ•°ä¸ºä¸¤ä¸ªå¼ é‡ï¼Œå¿…é¡»ç»´åº¦ç›¸åŒã€‚</li>
<li>æŒ‡æ•°è¿ç®—ï¼š<code>tf.square</code> ï¼Œ<code>tf.pow</code> ï¼Œ<code>tf.sqrt</code></li>
<li>çŸ©é˜µä¹˜æ³•ï¼š<code>tf.matmul</code></li>
</ul>
</li>
<li><p><code>tf.data.Dataset.from_tensor_slices((è¾“å…¥ç‰¹å¾ï¼Œæ ‡ç­¾))</code>ï¼ŒæŠŠç‰¹å¾å€¼å’Œæ ‡ç­¾é…å¯¹ã€‚Numpyå’ŒTensoræ ¼å¼éƒ½å¯ç”¨è¯¥è¯­å¥è¯»å…¥æ•°æ®</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">features <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dataset <span class="token operator">=</span> tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<ul>
<li>åœ¨withç»“æ„ä¸­ï¼Œä½¿ç”¨GradientTapeï¼Œå®ç°æŸä¸ªå‡½æ•°å¯¹æŒ‡å®šå‚æ•°çš„æ±‚å¯¼è¿ç®—ã€‚withç»“æ„è®°å½•è®¡ç®—è¿‡ç¨‹ï¼Œgradientæ±‚å‡ºå¼ é‡çš„æ¢¯åº¦</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> tf<span class="token punctuation">.</span>GradientTape<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tape<span class="token punctuation">:</span>
	w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	loss <span class="token operator">=</span> tf<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
grad <span class="token operator">=</span> tape<span class="token punctuation">.</span>gradient<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> w<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>grad<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>æ¢¯åº¦æ˜¯ 2*w&#x3D;6.0ï¼Œè¿è¡Œç»“æœï¼š<code>tf.Tensor(6.0, shape=(), dtype=float32)</code></p>
</li>
<li><p><code>enumerate()</code>ï¼Œç´¢å¼•ï¼Œè¿”å›ç´¢å¼•å’Œå…ƒç´ ï¼š</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">seq <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> element <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>seq<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> element<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<pre class="language-markdown" data-language="markdown"><code class="language-markdown">0 one
1 two
2 three</code></pre>
</li>
<li><p><code>tf.one_hot(å¸¦è½¬æ¢æ•°æ®, depth=å‡ åˆ†ç±»)</code>ï¼Œè½¬æ¢æˆone-hotç¼–ç ï¼š</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">calsses <span class="token operator">=</span> <span class="token number">3</span>
labels <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
output <span class="token operator">=</span> tf<span class="token punctuation">.</span>one_hot<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> depth<span class="token operator">=</span>classes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<pre class="language-markdown" data-language="markdown"><code class="language-markdown">([[0. 1. 0.]
  [1. 0. 0.]
  [0. 0. 1.]], shape=(3, 3), dtype=float32)</code></pre>
</li>
<li><p><code>tf.nn.softmax(å¼ é‡)</code>ï¼Œ$Softmax(y_i)&#x3D;\frac{e^{y_i}}{\sum_{j&#x3D;0}^ne^{y_i}}$ï¼Œä½¿è¾“å‡ºç¬¦åˆæ¦‚ç‡åˆ†å¸ƒ</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">y <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.01</span><span class="token punctuation">,</span> <span class="token number">2.01</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.66</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y_pro <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_pro<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<pre class="language-markdown" data-language="markdown"><code class="language-markdown">tf.Tensor([0.22598174 0.69583046 0.0481878 ], shape=(3,), dtype=float32)</code></pre>
</li>
<li><p><code>w.assign_sub(wè¦è‡ªå‡çš„å€¼) </code>ï¼Œå‚æ•°è‡ªæ›´æ–°</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
w<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<p><code>&lt;tf.Variable &#39;Variable:0&#39; shape=() dtype=int32, numpy=3&gt;</code></p>
</li>
<li><p><code>tf.argmax(å¼ é‡å, axis=æ“ä½œè½´)</code>ï¼Œè¿”å›å¼ é‡æ²¿æŒ‡å®šç»´åº¦æœ€å¤§å€¼çš„ç´¢å¼•</p>
</li>
</ul>
<h3 id="2-ä¼˜åŒ–æ–¹æ³•"><a href="#2-ä¼˜åŒ–æ–¹æ³•" class="headerlink" title="2 ä¼˜åŒ–æ–¹æ³•"></a>2 ä¼˜åŒ–æ–¹æ³•</h3><h4 id="2-1-ä¸€äº›å‡½æ•°"><a href="#2-1-ä¸€äº›å‡½æ•°" class="headerlink" title="2.1 ä¸€äº›å‡½æ•°"></a>2.1 ä¸€äº›å‡½æ•°</h4><ul>
<li><code>tf.where(æ¡ä»¶è¯­å¥, A, B)</code>ï¼Œæ¡ä»¶ä¸ºçœŸè¿”å›Aï¼Œæ¡ä»¶ä¸ºå‡è¿”å›B</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> tf<span class="token punctuation">.</span>where<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>greater<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<p><code>tf.Tensor([1, 2, 3, 4, 5], shape=(5,), dtype=int32)</code></p>
</li>
<li><p><code>np.random.RandomState.rand(ç»´åº¦)</code>ï¼Œè¿”å›æŒ‡å®šç»´åº¦çš„ [0, 1] çš„éšæœºæ•°ã€‚ç»´åº¦ä¸ºç©ºåˆ™è¿”å›ä¸€ä¸ªæ ‡é‡</p>
</li>
<li><p><code>np.vstack(æ•°ç»„1, æ•°ç»„2)</code>ï¼Œå°†ä¸¤ä¸ªæ•°ç»„æŒ‰å‚ç›´æ–¹å‘å åŠ </p>
</li>
<li><p>æ„å»ºç½‘æ ¼åæ ‡ç‚¹ï¼š</p>
<ul>
<li><p><code>np.mgrid[èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿, èµ·å§‹å€¼:ç»“æŸå€¼:æ­¥é•¿, ...]</code></p>
</li>
<li><p><code>x.ravel()</code>ï¼ŒæŠŠxå˜ä¸ºä¸€ç»´æ•°ç»„ï¼ŒæŠŠå˜é‡xæ‹‰ç›´</p>
</li>
<li><p><code>np.c_[æ•°ç»„1, æ•°ç»„2, ...]</code>ï¼Œä½¿è¿”å›çš„é—´éš”æ•°å€¼ç‚¹é…å¯¹</p>
</li>
</ul>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">x<span class="token punctuation">,</span> y <span class="token operator">=</span> np<span class="token punctuation">.</span>mgrid<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">0.5</span><span class="token punctuation">]</span>
grid <span class="token operator">=</span> np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>x<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x:"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"y:"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"grid:"</span><span class="token punctuation">,</span> grid<span class="token punctuation">)</span></code></pre>

<ul>
<li><p>è¿è¡Œç»“æœï¼š</p>
<pre class="language-markdown" data-language="markdown"><code class="language-markdown">x:[[1. 1. 1. 1.]
   [2. 2. 2. 2.]]
y:[[2.  2.5 3.  3.5]
   [2.  2.5 3.  3.5]]
grid:
 [[1.  2. ]
  [1.  2.5]
  [1.  3. ]
  [1.  3.5]
  [2.  2. ]
  [2.  2.5]
  [2.  3. ]
  [2.  3.5]]</code></pre></li>
</ul>
<h4 id="2-2-æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡"><a href="#2-2-æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡" class="headerlink" title="2. 2 æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡"></a>2. 2 æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡</h4><pre class="language-none"><code class="language-none">LR_BASE &#x3D; 0.2
LR_DECAY &#x3D; 0.99
LR_STEP &#x3D; 1
for epoch in range(epoch):
lr &#x3D; LR_BASE * LR_DECAY ** (epoch &#x2F; LR_STEP)</code></pre>

<h4 id="2-3-æ¿€æ´»å‡½æ•°"><a href="#2-3-æ¿€æ´»å‡½æ•°" class="headerlink" title="2.3 æ¿€æ´»å‡½æ•°"></a>2.3 æ¿€æ´»å‡½æ•°</h4><ul>
<li><code>tf.nn.sigmoid(x)</code>ï¼Œsigmoidçš„å¯¼æ•°ä¸º [0, 0.25] çš„å°æ•°ï¼Œå¤šå±‚ç¥ç»ç½‘ç»œé“¾å¼æ±‚å¯¼æ—¶ï¼Œå¦‚æœè¿ç»­ç›¸ä¹˜ä¼šé€ æˆæ¢¯åº¦æ¶ˆå¤±</li>
<li><code>tf.math.tanh(x)</code>ï¼Œè¾“å‡ºæ˜¯0å‡å€¼äº†ï¼Œä½†ä¾ç„¶å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±ã€å¹‚è¿ç®—é—®é¢˜</li>
<li><code>tf.nn.relu(x)</code>ï¼Œè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¹¶ä¸”è®¡ç®—é€Ÿåº¦å¿«ï¼›è¾“å‡ºé0å‡å€¼ï¼Œæ”¶æ•›æ…¢ï¼Œå¹¶ä¸”å­˜åœ¨dead relué—®é¢˜<ul>
<li>dead reluæ˜¯ç»è¿‡reluå‡½æ•°çš„è´Ÿæ•°ç‰¹å¾è¿‡å¤šå¯¼è‡´çš„ï¼Œå¯ä»¥åˆç†å‚æ•°åˆå§‹åŒ–ã€è®¾ç½®å°çš„å­¦ä¹ ç‡</li>
</ul>
</li>
<li><code>tf.nn.leaky_relu(x)</code>ï¼Œè§£å†³äº†dead relué—®é¢˜</li>
</ul>
<p>å»ºè®®ï¼šé¦–é€‰reluå‡½æ•°ï¼›å­¦ä¹ ç‡è®¾ç½®è¾ƒå°å€¼ï¼›è¾“å…¥ç‰¹å¾æ ‡å‡†åŒ–ï¼›åˆå§‹åŒ–å‚æ•°ä¸­å¿ƒåŒ–</p>
<h4 id="2-4-æŸå¤±å‡½æ•°"><a href="#2-4-æŸå¤±å‡½æ•°" class="headerlink" title="2.4 æŸå¤±å‡½æ•°"></a>2.4 æŸå¤±å‡½æ•°</h4><ul>
<li><p>å‡æ–¹è¯¯å·®mseï¼š$MSE(y_,y) &#x3D; \frac{\sum_{i&#x3D;1}^n(y-y_)^2}{n}$ </p>
<ul>
<li><code>loss_mse = tf.reduce_mean(tf.square(y_ - y))</code></li>
</ul>
</li>
<li><p>äº¤å‰ç†µæŸå¤±å‡½æ•°ceï¼š$H(y_, y) &#x3D; -\Sigma y_*lny$ </p>
<ul>
<li><code>loss_ce = tf.losses.categorical_crossentropy(y_, y)</code> </li>
<li>softmaxä¸äº¤å‰ç†µç»“åˆï¼Œè¾“å‡ºå…ˆè¿›è¡Œsoftmaxï¼Œå†è®¡ç®—yä¸y_çš„äº¤å‰ç†µæŸå¤±å‡½æ•°<ul>
<li><code>tf.nn.softmax_cross_entropy_with_logits(y_, y)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2-5-ç¼“è§£è¿‡æ‹Ÿåˆ"><a href="#2-5-ç¼“è§£è¿‡æ‹Ÿåˆ" class="headerlink" title="2.5 ç¼“è§£è¿‡æ‹Ÿåˆ"></a>2.5 ç¼“è§£è¿‡æ‹Ÿåˆ</h4><ul>
<li>æ¬ æ‹Ÿåˆçš„è§£å†³æ–¹æ³•ï¼šå¢åŠ æ¨¡å‹å¤æ‚åº¦ï¼Œå¢åŠ ç‰¹å¾ï¼Œå¢åŠ å‚æ•°ï¼›å‡å°æ­£åˆ™åŒ–ç³»æ•°</li>
<li>è¿‡æ‹Ÿåˆçš„è§£å†³æ–¹æ³•ï¼šæ•°æ®æ¸…æ´—ï¼›å¢å¤§æ•°æ®é›†ï¼›å¢å¤§æ­£åˆ™åŒ–å‚æ•°</li>
</ul>
<p>æ­£åˆ™åŒ–ï¼š</p>
<ul>
<li><p><code>loss = loss(yä¸y_)+ REGULARIZER *loss(w)â€‹</code></p>
<ul>
<li><p>$loss_{L1}(w) &#x3D; \sum_i|w_i|$ ï¼ŒL1æ­£åˆ™åŒ–ä¼šè®©å‚æ•°å˜ä¸º0ï¼Œå‡å°‘å‚æ•°æ•°é‡ï¼Œé™ä½å¤æ‚åº¦</p>
</li>
<li><p>$loss_{L2}(w) &#x3D; \sum_i|w_i^2|$ ï¼ŒL2æ­£åˆ™åŒ–ä¼šä½¿å‚æ•°æ¥è¿‘0ä½†ä¸ä¸º0ï¼Œé™ä½å¤æ‚åº¦</p>
</li>
</ul>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">loss_mse <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_train <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
loss_regularization <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
loss_regularization<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>l2_loss<span class="token punctuation">(</span>w1<span class="token punctuation">)</span><span class="token punctuation">)</span>
loss_regularizaiton<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>l2_loss<span class="token punctuation">(</span>w2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
æ±‚å’Œï¼Œä¾‹ï¼š
x = tf.constant(([1, 1, 1], [1, 1, 1]))
tf.reduce_sum(x)
>>>6
'''</span>
loss_regularization <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>loss_regularization<span class="token punctuation">)</span>
loss <span class="token operator">=</span> loss_mse <span class="token operator">+</span> <span class="token number">0.03</span> <span class="token operator">*</span> loss_regularization</code></pre>

<h4 id="2-6-ä¼˜åŒ–å™¨"><a href="#2-6-ä¼˜åŒ–å™¨" class="headerlink" title="2.6 ä¼˜åŒ–å™¨"></a>2.6 ä¼˜åŒ–å™¨</h4><p>å¾…ä¼˜åŒ–å‚æ•°$w$ï¼ŒæŸå¤±å‡½æ•°$loss$ï¼Œå­¦ä¹ ç‡$lr$ï¼Œæ¯æ¬¡è¿­ä»£ä¸€ä¸ª$batch$ï¼Œ$t$è¡¨ç¤ºå½“å‰$batch$è¿­ä»£çš„æ€»æ¬¡æ•°ï¼š</p>
<ol>
<li>è®¡ç®— $t$ æ—¶åˆ»æŸå¤±å‡½æ•°å…³äºå‚æ•°çš„æ¢¯åº¦ $g_t &#x3D; \nabla loss &#x3D; \frac{\partial loss}{\partial w_t}$ </li>
<li>è®¡ç®— $t$ æ—¶åˆ»ä¸€é˜¶åŠ¨é‡ $m_t$ å’ŒäºŒé˜¶åŠ¨é‡ $V_t$ </li>
<li>è®¡ç®— $t$ æ—¶åˆ»ä¸‹é™æ¢¯åº¦ $\eta_t &#x3D; lr \sdot m_t&#x2F;\sqrt{V_t} $ </li>
<li>è®¡ç®— $t+1$ æ—¶åˆ»å‚æ•° $w_{t+1} &#x3D; w_t - \eta_t &#x3D; w_t - lr \sdot m_t &#x2F; \sqrt{V_t}$</li>
</ol>
<h5 id="å‡ ç§ä¼˜åŒ–å™¨"><a href="#å‡ ç§ä¼˜åŒ–å™¨" class="headerlink" title="å‡ ç§ä¼˜åŒ–å™¨"></a>å‡ ç§ä¼˜åŒ–å™¨</h5><p>SGDï¼šéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆæ— momentumï¼‰</p>
<ul>
<li><p>$m_t &#x3D; g_t \qquad V_t &#x3D; 1$ </p>
</li>
<li><p>$w_{t+1} &#x3D; w_t - lr \sdot \frac{\partial loss}{\partial w_t} $</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">w1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>

<p>SGDMï¼šå«momentumçš„SGD</p>
<ul>
<li><p>$m_t &#x3D; \beta \sdot m_{t-1}+(1-\beta)\sdot g_t \qquad V_t &#x3D; 1$ </p>
</li>
<li><p>$w_{t+1} &#x3D; w_t - lr \sdot (\beta \sdot m_{t-1}+(1-\beta)\sdot g_t) $</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">m_w <span class="token operator">=</span> beta <span class="token operator">*</span> m_w <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta<span class="token punctuation">)</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
m_b <span class="token operator">=</span> beta <span class="token operator">*</span> m_b <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta<span class="token punctuation">)</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
w1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> m_w<span class="token punctuation">)</span>
b1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> m_b<span class="token punctuation">)</span></code></pre>

<p>Adagradï¼šåœ¨SGDï¼ˆæ— momentumï¼‰çš„åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</p>
<ul>
<li><p>$m_t &#x3D; g_t \qquad V_t &#x3D; \sum^t_{\tau&#x3D;1}g_\tau^2$ </p>
</li>
<li><p>$w_{t+1} &#x3D; w_t - lr \sdot g_t&#x2F;(\sqrt{\sum^t_{\tau&#x3D;1}g_\tau^2})$</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">v_w<span class="token punctuation">,</span> v_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token comment"># adagrad</span>
v_w <span class="token operator">+=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
v_b <span class="token operator">+=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
w1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_w<span class="token punctuation">)</span><span class="token punctuation">)</span>
b1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_b<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<p>RMSPropï¼šåœ¨SGDï¼ˆæ— momentumï¼‰çš„åŸºç¡€ä¸Šå¢åŠ äºŒé˜¶åŠ¨é‡</p>
<ul>
<li><p>$m_t &#x3D; g_t \qquad V_t &#x3D; \beta \sdot V_{t-1}+(1-\beta) \sdot g_t^2$ </p>
</li>
<li><p>$w_{t+1} &#x3D; w_t - lr \sdot g_t&#x2F;(\sqrt{\beta \sdot V_{t-1}+(1-\beta) \sdot g_t^2})$</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">v_w<span class="token punctuation">,</span> v_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
beta <span class="token operator">=</span> <span class="token number">0.9</span>
<span class="token comment"># rmsprop</span>
v_w <span class="token operator">=</span> beta <span class="token operator">*</span> v_w <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta<span class="token punctuation">)</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
v_b <span class="token operator">=</span> beta <span class="token operator">*</span> v_b <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta<span class="token punctuation">)</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
w1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_w<span class="token punctuation">)</span><span class="token punctuation">)</span>
b1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_b<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<p>Adamï¼šåŒæ—¶ç»“åˆSGDMä¸€é˜¶åŠ¨é‡å’ŒRMSPropäºŒé˜¶åŠ¨é‡</p>
<ul>
<li><p>$m_t &#x3D; \beta_1 \sdot m_{t-1}+(1-\beta_1)\sdot g_t \qquad V_t &#x3D; \beta_2 \sdot V_{step-1}+(1-\beta_2) \sdot g_t^2$ </p>
</li>
<li><p>ä¿®æ­£ä¸€é˜¶åŠ¨é‡çš„åå·® $\widehat{m_t} &#x3D; \frac{m_t}{1-\beta_1^t}$ </p>
</li>
<li><p>ä¿®æ­£äºŒé˜¶åŠ¨é‡çš„åå·® $\widehat{V_t} &#x3D; \frac{V_t}{1-\beta_2^t}$ </p>
</li>
<li><p>$w_{t+1} &#x3D; w_t - lr \sdot \frac{m_t}{1-\beta_1^t}&#x2F;\sqrt{\frac{V_t}{1-\beta_2^t}}$</p>
</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">m_w<span class="token punctuation">,</span> m_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
v_w<span class="token punctuation">,</span> v_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
beta1<span class="token punctuation">,</span> beta2 <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.999</span>
delta_w<span class="token punctuation">,</span> delta_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
global_step <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment"># adam</span>
m_w <span class="token operator">=</span> beta1 <span class="token operator">*</span> m_w <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta1<span class="token punctuation">)</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
m_b <span class="token operator">=</span> beta1 <span class="token operator">*</span> m_b <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta1<span class="token punctuation">)</span> <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
v_w <span class="token operator">=</span> beta2 <span class="token operator">*</span> v_w <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta2<span class="token punctuation">)</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
v_b <span class="token operator">=</span> beta2 <span class="token operator">*</span> v_b <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> beta2<span class="token punctuation">)</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>grads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

m_w_correction <span class="token operator">=</span> m_w <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> tf<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>beta1<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>global_step<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m_b_correction <span class="token operator">=</span> m_b <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> tf<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>beta1<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>global_step<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
v_w_correction <span class="token operator">=</span> v_w <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> tf<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>beta2<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>global_step<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
v_b_correction <span class="token operator">=</span> v_b <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> tf<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>beta2<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>global_step<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

w1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> m_w_correction <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_w_correction<span class="token punctuation">)</span><span class="token punctuation">)</span>
b1<span class="token punctuation">.</span>assign_sub<span class="token punctuation">(</span>lr <span class="token operator">*</span> m_b_correction <span class="token operator">/</span> tf<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_b_correction<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>





<h3 id="3-ç¥ç»ç½‘ç»œæ­å»ºå…«è‚¡"><a href="#3-ç¥ç»ç½‘ç»œæ­å»ºå…«è‚¡" class="headerlink" title="3 ç¥ç»ç½‘ç»œæ­å»ºå…«è‚¡"></a>3 ç¥ç»ç½‘ç»œæ­å»ºå…«è‚¡</h3><h4 id="3-1-ä½¿ç”¨Sequentialæ­å»ºç¥ç»ç½‘ç»œ"><a href="#3-1-ä½¿ç”¨Sequentialæ­å»ºç¥ç»ç½‘ç»œ" class="headerlink" title="3.1 ä½¿ç”¨Sequentialæ­å»ºç¥ç»ç½‘ç»œ"></a>3.1 ä½¿ç”¨Sequentialæ­å»ºç¥ç»ç½‘ç»œ</h4><p>tf.kerasæ­å»ºç¥ç»ç½‘ç»œå…­æ­¥æ³•ï¼ˆä½¿ç”¨Sequentialï¼‰ï¼š</p>
<ol>
<li><p>import</p>
</li>
<li><p>train, testï¼šåˆ’åˆ†æ•°æ®é›†</p>
</li>
<li><p>model &#x3D; tf.keras.models.Sequentialï¼šé€å±‚æè¿°ç½‘ç»œç»“æ„ï¼Œå‰å‘ä¼ æ’­</p>
</li>
<li><p>model.compileï¼šé…ç½®è®­ç»ƒæ–¹æ³•ï¼Œé€‰æ‹©ä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°ã€è¯„æµ‹æŒ‡æ ‡</p>
</li>
<li><p>model.fitï¼šæ‰§è¡Œè®­ç»ƒè¿‡ç¨‹</p>
</li>
<li><p>model.summaryï¼šæ‰“å°ç½‘ç»œçš„ç»“æ„å’Œå‚æ•°ç»Ÿè®¡</p>
</li>
</ol>
<h5 id="Sequential"><a href="#Sequential" class="headerlink" title="Sequential"></a>Sequential</h5><p><code>model = tf.keras.models.Sequential([ç½‘ç»œç»“æ„])</code> </p>
<ul>
<li>æ‹‰ç›´å±‚ï¼š<code>tf.keras.layers.Flatten()</code> </li>
<li>å…¨è¿æ¥å±‚ï¼š<code>tf.keras.layers.Dense(ç¥ç»å…ƒä¸ªæ•°, activation=&quot;æ¿€æ´»å‡½æ•°&quot;, kernel_regularizer=å“ªç§æ­£åˆ™åŒ–)</code> <ul>
<li>æ¿€æ´»å‡½æ•°ï¼š<code>relu</code>, <code>softmax</code>, <code>sigmoid</code>, <code>tanh</code> </li>
<li>æ­£åˆ™åŒ–ï¼š<code>tf.keras.regularizers.l1()</code>, <code>tf.keras.regularizers.l2()</code></li>
</ul>
</li>
<li>å·ç§¯å±‚ï¼š<code>tf.keras.layers.Conv2D(fitlers=å·ç§¯æ ¸ä¸ªæ•°, kernel_size=å·ç§¯æ ¸å°ºå¯¸, strides=æ­¥é•¿, padding=&quot;valid&quot; or &quot;same&quot;) </code></li>
<li>LSTMå±‚ï¼š<code>tf.keras.layers.LSTM()</code></li>
</ul>
<h5 id="compile"><a href="#compile" class="headerlink" title="compile"></a>compile</h5><p><code>model.compile(optimizer=ä¼˜åŒ–å™¨, loss=æŸå¤±å‡½æ•°, metrics=[&quot;å‡†ç¡®ç‡&quot;])</code> </p>
<ul>
<li>optimizer å¯é€‰ï¼š<ul>
<li><code>&#39;sgd&#39;</code> or <code>tf.keras.optimizers.SGD(lr=å­¦ä¹ ç‡, momentum=åŠ¨é‡)</code> </li>
<li><code>&#39;adagrad&#39;</code> or <code>tf.keras.optimizers.Adagrad(lr=å­¦ä¹ ç‡)</code> </li>
<li><code>&#39;adadelta&#39;</code> or <code>tf.keras.optimizers.Adadelta(lr=å­¦ä¹ ç‡)</code> </li>
<li><code>&#39;adam&#39;</code> or <code>tf.keras.optimizers.Adam(lr=å­¦ä¹ ç‡, beta_1=0.9, beta_2=0.999)</code></li>
</ul>
</li>
<li>loss å¯é€‰ï¼š <ul>
<li><code>&#39;mse&#39;</code> or <code>tf.keras.losses.MeanSquaredError()</code> </li>
<li><code>&#39;sparse_categorical_crossentropy&#39;</code> or <code>tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False)</code> ï¼Œç¥ç»ç½‘ç»œé¢„æµ‹å‰æ²¡æœ‰ç»è¿‡æ¦‚ç‡åˆ†å¸ƒåˆ™æ˜¯Trueï¼Œç»è¿‡æ¦‚ç‡åˆ†å¸ƒå°±æ˜¯False</li>
</ul>
</li>
<li>metrics å¯é€‰ï¼š<ul>
<li><code>accuracy</code>ï¼šy_ å’Œ y éƒ½æ˜¯æ•°å€¼ï¼Œå¦‚ y_&#x3D;[1]  y&#x3D;[1]</li>
<li><code>categorical_accuracy</code>ï¼šy_ å’Œ y éƒ½æ˜¯ç‹¬çƒ­ç ï¼Œå¦‚ y_&#x3D;[0, 1, 0]  y&#x3D;[0.256, 0.695, 0.048]</li>
<li><code>sparse_categorical_accuracy</code>ï¼šy_ æ˜¯æ•°å€¼ï¼Œy æ˜¯ç‹¬çƒ­ç ï¼Œå¦‚ y_&#x3D;[1]  y&#x3D;[0.256, 0.695, 0.048]</li>
</ul>
</li>
</ul>
<h5 id="fit"><a href="#fit" class="headerlink" title="fit"></a>fit</h5><pre class="language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>è®­ç»ƒé›†ç‰¹å¾<span class="token punctuation">,</span> è®­ç»ƒé›†æ ‡ç­¾<span class="token punctuation">,</span> 
batch_size<span class="token operator">=</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token punctuation">,</span> 
validation_data<span class="token operator">=</span><span class="token punctuation">(</span>æµ‹è¯•é›†ç‰¹å¾<span class="token punctuation">,</span> æµ‹è¯•é›†æ ‡ç­¾<span class="token punctuation">)</span> <span class="token keyword">or</span> validation_split<span class="token operator">=</span>ä»è®­ç»ƒé›†åˆ’åˆ†å¤šå°‘æ¯”ä¾‹ç»™æµ‹è¯•é›†<span class="token punctuation">,</span> validation_freq<span class="token operator">=</span>å¤šå°‘epochæµ‹è¯•ä¸€æ¬¡<span class="token punctuation">)</span></code></pre>

<h5 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h5><p><code>model.summary()</code></p>
<h5 id="ä¸¾ä¾‹ï¼šé¸¢å°¾èŠ±è¯†åˆ«"><a href="#ä¸¾ä¾‹ï¼šé¸¢å°¾èŠ±è¯†åˆ«" class="headerlink" title="ä¸¾ä¾‹ï¼šé¸¢å°¾èŠ±è¯†åˆ«"></a>ä¸¾ä¾‹ï¼šé¸¢å°¾èŠ±è¯†åˆ«</h5><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 1. import</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 2. train, test</span>
x_train <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data
y_train <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>target

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>y_train<span class="token punctuation">)</span>
tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>set_seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>

<span class="token comment"># 3. Sequential</span>
model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">,</span> kernel_regularizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>regularizers<span class="token punctuation">.</span>l2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 4. compile</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 5. fit</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>

<span class="token comment"># 6. summary</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<h4 id="3-2-ä½¿ç”¨classæ­å»ºç¥ç»ç½‘ç»œ"><a href="#3-2-ä½¿ç”¨classæ­å»ºç¥ç»ç½‘ç»œ" class="headerlink" title="3.2  ä½¿ç”¨classæ­å»ºç¥ç»ç½‘ç»œ"></a>3.2  ä½¿ç”¨classæ­å»ºç¥ç»ç½‘ç»œ</h4><p>Sequentialæ”¯æŒæ­å»ºä¸Šå±‚è¾“å…¥æ˜¯ä¸‹å±‚è¾“å‡ºçš„ç¥ç»ç½‘ç»œï¼Œå¦‚æœæœ‰è·³è¿ï¼Œå¯ä»¥ç”¨classæ­å»ºã€‚</p>
<p>tf.kerasæ­å»ºç¥ç»ç½‘ç»œå…­æ­¥æ³•ï¼ˆä½¿ç”¨classï¼‰ï¼š</p>
<ol>
<li><p>import</p>
</li>
<li><p>train, test</p>
</li>
<li><p><strong>class MyModel(Model) model&#x3D;MyModel</strong></p>
</li>
<li><p>model.compile</p>
</li>
<li><p>model.fit</p>
</li>
<li><p>model.summary</p>
</li>
</ol>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyModel</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token builtin">super</span><span class="token punctuation">(</span>MyModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
		å®šä¹‰ç½‘ç»œç»“æ„å—
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    	è°ƒç”¨ç½‘ç»œç»“æ„å—ï¼Œå®ç°å‰å‘ä¼ æ’­
    	<span class="token keyword">return</span> y
model <span class="token operator">=</span> MyModel<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<p>ä»¥é¸¢å°¾èŠ±åˆ†ç±»çš„ç½‘ç»œä¸ºä¾‹ï¼š</p>
 <pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 1. import</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> Model
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 2. train, test</span>
x_train <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data
y_train <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>target

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>y_train<span class="token punctuation">)</span>
tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>set_seed<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>

<span class="token comment"># 3. class</span>
<span class="token keyword">class</span> <span class="token class-name">IrisModel</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token builtin">super</span><span class="token punctuation">(</span>IrisModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
		self<span class="token punctuation">.</span>d1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">,</span> kernel_regularizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>regularizers<span class="token punctuation">.</span>l2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    	y <span class="token operator">=</span> self<span class="token punctuation">.</span>d1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    	<span class="token keyword">return</span> y
    
model <span class="token operator">=</span> IrisModel<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 4. compile</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 5. fit</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>

<span class="token comment"># 6. summary</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<h4 id="3-3-MNIST-æ•°æ®é›†"><a href="#3-3-MNIST-æ•°æ®é›†" class="headerlink" title="3.3 MNIST æ•°æ®é›†"></a>3.3 MNIST æ•°æ®é›†</h4><p>MNISTæ•°æ®é›†æœ‰ 7 ä¸‡å¼  28*28 åƒç´ çš„æ‰‹å†™æ•°å­—ï¼Œå…¶ä¸­ 6 ä¸‡å¼ ç”¨äºè®­ç»ƒï¼Œ1 ä¸‡å¼ ç”¨äºæµ‹è¯•ã€‚</p>
<h5 id="Sequential-1"><a href="#Sequential-1" class="headerlink" title="Sequential"></a>Sequential</h5><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

mnist <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>mnist
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train<span class="token punctuation">,</span> x_test <span class="token operator">=</span> x_train <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">,</span> x_test <span class="token operator">/</span> <span class="token number">255.0</span>  <span class="token comment"># æŠŠ[0, 255]å˜ä¸º[0, 1]ï¼Œè¾“å…¥ç‰¹å¾å€¼å°æ›´æ˜“äºç¥ç»ç½‘ç»œå¸æ”¶</span>

model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span> 
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> validation_data<span class="token operator">=</span><span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h5 id="class"><a href="#class" class="headerlink" title="class"></a>class</h5><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Flatten
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> Model

mnist <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>mnist
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train<span class="token punctuation">,</span> x_test <span class="token operator">=</span> x_train <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">,</span> x_test <span class="token operator">/</span> <span class="token number">255.0</span>

<span class="token keyword">class</span> <span class="token class-name">MnistModel</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>MnistModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
	<span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>d2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y

model <span class="token operator">=</span> MnistModel<span class="token punctuation">(</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span> 
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> validation_data<span class="token operator">=</span><span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>





<h3 id="4-å…«è‚¡æ‰©å±•"><a href="#4-å…«è‚¡æ‰©å±•" class="headerlink" title="4 å…«è‚¡æ‰©å±•"></a>4 å…«è‚¡æ‰©å±•</h3><p>è‡ªåˆ¶æ•°æ®é›†ã€æ•°æ®å¢å¼ºã€æ–­ç‚¹ç»­è®­ï¼ˆå®æ—¶å­˜å–æ¨¡å‹ï¼‰ã€å‚æ•°æå–ï¼ˆæŠŠå‚æ•°å­˜å…¥æ–‡æœ¬ï¼‰ã€acc&#x2F;losså¯è§†åŒ–ã€åº”ç”¨ç¨‹åºã€‚</p>
<h4 id="4-1-è‡ªåˆ¶æ•°æ®é›†"><a href="#4-1-è‡ªåˆ¶æ•°æ®é›†" class="headerlink" title="4.1 è‡ªåˆ¶æ•°æ®é›†"></a>4.1 è‡ªåˆ¶æ•°æ®é›†</h4><p>è¯»å†™æ–‡ä»¶ã€å»ºç«‹æ•°æ®é›†çš„æ“ä½œï¼Œè¯¦è§ä»£ç ã€‚</p>
<h4 id="4-2-æ•°æ®å¢å¼º"><a href="#4-2-æ•°æ®å¢å¼º" class="headerlink" title="4.2 æ•°æ®å¢å¼º"></a>4.2 æ•°æ®å¢å¼º</h4><pre class="language-python" data-language="python"><code class="language-python">image_gen_train <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>
	rescale <span class="token operator">=</span> æ‰€æœ‰æ•°æ®å°†ä¹˜ä»¥è¯¥å€¼<span class="token punctuation">,</span> 
    rotation_range <span class="token operator">=</span> éšæœºæ—‹è½¬è§’åº¦<span class="token punctuation">,</span> 
    width_shift_range <span class="token operator">=</span> éšæœºå®½åº¦åç§»é‡<span class="token punctuation">,</span> 
    height_shift_range <span class="token operator">=</span> éšæœºé«˜åº¦åç§»é‡<span class="token punctuation">,</span> 
    horizontal_flip <span class="token operator">=</span> æ˜¯å¦éšæœºæ°´å¹³ç¿»è½¬<span class="token punctuation">,</span> 
    zoom_range <span class="token operator">=</span> éšå³ç¼©æ”¾ 
<span class="token punctuation">)</span>
image_gen_train<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span></code></pre>

<p>x_trainè¦æ±‚æ˜¯å››ç»´æ•°æ®ï¼Œéœ€è¦è¿›è¡Œreshapeï¼Œæœ€åä¸€ä¸ªæ˜¯é€šé“æ•°é‡ï¼š<code>x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)</code> </p>
<p>model.fitæ­¥éª¤å˜ä¸ºï¼š<code>model.fit(image_gen_train.flow(x_train, y_train, batch_size=32))</code> </p>
<p>æ•°æ®å¢å¼ºçš„æ•ˆæœéœ€è¦åœ¨å®é™…åº”ç”¨ç¨‹åºä¸­ä½“ä¼šã€‚</p>
<h4 id="4-3-æ–­ç‚¹ç»­è®­"><a href="#4-3-æ–­ç‚¹ç»­è®­" class="headerlink" title="4.3 æ–­ç‚¹ç»­è®­"></a>4.3 æ–­ç‚¹ç»­è®­</h4><h5 id="è¯»å–æ¨¡å‹"><a href="#è¯»å–æ¨¡å‹" class="headerlink" title="è¯»å–æ¨¡å‹"></a>è¯»å–æ¨¡å‹</h5><p><code>load_weights(è·¯å¾„) </code></p>
<p>ä¿å­˜æ¨¡å‹æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ.indexç´¢å¼•è¡¨æ–‡ä»¶ã€‚å¦‚æœè·¯å¾„ä¸­å·²ç»æœ‰ä¿å­˜å¥½çš„æ¨¡å‹ï¼Œå°±ç›´æ¥åŠ è½½æ¨¡å‹å‚æ•°ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python">checkpoint_save_path <span class="token operator">=</span> <span class="token string">"./checkpoint/mnist.ckpt"</span>
<span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>checkpoint_save_path <span class="token operator">+</span> <span class="token string">'.index'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'---load the model---'</span><span class="token punctuation">)</span>
	model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span>checkpoint_save_path<span class="token punctuation">)</span></code></pre>

<h5 id="ä¿å­˜æ¨¡å‹"><a href="#ä¿å­˜æ¨¡å‹" class="headerlink" title="ä¿å­˜æ¨¡å‹"></a>ä¿å­˜æ¨¡å‹</h5><pre class="language-python" data-language="python"><code class="language-python">cp_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>
    filepath<span class="token operator">=</span>checkpoint_save_path<span class="token punctuation">,</span> <span class="token comment"># æ–‡ä»¶å­˜å‚¨è·¯å¾„</span>
    save_weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token comment"># æ˜¯å¦åªä¿ç•™æ¨¡å‹å‚æ•°</span>
    save_best_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>	<span class="token comment"># æ˜¯å¦åªä¿ç•™æœ€ä¼˜ç»“æœ</span>

history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> 
                   	validation_data<span class="token operator">=</span><span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
                    callbacks<span class="token operator">=</span><span class="token punctuation">[</span>cp_callback<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># æ¨¡å‹è®­ç»ƒæ—¶åŠ å…¥ callbacks é€‰é¡¹ï¼Œè®°å½•åˆ° history ä¸­</span></code></pre>



<h4 id="4-4-å‚æ•°æå–"><a href="#4-4-å‚æ•°æå–" class="headerlink" title="4.4 å‚æ•°æå–"></a>4.4 å‚æ•°æå–</h4><p><code>model.trainable_variables</code> è¿”å›æ¨¡å‹ä¸­å¯è®­ç»ƒå‚æ•°ã€‚</p>
<p><code>np.set_printoptions(threshold=è¶…è¿‡å¤šå°‘çœç•¥æ˜¾ç¤º)</code> </p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>trainable_variables<span class="token punctuation">)</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./weights.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> v <span class="token keyword">in</span> model<span class="token punctuation">.</span>trainable_variables<span class="token punctuation">:</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<h4 id="4-5-acc-x2F-loss-æ›²çº¿"><a href="#4-5-acc-x2F-loss-æ›²çº¿" class="headerlink" title="4.5 acc&#x2F;loss æ›²çº¿"></a>4.5 acc&#x2F;loss æ›²çº¿</h4><p>åœ¨ model.fit æ‰§è¡Œè®­ç»ƒè¿‡ç¨‹çš„åŒæ—¶ï¼ŒåŒæ­¥è®°å½•äº†ï¼š</p>
<ul>
<li>è®­ç»ƒé›†lossï¼š<code>loss </code> </li>
<li>æµ‹è¯•é›†lossï¼š<code>val_loss </code> </li>
<li>è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š<code>sparse_categorical_accuracy </code> </li>
<li>æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š<code>val_sparse_categorical_accuracy</code></li>
</ul>
<p>å¯ç”¨ history.history æå–å‡ºæ¥ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python">history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> 
                   	validation_data<span class="token operator">=</span><span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
                    callbacks<span class="token operator">=</span><span class="token punctuation">[</span>cp_callback<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>

<pre class="language-python" data-language="python"><code class="language-python">acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span>
val_acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_sparse_categorical_accuracy'</span><span class="token punctuation">]</span>
loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>
val_loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<h4 id="4-6-æ¨¡å‹åº”ç”¨ç¨‹åº"><a href="#4-6-æ¨¡å‹åº”ç”¨ç¨‹åº" class="headerlink" title="4.6 æ¨¡å‹åº”ç”¨ç¨‹åº"></a>4.6 æ¨¡å‹åº”ç”¨ç¨‹åº</h4><p><code>predict(è¾“å…¥ç‰¹å¾, batch_size=)</code> è¿”å›å‰å‘ä¼ æ’­è®¡ç®—ç»“æœã€‚</p>
<p>åˆ†ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ul>
<li>å¤ç°æ¨¡å‹çš„å‰å‘ä¼ æ’­Sequential</li>
<li>åŠ è½½æ¨¡å‹å‚æ•°</li>
<li>è¿›è¡Œé¢„æµ‹</li>
</ul>
<p>é™„æ‰‹å†™æ•°å­—è¯†åˆ«ä»»åŠ¡çš„ä»£ç ï¼š</p>
<p><strong>A. æ¨¡å‹è®­ç»ƒå’Œä¿å­˜</strong></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> os
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt


mnist <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>mnist
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train<span class="token punctuation">,</span> x_test <span class="token operator">=</span> x_train <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">,</span> x_test <span class="token operator">/</span> <span class="token number">255.0</span>  <span class="token comment"># æŠŠ[0, 255]å˜ä¸º[0, 1]ï¼Œè¾“å…¥ç‰¹å¾å€¼å°æ›´æ˜“äºç¥ç»ç½‘ç»œå¸æ”¶</span>

model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># æŸ¥çœ‹æœ‰æ²¡æœ‰å¯ä»¥åŠ è½½çš„æ¨¡å‹</span>
checkpoint_save_path <span class="token operator">=</span> <span class="token string">"./checkpoint/mnist.ckpt"</span>
<span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>checkpoint_save_path <span class="token operator">+</span> <span class="token string">'.index'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-------------load the model-----------------'</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span>checkpoint_save_path<span class="token punctuation">)</span>

cp_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>filepath<span class="token operator">=</span>checkpoint_save_path<span class="token punctuation">,</span>
                                                 save_weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                                 save_best_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
          validation_data<span class="token operator">=</span><span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
          callbacks<span class="token operator">=</span><span class="token punctuation">[</span>cp_callback<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¿å­˜æ¨¡å‹</span>

model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># å‚æ•°å†™å…¥txt</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>trainable_variables<span class="token punctuation">)</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./weights.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> v <span class="token keyword">in</span> model<span class="token punctuation">.</span>trainable_variables<span class="token punctuation">:</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># acc/losså¯è§†åŒ–</span>
acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span>
val_acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_sparse_categorical_accuracy'</span><span class="token punctuation">]</span>
loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>
val_loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_acc<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>val_loss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<p><strong>B. æ¨¡å‹åŠ è½½å’Œé¢„æµ‹</strong></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

model_save_path <span class="token operator">=</span> <span class="token string">'./checkpoint/mnist.ckpt'</span>

<span class="token comment"># å¤ç°å‰å‘ä¼ æ’­</span>
model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># åŠ è½½æ¨¡å‹</span>
model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span>model_save_path<span class="token punctuation">)</span>


preNum <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œå‡ æ¬¡è¯†åˆ«ä»»åŠ¡:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>preNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    image_path <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"å›¾ç‰‡æ–‡ä»¶å:"</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span>
    img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Image<span class="token punctuation">.</span>ANTIALIAS<span class="token punctuation">)</span>  <span class="token comment"># è½¬åŒ–ä¸º28*28</span>
    img_arr <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img<span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬åŒ–ä¸ºç°åº¦å›¾ç‰‡</span>

    <span class="token comment"># ç™½åº•é»‘å­—ï¼Œè½¬æ¢æˆé»‘åº•ç™½å­—ï¼Œå¹¶é™å™ª</span>
    <span class="token comment"># img_arr = 255 - img_arr</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> img_arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">200</span><span class="token punctuation">:</span>
                img_arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                img_arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

    img_arr <span class="token operator">=</span> img_arr <span class="token operator">/</span> <span class="token number">255.0</span>  <span class="token comment"># å½’ä¸€åŒ–</span>

    <span class="token comment"># ç¥ç»ç½‘ç»œè®­ç»ƒæ—¶ï¼Œéƒ½æ˜¯æŒ‰ç…§batché€å…¥ç½‘ç»œï¼Œæ‰€ä»¥ç»™img_arrå‰é¢æ·»åŠ ä¸€ä¸ªç»´åº¦</span>
    <span class="token comment"># img_arr:(28, 28)</span>
    <span class="token comment"># x_predict:(1, 28, 28)</span>
    x_predict <span class="token operator">=</span> img_arr<span class="token punctuation">[</span>tf<span class="token punctuation">.</span>newaxis<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>

    result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_predict<span class="token punctuation">)</span>   <span class="token comment"># å‰å‘ä¼ æ’­</span>
    pred <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>result<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># è¾“å‡ºæœ€å¤§æ¦‚ç‡å€¼çš„ç´¢å¼•</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    tf<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"é¢„æµ‹æ•°å­—ï¼š"</span><span class="token punctuation">,</span> pred<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></code></pre>





<h3 id="5-å·ç§¯ç¥ç»ç½‘ç»œ"><a href="#5-å·ç§¯ç¥ç»ç½‘ç»œ" class="headerlink" title="5 å·ç§¯ç¥ç»ç½‘ç»œ"></a>5 å·ç§¯ç¥ç»ç½‘ç»œ</h3><p>å®é™…é—®é¢˜ä¸­ï¼Œå›¾ç‰‡å°ºå¯¸å¤§ã€é€šé“å¤šï¼Œç›´æ¥è¾“å…¥å…¨è¿æ¥å±‚ä¸ç°å®ï¼Œéœ€è¦è¿›è¡Œç‰¹å¾çš„æå–ï¼Œå†è¾“å…¥åˆ°å…¨è¿æ¥å±‚ã€‚å·ç§¯è®¡ç®—æ˜¯æå–ç‰¹å¾çš„å¸¸ç”¨ã€æœ‰æ•ˆçš„æ–¹æ³•ã€‚</p>
<h4 id="5-1-å·ç§¯æ¦‚å¿µ"><a href="#5-1-å·ç§¯æ¦‚å¿µ" class="headerlink" title="5.1 å·ç§¯æ¦‚å¿µ"></a>5.1 å·ç§¯æ¦‚å¿µ</h4><h5 id="å·ç§¯è®¡ç®—"><a href="#å·ç§¯è®¡ç®—" class="headerlink" title="å·ç§¯è®¡ç®—"></a>å·ç§¯è®¡ç®—</h5><p>è¾“å…¥ç‰¹å¾å›¾çš„channelæ•°å†³å®šäº†å·ç§¯æ ¸çš„channelæ•°ï¼›å·ç§¯æ ¸çš„ä¸ªæ•°å†³å®šè¾“å‡ºç‰¹å¾å›¾çš„channelæ•°ã€‚</p>
<p>å¦‚æœè§‰å¾—æŸå±‚ç‰¹å¾æå–èƒ½åŠ›å·®ï¼Œå¯ä»¥åœ¨è¿™ä¸€å±‚å¤šç”¨å‡ ä¸ªå·ç§¯æ ¸ã€‚</p>
<p>å¯ä»¥æ ¹æ®ä¸‹å›¾è®°ä½å‚æ•°çš„ä¸ªæ•°ã€‚æ¯ä¸ªæ ¼å­æ˜¯ä¸€ä¸ªwï¼Œæ¯ä¸ªå·ç§¯æ ¸æœ‰ä¸€ä¸ªbã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf3.png'  width="80%" height="80%"/ loading="lazy">

<p>å½“å·ç§¯æ ¸æ˜¯å¤šchannelçš„ï¼Œä¹Ÿæ˜¯æ‰§è¡Œå…¨éƒ¨ç›¸ä¹˜ã€æ±‚å’Œçš„è®¡ç®—è¿‡ç¨‹ã€‚</p>
<p>å½“æœ‰å¤šä¸ªå·ç§¯æ ¸ï¼ŒæŠŠæ¯ä¸ªå·ç§¯æ ¸å¾—åˆ°çš„ç‰¹å¾å›¾å åŠ èµ·æ¥ï¼Œå½¢æˆå¤šchannelçš„è¾“å‡ºç‰¹å¾å›¾ã€‚</p>
<h5 id="æ„Ÿå—é‡"><a href="#æ„Ÿå—é‡" class="headerlink" title="æ„Ÿå—é‡"></a>æ„Ÿå—é‡</h5><p>æ„Ÿå—é‡çš„æ¦‚å¿µå¦‚å›¾ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf4.png'  width="80%" height="80%"/ loading="lazy">

<p>ç”¨ä¸¤å±‚ 3*3 å·ç§¯æ ¸ï¼Œå’Œä¸€å±‚ 5*5 å·ç§¯æ ¸ï¼Œæœ€ç»ˆå¾—åˆ°çš„å•ä¸ªè¾“å‡ºåƒç´ çš„æ„Ÿå—é‡éƒ½æ˜¯ 5ï¼Œæˆ‘ä»¬è¯´<strong>è¿™ä¸¤ç§å·ç§¯æ–¹æ³•çš„ç‰¹å¾æå–èƒ½åŠ›æ˜¯ä¸€æ ·çš„</strong>ã€‚</p>
<p>æ­¤æ—¶ï¼Œè€ƒè™‘å®ƒä»¬çš„å¸¦è®­ç»ƒå‚æ•°ä¸ªæ•°å’Œè®¡ç®—é‡ï¼Œåœ¨ä¸åŒçš„å·ç§¯æ–¹æ³•ä¸­è¿›è¡Œé€‰æ‹©ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf5.png'  width="80%" height="80%"/ loading="lazy">

<p>è¿™ä¹Ÿæ˜¯ç°åœ¨ç¥ç»ç½‘ç»œç»å¸¸ä½¿ç”¨ä¸¤å±‚ 3*3 å·ç§¯æ ¸æ›¿æ¢ä¸€å±‚ 5*5 å·ç§¯æ ¸çš„åŸå› ã€‚</p>
<h4 id="5-2-tensorflowå·ç§¯å±‚çš„å®ç°"><a href="#5-2-tensorflowå·ç§¯å±‚çš„å®ç°" class="headerlink" title="5.2 tensorflowå·ç§¯å±‚çš„å®ç°"></a>5.2 tensorflowå·ç§¯å±‚çš„å®ç°</h4><h5 id="A-padading-å…¨é›¶å¡«å……"><a href="#A-padading-å…¨é›¶å¡«å……" class="headerlink" title="A. padading-å…¨é›¶å¡«å……"></a>A. padading-å…¨é›¶å¡«å……</h5><p>å…¨é›¶å¡«å……åœ¨è¾“å…¥å›¾ç‰‡å‘¨å›´è¡¥0ï¼Œä½¿å·ç§¯è®¡ç®—çš„è¾“å‡ºä¿æŒè·Ÿè¾“å…¥ç›¸åŒçš„å°ºå¯¸ã€‚</p>
<ul>
<li><p><code>padding=&#39;SAME&#39;</code>ï¼šä½¿ç”¨å…¨é›¶å¡«å……</p>
</li>
<li><p><code>padding=&#39;VALID&#39;</code>ï¼šä¸ä½¿ç”¨å…¨é›¶å¡«å……</p>
</li>
</ul>
<h5 id="B-Conv2D-æè¿°å·ç§¯å±‚"><a href="#B-Conv2D-æè¿°å·ç§¯å±‚" class="headerlink" title="B. Conv2D-æè¿°å·ç§¯å±‚"></a>B. Conv2D-æè¿°å·ç§¯å±‚</h5><pre class="language-python" data-language="python"><code class="language-python">tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span>
    filters<span class="token operator">=</span>å·ç§¯æ ¸ä¸ªæ•°
    kernel_size<span class="token operator">=</span>å·ç§¯æ ¸å°ºå¯¸<span class="token punctuation">,</span> 
    strides<span class="token operator">=</span>æ»‘åŠ¨æ­¥é•¿<span class="token punctuation">,</span> 
    padding<span class="token operator">=</span><span class="token string">"same"</span> <span class="token keyword">or</span> <span class="token string">"valid"</span><span class="token punctuation">,</span> 
    activation<span class="token operator">=</span><span class="token string">"relu"</span> <span class="token keyword">or</span> <span class="token string">"softmax"</span> <span class="token keyword">or</span> <span class="token string">"tanh"</span> <span class="token keyword">or</span> <span class="token string">"sigmoid"</span><span class="token punctuation">,</span>  <span class="token comment"># å¦‚æœæœ‰BNï¼Œæ­¤å¤„ä¸å†™</span>
    input_shape<span class="token operator">=</span><span class="token punctuation">(</span>é«˜<span class="token punctuation">,</span> å®½<span class="token punctuation">,</span> é€šé“æ•°<span class="token punctuation">)</span> <span class="token comment"># è¾“å…¥ç‰¹å¾å›¾çš„ç»´åº¦ï¼Œå¯ä»¥çœç•¥</span>
<span class="token punctuation">)</span></code></pre>

<p>kernel_sizeã€stridesç­‰ï¼Œå¦‚æœæ¨ªçºµç›¸åŒï¼Œå°±å†™ä¸€ä¸ªé•¿æ•´æ•°ï¼›å¦åˆ™å†™ <code>(çºµå‘, æ¨ªå‘)</code> </p>
<p>å·ç§¯å±‚ä¸‰ç§ä¸åŒçš„ä¼ å‚æ–¹æ³•ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    Conv2D<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'valid'</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    MaxPool2D<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    
    Conv2D<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'valid'</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
    MaxPool2D<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    
	Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'valid'</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
    MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    
    Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>



<h5 id="C-BN-æ‰¹æ ‡å‡†åŒ–"><a href="#C-BN-æ‰¹æ ‡å‡†åŒ–" class="headerlink" title="C. BN-æ‰¹æ ‡å‡†åŒ–"></a>C. BN-æ‰¹æ ‡å‡†åŒ–</h5><p>ç¥ç»ç½‘ç»œå¯¹0é™„è¿‘çš„æ•°æ®æ›´æ•æ„Ÿï¼Œæ¢¯åº¦æ›´å¤§ã€‚</p>
<ul>
<li>æ ‡å‡†åŒ–ï¼šä½¿æ•°æ®ç¬¦åˆ0å‡å€¼ï¼Œ1æ ‡å‡†å·®çš„åˆ†å¸ƒ</li>
<li>æ‰¹æ ‡å‡†åŒ–ï¼šå¯¹ä¸€batchçš„æ•°æ®åšæ ‡å‡†åŒ–å¤„ç†</li>
</ul>
<p>$$ {H_i^k}^\prime  &#x3D; \frac{H_i^k - \mu^k_{batch}}{\sigma^k_{batch}} $$</p>
<p><strong>BNå¸¸ç”¨åœ¨å·ç§¯æ“ä½œå’Œæ¿€æ´»æ“ä½œä¹‹é—´ã€‚</strong> </p>
<p>å‡å€¼ã€æ ‡å‡†å·®éƒ½æ˜¯é’ˆå¯¹ç¬¬ k ä¸ªå·ç§¯æ ¸ç”Ÿæˆçš„ batch å¼ ï¼ˆåŒchannelï¼‰å›¾ä¸­çš„æ‰€æœ‰åƒç´ ç‚¹ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf6.png'  width="80%" height="80%"/ loading="lazy">

<p>è¿™ç§ç®€å•çš„æ ‡å‡†åŒ–ï¼Œä½¿è¾“å…¥æ•°æ®é›†ä¸­åœ¨æ¿€æ´»å‡½æ•°çš„çº¿æ€§åŒºåŸŸã€‚</p>
<p>å› æ­¤åœ¨BNæ“ä½œä¸­ï¼Œä¸ºæ¯ä¸ªåƒç´  $H$ å¼•å…¥<strong>ä¸¤ä¸ªå¯è®­ç»ƒå‚æ•°</strong>ï¼Œç¼©æ”¾å› å­ $\gamma$ å’Œåç§»å› å­ $\beta$ï¼Œæ ‡å‡†æ­£æ€åˆ†å¸ƒåçš„è¾“å…¥æ•°æ®é€šè¿‡è¿™ä¸¤ä¸ªå› å­ï¼Œä¼˜åŒ–äº†ç‰¹å¾æ•°æ®åˆ†å¸ƒçš„å®½çª„ã€åç§»é‡ï¼ˆå¦‚å›¾ï¼‰ï¼Œ<strong>ä¿è¯äº†ç½‘ç»œçš„éçº¿æ€§è¡¨è¾¾åŠ›</strong>ã€‚</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf7.png'  width="80%" height="80%"/ loading="lazy">

<pre class="language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
	Conv2D<span class="token punctuation">(</span>fitlers<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>



<h5 id="D-Pooling-æ± åŒ–"><a href="#D-Pooling-æ± åŒ–" class="headerlink" title="D. Pooling-æ± åŒ–"></a>D. Pooling-æ± åŒ–</h5><p>ç”¨äºå‡å°‘ç‰¹å¾çš„æ•°é‡ã€‚</p>
<ul>
<li>æœ€å¤§æ± åŒ–ï¼šæå–å›¾ç‰‡çº¹ç†</li>
<li>å‡å€¼æ± åŒ–ï¼šä¿ç•™èƒŒæ™¯ç‰¹å¾</li>
</ul>
<p><code>padding=&#39;same&#39;</code> æ—¶ï¼Œ<strong>ä¸å¯æ•´é™¤çš„ä¼šå¡«å……æˆå¯æ•´é™¤ï¼Œè€Œä¸æ˜¯ä¸æ”¹å˜è¾“å‡ºçš„å°ºå¯¸</strong> </p>
<pre class="language-python" data-language="python"><code class="language-python">tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>MaxPool2D<span class="token punctuation">(</span>
	pool_size<span class="token operator">=</span>æ± åŒ–æ ¸å°ºå¯¸<span class="token punctuation">,</span> 
    strides<span class="token operator">=</span>æ± åŒ–æ­¥é•¿<span class="token punctuation">,</span>  <span class="token comment"># é»˜è®¤è·Ÿ pool_size ç›¸ç­‰</span>
    padding<span class="token operator">=</span><span class="token string">'valid'</span> <span class="token keyword">or</span> <span class="token string">'same'</span> <span class="token comment"># æ˜¯å¦ä½¿ç”¨å…¨é›¶å¡«å……çš„æ± åŒ–</span>
<span class="token punctuation">)</span>
tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>AveragePooling2D<span class="token punctuation">(</span>
	pool_size<span class="token operator">=</span>æ± åŒ–æ ¸å°ºå¯¸<span class="token punctuation">,</span> 
    strides<span class="token operator">=</span>æ± åŒ–æ­¥é•¿<span class="token punctuation">,</span> 
    padding<span class="token operator">=</span><span class="token string">'valid'</span> <span class="token keyword">or</span> <span class="token string">'same'</span> 
<span class="token punctuation">)</span></code></pre>

<p>ä¾‹å­è§ä¹‹å‰çš„ä»£ç ã€‚ </p>
<h5 id="E-Dropout-èˆå¼ƒ"><a href="#E-Dropout-èˆå¼ƒ" class="headerlink" title="E. Dropout-èˆå¼ƒ"></a>E. Dropout-èˆå¼ƒ</h5><p>ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒæŒ‰ç…§ä¸€å®šæ¦‚ç‡ï¼ŒæŠŠä¸€éƒ¨åˆ†ç¥ç»å…ƒä»ç¤¾äº¤ç½‘ç»œä¸­æš‚æ—¶èˆå¼ƒã€‚ä½¿ç”¨ç¥ç»ç½‘ç»œæ—¶ï¼Œè¢«èˆå¼ƒçš„ç¥ç»å…ƒæ¢å¤è¿æ¥ã€‚</p>
<p><code>tf.keras.layers.Dropout(èˆå¼ƒæ¦‚ç‡)</code> </p>
<p>ä¾‹å­è§ä¹‹å‰çš„ä»£ç ã€‚ </p>
<h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>å·ç§¯ç¥ç»ç½‘ç»œï¼šå€ŸåŠ©å·ç§¯æ ¸æå–ç‰¹å¾ï¼Œç„¶åé€å…¥å…¨è¿æ¥ç½‘ç»œã€‚</p>
<p>ç‰¹å¾æå–åˆ†å››æ­¥ï¼š</p>
<ul>
<li>Conv2D</li>
<li>BN</li>
<li>Activation</li>
<li>Pooling</li>
</ul>
<p>Qï¼šå·ç§¯æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>Aï¼šå·ç§¯å°±æ˜¯ç‰¹å¾æå–å™¨ï¼Œå°±æ˜¯CBAPDã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
	Conv2D<span class="token punctuation">(</span>fitlers<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>



<h4 id="5-3-å·ç§¯ç¥ç»ç½‘ç»œæ­å»ºç¤ºä¾‹"><a href="#5-3-å·ç§¯ç¥ç»ç½‘ç»œæ­å»ºç¤ºä¾‹" class="headerlink" title="5.3 å·ç§¯ç¥ç»ç½‘ç»œæ­å»ºç¤ºä¾‹"></a>5.3 å·ç§¯ç¥ç»ç½‘ç»œæ­å»ºç¤ºä¾‹</h4><h5 id="Cifar-10-æ•°æ®é›†"><a href="#Cifar-10-æ•°æ®é›†" class="headerlink" title="Cifar 10 æ•°æ®é›†"></a>Cifar 10 æ•°æ®é›†</h5><ul>
<li>5ä¸‡å¼  32*32 åƒç´ çš„ 10 åˆ†ç±»å½©è‰²å›¾ç‰‡å’Œæ ‡ç­¾ï¼Œä½œä¸ºè®­ç»ƒé›† </li>
<li>1ä¸‡å¼  32*32 åƒç´ çš„ 10 åˆ†ç±»å½©è‰²å›¾ç‰‡å’Œæ ‡ç­¾ï¼Œä½œä¸ºè®­ç»ƒé›†</li>
</ul>
<pre class="language-python" data-language="python"><code class="language-python">cifar10 <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>cifar10
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> cifar10<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h5 id="æ­å»ºç¤ºä¾‹"><a href="#æ­å»ºç¤ºä¾‹" class="headerlink" title="æ­å»ºç¤ºä¾‹"></a>æ­å»ºç¤ºä¾‹</h5><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Baseline</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Baseline<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b1 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p1 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d1 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d2 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>f2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y</code></pre>



<h4 id="5-4-LeNet"><a href="#5-4-LeNet" class="headerlink" title="5.4 LeNet"></a>5.4 LeNet</h4><p><strong>åœ¨ç»Ÿè®¡å·ç§¯ç¥ç»ç½‘ç»œå±‚æ•°æ—¶ï¼Œä¸€èˆ¬åªç»Ÿè®¡å·ç§¯è®¡ç®—å±‚å’Œå…¨è¿æ¥è®¡ç®—å±‚ã€‚</strong> </p>
<p>LeNetçš„äº”å±‚ç»“æ„å¦‚å›¾ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf8.png'  width="80%" height="80%"/ loading="lazy">

<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">LeNet5</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>LeNet5<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p1 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c2 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p2 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f3 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>f3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y</code></pre>



<h4 id="5-5-AlexNet"><a href="#5-5-AlexNet" class="headerlink" title="5.5 AlexNet"></a>5.5 AlexNet</h4><p>AlexNet çš„å…«å±‚ç»“æ„ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf9.png'  width="80%" height="80%"/ loading="lazy">

<p>ï¼ˆå›¾ä¸­æœ‰äº›æ•°ä¸å‡†ç¡®ï¼Œè¯¦è§ä»£ç ã€‚ï¼‰</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf10.png'  width="80%" height="80%"/ loading="lazy">

<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AlexNet8</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>AlexNet8<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">96</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'valid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b1 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p1 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c2 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'valid'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b2 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a2 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p2 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c3 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">384</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">,</span>\
                         activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c4 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">384</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">,</span>\
                         activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c5 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">,</span>\
                         activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p3 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>f1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d1 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>f2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d2 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>f3 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>f3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y</code></pre>



<h4 id="5-6-VGGNet"><a href="#5-6-VGGNet" class="headerlink" title="5.6 VGGNet"></a>5.6 VGGNet</h4><p>ä½¿ç”¨å°å°ºå¯¸å·ç§¯æ ¸ï¼Œåœ¨å‡å°‘å‚æ•°çš„åŒæ—¶æé«˜äº†è¯†åˆ«å‡†ç¡®ç‡ã€‚</p>
<p>VGGç½‘ç»œç»“æ„è§„æ•´ï¼Œé€‚åˆç¡¬ä»¶åŠ é€Ÿã€‚</p>
<p>ï¼ˆå›¾ä¸­æœ‰äº›æ•°ä¸å‡†ç¡®ï¼Œè¯¦è§ä»£ç ã€‚ï¼‰</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf11.png'  width="80%" height="80%"/ loading="lazy">

<p>å·ç§¯æ ¸ä¸ªæ•° 64 â€“&gt; 128 â€“&gt; 256 â€“&gt; 512ï¼Œå› ä¸ºè¶Šé åï¼Œç‰¹å¾å›¾å°ºå¯¸è¶Šå°ï¼Œé€šè¿‡å¢åŠ é€šé“ï¼Œå¢åŠ äº†ç‰¹å¾å›¾çš„æ·±åº¦ï¼Œä¿æŒäº†ä¿¡æ¯çš„æ‰¿è½½èƒ½åŠ›ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">VGG16</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>VGG16<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b1 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c2 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b2 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a2 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p1 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>ï¼Œ strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d1 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c3 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b3 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a3 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c4 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b4 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a4 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p2 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>ï¼Œ strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d2 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c5 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b5 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a5 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c6 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b6 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a6 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c7 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b7 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a7 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p3 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>ï¼Œ strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d3 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c8 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b8 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a8 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c9 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b9 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a9 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c10 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b10 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a10 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p4 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>ï¼Œ strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d4 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c11 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b11 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a11 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c12 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b12 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a12 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c13 <span class="token operator">=</span> Conv2D<span class="token punctuation">(</span>filters<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b13 <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a13 <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p5 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>ï¼Œ strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d5 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d6 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>f2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>d7 <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>f3 <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c6<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b6<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a6<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c7<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b7<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a7<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c8<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b8<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a8<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c9<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b9<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a9<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c10<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b10<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a10<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d4<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c11<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b11<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a11<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c12<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b12<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a12<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c13<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>b13<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>a13<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d5<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d6<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        x <span class="token operator">=</span> self<span class="token punctuation">.</span>f2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>d7<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        y <span class="token operator">=</span> self<span class="token punctuation">.</span>f3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y</code></pre>



<h4 id="5-7-Inception-Net"><a href="#5-7-Inception-Net" class="headerlink" title="5.7 Inception Net"></a>5.7 Inception Net</h4><p>åœ¨åŒä¸€å±‚ç½‘ç»œå†…ä½¿ç”¨ä¸åŒå°ºå¯¸çš„å·ç§¯æ ¸ï¼Œæå‡äº†æ¨¡å‹æ„ŸçŸ¥åŠ›ã€‚</p>
<p>å•ä¸ªInceptionç»“æ„å—å¦‚å›¾ï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf12.png'  width="80%" height="80%"/ loading="lazy">

<p>å·ç§¯è¿æ¥å™¨Filter concatenationå°†å››ä¸ªåˆ†æ”¯æŒ‰æ·±åº¦æ–¹å‘å †å åœ¨ä¸€èµ·ã€‚</p>
<p>ç”±äºå·ç§¯æ“ä½œéƒ½æ˜¯ C-B-A çš„ç»“æ„ï¼Œå°†è¿™ç§ä¸‰æ­¥å·ç§¯æ“ä½œå®šä¹‰ä¸ºä¸€ä¸ªç±»ï¼Œå‡å°‘ä»£ç é•¿åº¦ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ConvBNRelu</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>ConvBNRelu<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
            Conv2D<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token punctuation">,</span> strides<span class="token operator">=</span>strides<span class="token punctuation">,</span> padding<span class="token operator">=</span>padding<span class="token punctuation">)</span><span class="token punctuation">,</span> 
            BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x</code></pre>

<p>ç„¶åï¼ŒInceptionç»“æ„å—å¯ä»¥è¿™æ ·å®ç°ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">InceptionBlk</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ch<span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>InceptionBlk<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ch <span class="token operator">=</span> ch
        self<span class="token punctuation">.</span>strides <span class="token operator">=</span> strides
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> strides<span class="token operator">=</span>strides<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c2_1 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> strides<span class="token operator">=</span>strides<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c2_2 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>c3_1 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> strides<span class="token operator">=</span>strides<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c3_2 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>p4_1 <span class="token operator">=</span> MaxPool2D<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c4_2 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> kernelsz<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> strides<span class="token operator">=</span>strides<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x1 <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x2_1 <span class="token operator">=</span> self<span class="token punctuation">.</span>c2_1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x2_2 <span class="token operator">=</span> self<span class="token punctuation">.</span>c2_2<span class="token punctuation">(</span>x2_1<span class="token punctuation">)</span>
        x3_1 <span class="token operator">=</span> self<span class="token punctuation">.</span>c3_1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x3_2 <span class="token operator">=</span> self<span class="token punctuation">.</span>c3_2<span class="token punctuation">(</span>x3_1<span class="token punctuation">)</span>
        x4_1 <span class="token operator">=</span> self<span class="token punctuation">.</span>p4_1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x4_2 <span class="token operator">=</span> self<span class="token punctuation">.</span>c4_2<span class="token punctuation">(</span>x4_1<span class="token punctuation">)</span>
        <span class="token comment"># å †å ä¸åŒåˆ†æ”¯çš„è¾“å‡º</span>
        x <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>x1<span class="token punctuation">,</span> x2_2<span class="token punctuation">,</span> x3_2<span class="token punctuation">,</span> x4_2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> x</code></pre>



<p>ç²¾ç®€InceptionNetï¼š</p>
<img src='https://cdn.jsdelivr.net/gh/ACBGZM/MyPostImage@master/ml-notes-img/nndl/tf13.png'  width="80%" height="80%"/ loading="lazy">

<p>æ¯ä¸ª block ç”±ä¸¤ä¸ª InceptionBlk ç»„æˆï¼Œç¬¬ä¸€ä¸ªçš„å·ç§¯ strides&#x3D;1ï¼Œç¬¬äºŒä¸ªçš„ strides&#x3D;2.</p>
<p>è¿™ä½¿ block_0 çš„è¾“å‡ºç‰¹å¾å›¾å°ºå¯¸å‡åŠï¼Œå› æ­¤æˆ‘ä»¬æŠŠè¾“å‡ºç‰¹å¾å›¾æ·±åº¦åŠ æ·±ä¸º2å€ï¼Œä¿æŒä¿¡æ¯æ‰¿è½½èƒ½åŠ›ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Inception10</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_blocks<span class="token punctuation">,</span> num_classes<span class="token punctuation">,</span> init_ch<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Inception10<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>in_channels <span class="token operator">=</span> init_ch
        self<span class="token punctuation">.</span>out_channels <span class="token operator">=</span> init_ch
        self<span class="token punctuation">.</span>num_blocks <span class="token operator">=</span> num_blocks
        self<span class="token punctuation">.</span>init_ch <span class="token operator">=</span> init_ch
        self<span class="token punctuation">.</span>c1 <span class="token operator">=</span> ConvBNRelu<span class="token punctuation">(</span>init_ch<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>blocks <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> block_id <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_blocks<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> layer_id <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> layer_id <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    block <span class="token operator">=</span> InceptionBlk<span class="token punctuation">(</span>self<span class="token punctuation">.</span>out_channels<span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    block <span class="token operator">=</span> InceptionBlk<span class="token punctuation">(</span>self<span class="token punctuation">.</span>out_channels<span class="token punctuation">,</span> strides<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>blocks<span class="token punctuation">.</span>add<span class="token punctuation">(</span>block<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>out_channels <span class="token operator">*=</span> <span class="token number">2</span>
        self<span class="token punctuation">.</span>p1 <span class="token operator">=</span> GlobalAveragePooling2D<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>c1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>blocks<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>p1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>f1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y

   model <span class="token operator">=</span> Inception10<span class="token punctuation">(</span>num_blocks<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></code></pre>



<h4 id="5-8-ResNet"><a href="#5-8-ResNet" class="headerlink" title="5.8 ResNet"></a>5.8 ResNet</h4><p>æå‡ºå±‚é—´æ®‹å·®è·³è¿ï¼Œå¼•å…¥å‰æ–¹ä¿¡æ¯ï¼Œç¼“è§£æ¢¯åº¦æ¶ˆå¤±ï¼Œå¯ä»¥è®©ç½‘ç»œå±‚æ•°å¢åŠ ã€‚</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>miu</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://acbgzm.github.io/2021/05/27/dlang/" title="dl &amp; ai - andrew ng">http://acbgzm.github.io/2021/05/27/dlang/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/01/26/misc-1/" rel="prev" title="åšå®¢é‡Œçš„æˆ‘ï¼Œå ‚å ‚å¤æ´»"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">åšå®¢é‡Œçš„æˆ‘ï¼Œå ‚å ‚å¤æ´»</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/25/ml2014ang/" rel="next" title="machine learning - andrew ng"><span class="post-nav-text">machine learning - andrew ng</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><style>.utterances {
  max-width: 100%;
}</style><script src="https://utteranc.es/client.js" repo="ACBGZM/ACBGZM.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> miu</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v6.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.9</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div class="search-result-container"></div></div></body></html>